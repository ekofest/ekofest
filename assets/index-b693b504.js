var gc=Object.defineProperty;var _c=(e,r,n)=>r in e?gc(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n;var ae=(e,r,n)=>(_c(e,typeof r!="symbol"?r+"":r,n),n);(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))t(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();function wr(e,r,n){return n.a=e,n.f=r,n}function d(e){return wr(2,e,function(r){return function(n){return e(r,n)}})}function A(e){return wr(3,e,function(r){return function(n){return function(t){return e(r,n,t)}}})}function de(e){return wr(4,e,function(r){return function(n){return function(t){return function(a){return e(r,n,t,a)}}}})}function Ye(e){return wr(5,e,function(r){return function(n){return function(t){return function(a){return function(o){return e(r,n,t,a,o)}}}}})}function Hn(e){return wr(6,e,function(r){return function(n){return function(t){return function(a){return function(o){return function(s){return e(r,n,t,a,o,s)}}}}}})}function xs(e){return wr(7,e,function(r){return function(n){return function(t){return function(a){return function(o){return function(s){return function(u){return e(r,n,t,a,o,s,u)}}}}}}})}function ti(e){return wr(8,e,function(r){return function(n){return function(t){return function(a){return function(o){return function(s){return function(u){return function(c){return e(r,n,t,a,o,s,u,c)}}}}}}}})}function Es(e){return wr(9,e,function(r){return function(n){return function(t){return function(a){return function(o){return function(s){return function(u){return function(c){return function(f){return e(r,n,t,a,o,s,u,c,f)}}}}}}}}})}function i(e,r,n){return e.a===2?e.f(r,n):e(r)(n)}function h(e,r,n,t){return e.a===3?e.f(r,n,t):e(r)(n)(t)}function ie(e,r,n,t,a){return e.a===4?e.f(r,n,t,a):e(r)(n)(t)(a)}function le(e,r,n,t,a,o){return e.a===5?e.f(r,n,t,a,o):e(r)(n)(t)(a)(o)}function hr(e,r,n,t,a,o,s){return e.a===6?e.f(r,n,t,a,o,s):e(r)(n)(t)(a)(o)(s)}function wc(e,r,n,t,a,o,s,u){return e.a===7?e.f(r,n,t,a,o,s,u):e(r)(n)(t)(a)(o)(s)(u)}function kc(e,r,n,t,a,o,s,u,c){return e.a===8?e.f(r,n,t,a,o,s,u,c):e(r)(n)(t)(a)(o)(s)(u)(c)}var yc=[];function xc(e){return e.length}var Ec=A(function(e,r,n){for(var t=new Array(e),a=0;a<e;a++)t[a]=n(r+a);return t}),jc=d(function(e,r){for(var n=new Array(e),t=0;t<e&&r.b;t++)n[t]=r.a,r=r.b;return n.length=t,l(n,r)});d(function(e,r){return r[e]});A(function(e,r,n){for(var t=n.length,a=new Array(t),o=0;o<t;o++)a[o]=n[o];return a[e]=r,a});d(function(e,r){for(var n=r.length,t=new Array(n+1),a=0;a<n;a++)t[a]=r[a];return t[n]=e,t});A(function(e,r,n){for(var t=n.length,a=0;a<t;a++)r=i(e,n[a],r);return r});var Mc=A(function(e,r,n){for(var t=n.length-1;t>=0;t--)r=i(e,n[t],r);return r});d(function(e,r){for(var n=r.length,t=new Array(n),a=0;a<n;a++)t[a]=e(r[a]);return t});A(function(e,r,n){for(var t=n.length,a=new Array(t),o=0;o<t;o++)a[o]=i(e,r+o,n[o]);return a});A(function(e,r,n){return n.slice(e,r)});A(function(e,r,n){var t=r.length,a=e-t;a>n.length&&(a=n.length);for(var o=t+a,s=new Array(o),u=0;u<t;u++)s[u]=r[u];for(var u=0;u<a;u++)s[u+t]=n[u];return s});d(function(e,r){return r});d(function(e,r){return console.log(e+": "+Cc()),r});function Cc(e){return"<internals>"}function cn(e){throw new Error("https://github.com/elm/core/blob/1.0.0/hints/"+e+".md")}function re(e,r){for(var n,t=[],a=ka(e,r,0,t);a&&(n=t.pop());a=ka(n.a,n.b,0,t));return a}function ka(e,r,n,t){if(e===r)return!0;if(typeof e!="object"||e===null||r===null)return typeof e=="function"&&cn(5),!1;if(n>100)return t.push(l(e,r)),!0;e.$<0&&(e=Nr(e),r=Nr(r));for(var a in e)if(!ka(e[a],r[a],n+1,t))return!1;return!0}var Ac=d(re),Ic=d(function(e,r){return!re(e,r)});function oe(e,r,n){if(typeof e!="object")return e===r?0:e<r?-1:1;if(typeof e.$>"u")return(n=oe(e.a,r.a))||(n=oe(e.b,r.b))?n:oe(e.c,r.c);for(;e.b&&r.b&&!(n=oe(e.a,r.a));e=e.b,r=r.b);return n||(e.b?1:r.b?-1:0)}d(function(e,r){return oe(e,r)<0});d(function(e,r){return oe(e,r)<1});d(function(e,r){return oe(e,r)>0});d(function(e,r){return oe(e,r)>=0});var Sc=d(function(e,r){var n=oe(e,r);return n<0?Ks:n?Np:Ws}),mn=0;function l(e,r){return{a:e,b:r}}function ye(e,r,n){return{a:e,b:r,c:n}}function O(e,r){var n={};for(var t in e)n[t]=e[t];for(var t in r)n[t]=r[t];return n}d(J);function J(e,r){if(typeof e=="string")return e+r;if(!e.b)return r;var n=rr(e.a,r);e=e.b;for(var t=n;e.b;e=e.b)t=t.b=rr(e.a,r);return n}var w={$:0};function rr(e,r){return{$:1,a:e,b:r}}var Pc=d(rr);function $(e){for(var r=w,n=e.length;n--;)r=rr(e[n],r);return r}function ai(e){for(var r=[];e.b;e=e.b)r.push(e.a);return r}var Oc=A(function(e,r,n){for(var t=[];r.b&&n.b;r=r.b,n=n.b)t.push(i(e,r.a,n.a));return $(t)});de(function(e,r,n,t){for(var a=[];r.b&&n.b&&t.b;r=r.b,n=n.b,t=t.b)a.push(h(e,r.a,n.a,t.a));return $(a)});Ye(function(e,r,n,t,a){for(var o=[];r.b&&n.b&&t.b&&a.b;r=r.b,n=n.b,t=t.b,a=a.b)o.push(ie(e,r.a,n.a,t.a,a.a));return $(o)});Hn(function(e,r,n,t,a,o){for(var s=[];r.b&&n.b&&t.b&&a.b&&o.b;r=r.b,n=n.b,t=t.b,a=a.b,o=o.b)s.push(le(e,r.a,n.a,t.a,a.a,o.a));return $(s)});var qc=d(function(e,r){return $(ai(r).sort(function(n,t){return oe(e(n),e(t))}))});d(function(e,r){return $(ai(r).sort(function(n,t){var a=i(e,n,t);return a===Ws?0:a===Ks?-1:1}))});d(function(e,r){return e+r});d(function(e,r){return e-r});d(function(e,r){return e*r});d(function(e,r){return e/r});d(function(e,r){return e/r|0});d(Math.pow);d(function(e,r){return r%e});var Vc=d(function(e,r){var n=r%e;return e===0?cn(11):n>0&&e<0||n<0&&e>0?n+e:n});d(Math.atan2);function Rc(e){return e===1/0||e===-1/0}var Nc=Math.ceil,Tc=Math.floor,Dc=Math.round,ro=Math.log,Bc=isNaN;function Lc(e){return!e}d(function(e,r){return e&&r});d(function(e,r){return e||r});d(function(e,r){return e!==r});var Fc=d(function(e,r){return e+r});function Uc(e){var r=e.charCodeAt(0);return isNaN(r)?k:C(55296<=r&&r<=56319?l(e[0]+e[1],e.slice(2)):l(e[0],e.slice(1)))}d(function(e,r){return e+r});function Hc(e){return e.length}d(function(e,r){for(var n=r.length,t=new Array(n),a=0;a<n;){var o=r.charCodeAt(a);if(55296<=o&&o<=56319){t[a]=e(r[a]+r[a+1]),a+=2;continue}t[a]=e(r[a]),a++}return t.join("")});var zc=d(function(e,r){for(var n=[],t=r.length,a=0;a<t;){var o=r[a],s=r.charCodeAt(a);a++,55296<=s&&s<=56319&&(o+=r[a],a++),e(o)&&n.push(o)}return n.join("")});function Jc(e){for(var r=e.length,n=new Array(r),t=0;t<r;){var a=e.charCodeAt(t);55296<=a&&a<=56319?(n[r-t]=e[t+1],t++,n[r-t]=e[t-1],t++):(n[r-t]=e[t],t++)}return n.join("")}A(function(e,r,n){for(var t=n.length,a=0;a<t;){var o=n[a],s=n.charCodeAt(a);a++,55296<=s&&s<=56319&&(o+=n[a],a++),r=i(e,o,r)}return r});var Wc=A(function(e,r,n){for(var t=n.length;t--;){var a=n[t],o=n.charCodeAt(t);56320<=o&&o<=57343&&(t--,a=n[t]+a),r=i(e,a,r)}return r}),Kc=d(function(e,r){return r.split(e)}),Gc=d(function(e,r){return r.join(e)}),Qc=A(function(e,r,n){return n.slice(e,r)});function Zc(e){return e.trim()}function Yc(e){return $(e.trim().split(/\s+/g))}function Xc(e){return $(e.split(/\r\n|\r|\n/g))}function em(e){return e.toUpperCase()}function rm(e){return e.toLowerCase()}d(function(e,r){for(var n=r.length;n--;){var t=r[n],a=r.charCodeAt(n);if(56320<=a&&a<=57343&&(n--,t=r[n]+t),e(t))return!0}return!1});var nm=d(function(e,r){for(var n=r.length;n--;){var t=r[n],a=r.charCodeAt(n);if(56320<=a&&a<=57343&&(n--,t=r[n]+t),!e(t))return!1}return!0}),tm=d(function(e,r){return r.indexOf(e)>-1}),am=d(function(e,r){return r.indexOf(e)===0});d(function(e,r){return r.length>=e.length&&r.lastIndexOf(e)===r.length-e.length});var im=d(function(e,r){var n=e.length;if(n<1)return w;for(var t=0,a=[];(t=r.indexOf(e,t))>-1;)a.push(t),t=t+n;return $(a)});function js(e){return e+""}function om(e){for(var r=0,n=e.charCodeAt(0),t=n==43||n==45?1:0,a=t;a<e.length;++a){var o=e.charCodeAt(a);if(o<48||57<o)return k;r=10*r+o-48}return a==t?k:C(n==45?-r:r)}function sm(e){if(e.length===0||/[\sxbo]/.test(e))return k;var r=+e;return r===r?C(r):k}function um(e){var r=e.charCodeAt(0);return 55296<=r&&r<=56319?(r-55296)*1024+e.charCodeAt(1)-56320+65536:r}function lm(e){return e<0||1114111<e?"�":e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(Math.floor(e/1024)+55296,e%1024+56320))}function cm(e){return{$:0,a:e}}function zn(e){return{$:2,b:e}}var mm=zn(function(e){return typeof e!="number"?Le("an INT",e):-2147483647<e&&e<2147483647&&(e|0)===e||isFinite(e)&&!(e%1)?fe(e):Le("an INT",e)}),pm=zn(function(e){return typeof e=="boolean"?fe(e):Le("a BOOL",e)}),fm=zn(function(e){return typeof e=="number"?fe(e):Le("a FLOAT",e)}),$m=zn(function(e){return fe(e)}),dm=zn(function(e){return typeof e=="string"?fe(e):e instanceof String?fe(e+""):Le("a STRING",e)});function vm(e){return{$:3,b:e}}function bm(e){return{$:5,c:e}}var hm=d(function(e,r){return{$:6,d:e,b:r}}),gm=d(function(e,r){return{$:7,e,b:r}});function _m(e){return{$:8,b:e}}function kr(e,r){return{$:9,f:e,g:r}}var wm=d(function(e,r){return{$:10,b:r,h:e}});function km(e){return{$:11,g:e}}var ym=d(function(e,r){return kr(e,[r])}),xm=A(function(e,r,n){return kr(e,[r,n])});de(function(e,r,n,t){return kr(e,[r,n,t])});Ye(function(e,r,n,t,a){return kr(e,[r,n,t,a])});Hn(function(e,r,n,t,a,o){return kr(e,[r,n,t,a,o])});xs(function(e,r,n,t,a,o,s){return kr(e,[r,n,t,a,o,s])});ti(function(e,r,n,t,a,o,s,u){return kr(e,[r,n,t,a,o,s,u])});Es(function(e,r,n,t,a,o,s,u,c){return kr(e,[r,n,t,a,o,s,u,c])});var Em=d(function(e,r){try{var n=JSON.parse(r);return Be(e,n)}catch(t){return xe(i(bi,"This is not valid JSON! "+t.message,r))}}),ii=d(function(e,r){return Be(e,r)});function Be(e,r){switch(e.$){case 2:return e.b(r);case 5:return r===null?fe(e.c):Le("null",r);case 3:return nt(r)?no(e.b,r,$):Le("a LIST",r);case 4:return nt(r)?no(e.b,r,jm):Le("an ARRAY",r);case 6:var n=e.d;if(typeof r!="object"||r===null||!(n in r))return Le("an OBJECT with a field named `"+n+"`",r);var f=Be(e.b,r[n]);return Je(f)?f:xe(i(co,n,f.a));case 7:var t=e.e;if(!nt(r))return Le("an ARRAY",r);if(t>=r.length)return Le("a LONGER array. Need index "+t+" but only see "+r.length+" entries",r);var f=Be(e.b,r[t]);return Je(f)?f:xe(i(Gs,t,f.a));case 8:if(typeof r!="object"||r===null||nt(r))return Le("an OBJECT",r);var a=w;for(var o in r)if(r.hasOwnProperty(o)){var f=Be(e.b,r[o]);if(!Je(f))return xe(i(co,o,f.a));a=rr(l(o,f.a),a)}return fe(we(a));case 9:for(var s=e.f,u=e.g,c=0;c<u.length;c++){var f=Be(u[c],r);if(!Je(f))return f;s=s(f.a)}return fe(s);case 10:var f=Be(e.b,r);return Je(f)?Be(e.h(f.a),r):f;case 11:for(var m=w,p=e.g;p.b;p=p.b){var f=Be(p.a,r);if(Je(f))return f;m=rr(f.a,m)}return xe(Tp(we(m)));case 1:return xe(i(bi,e.a,r));case 0:return fe(e.a)}}function no(e,r,n){for(var t=r.length,a=new Array(t),o=0;o<t;o++){var s=Be(e,r[o]);if(!Je(s))return xe(i(Gs,o,s.a));a[o]=s.a}return fe(n(a))}function nt(e){return Array.isArray(e)||typeof FileList<"u"&&e instanceof FileList}function jm(e){return i(nf,e.length,function(r){return e[r]})}function Le(e,r){return xe(i(bi,"Expecting "+e,r))}function Qr(e,r){if(e===r)return!0;if(e.$!==r.$)return!1;switch(e.$){case 0:case 1:return e.a===r.a;case 2:return e.b===r.b;case 5:return e.c===r.c;case 3:case 4:case 8:return Qr(e.b,r.b);case 6:return e.d===r.d&&Qr(e.b,r.b);case 7:return e.e===r.e&&Qr(e.b,r.b);case 9:return e.f===r.f&&to(e.g,r.g);case 10:return e.h===r.h&&Qr(e.b,r.b);case 11:return to(e.g,r.g)}}function to(e,r){var n=e.length;if(n!==r.length)return!1;for(var t=0;t<n;t++)if(!Qr(e[t],r[t]))return!1;return!0}var Mm=d(function(e,r){return JSON.stringify(r,null,e)+""});function oi(e){return e}function Cm(){return[]}function Am(){return{}}var Im=A(function(e,r,n){return n[e]=r,n});function Sm(e){return d(function(r,n){return n.push(e(r)),n})}var Pm=null;function ar(e){return{$:0,a:e}}function Om(e){return{$:1,a:e}}function Ve(e){return{$:2,b:e,c:null}}var ya=d(function(e,r){return{$:3,b:e,d:r}});d(function(e,r){return{$:4,b:e,d:r}});function qm(e){return{$:5,b:e}}var Vm=0;function si(e){var r={$:0,e:Vm++,f:e,g:null,h:[]};return ui(r),r}function Ms(e){return Ve(function(r){r(ar(si(e)))})}function Cs(e,r){e.h.push(r),ui(e)}var Rm=d(function(e,r){return Ve(function(n){Cs(e,r),n(ar(mn))})}),ma=!1,ao=[];function ui(e){if(ao.push(e),!ma){for(ma=!0;e=ao.shift();)Nm(e);ma=!1}}function Nm(e){for(;e.f;){var r=e.f.$;if(r===0||r===1){for(;e.g&&e.g.$!==r;)e.g=e.g.i;if(!e.g)return;e.f=e.g.b(e.f.a),e.g=e.g.i}else if(r===2){e.f.c=e.f.b(function(n){e.f=n,ui(e)});return}else if(r===5){if(e.h.length===0)return;e.f=e.f.b(e.h.shift())}else e.g={$:r===3?0:1,b:e.f.b,i:e.g},e.f=e.f.d}}function Tm(e){return Ve(function(r){var n=setTimeout(function(){r(ar(mn))},e);return function(){clearTimeout(n)}})}de(function(e,r,n,t){return li(r,t,e.dZ,e.eH,e.es,function(){return function(){}})});function li(e,r,n,t,a,o){var s=i(ii,e,r?r.flags:void 0);Je(s)||cn(2);var u={},c=n(s.a),f=c.a,m=o(b,f),p=Dm(u,b);function b(v,_){var y=i(t,v,f);m(f=y.a,_),oo(u,y.b,a(f))}return oo(u,c.b,a(f)),p?{ports:p}:{}}var Se={};function Dm(e,r){var n;for(var t in Se){var a=Se[t];a.a&&(n=n||{},n[t]=a.a(t,r)),e[t]=Lm(a,r)}return n}function Bm(e,r,n,t,a){return{b:e,c:r,d:n,e:t,f:a}}function Lm(e,r){var n={g:r,h:void 0},t=e.c,a=e.d,o=e.e,s=e.f;function u(c){return i(ya,u,qm(function(f){var m=f.a;return f.$===0?h(a,n,m,c):o&&s?ie(t,n,m.i,m.j,c):h(t,n,o?m.i:m.j,c)}))}return n.h=si(i(ya,u,e.b))}var Fm=d(function(e,r){return Ve(function(n){e.g(r),n(ar(mn))})});d(function(e,r){return i(Rm,e.h,{$:0,a:r})});function ci(e){return function(r){return{$:1,k:e,l:r}}}function As(e){return{$:2,m:e}}d(function(e,r){return{$:3,n:e,o:r}});var io=[],pa=!1;function oo(e,r,n){if(io.push({p:e,q:r,r:n}),!pa){pa=!0;for(var t;t=io.shift();)Um(t.p,t.q,t.r);pa=!1}}function Um(e,r,n){var t={};gt(!0,r,t,null),gt(!1,n,t,null);for(var a in e)Cs(e[a],{$:"fx",a:t[a]||{i:w,j:w}})}function gt(e,r,n,t){switch(r.$){case 1:var a=r.k,o=Hm(e,a,t,r.l);n[a]=zm(e,o,n[a]);return;case 2:for(var s=r.m;s.b;s=s.b)gt(e,s.a,n,t);return;case 3:gt(e,r.o,n,{s:r.n,t});return}}function Hm(e,r,n,t){function a(s){for(var u=n;u;u=u.t)s=u.s(s);return s}var o=e?Se[r].e:Se[r].f;return i(o,a,t)}function zm(e,r,n){return n=n||{i:w,j:w},e?n.i=rr(r,n.i):n.j=rr(r,n.j),n}function Is(e){Se[e]&&cn(3)}function mi(e,r){return Is(e),Se[e]={e:Jm,u:r,a:Wm},ci(e)}var Jm=d(function(e,r){return r});function Wm(e){var r=[],n=Se[e].u,t=Tm(0);Se[e].b=t,Se[e].c=A(function(s,u,c){for(;u.b;u=u.b)for(var f=r,m=n(u.a),p=0;p<f.length;p++)f[p](m);return t});function a(s){r.push(s)}function o(s){r=r.slice();var u=r.indexOf(s);u>=0&&r.splice(u,1)}return{subscribe:a,unsubscribe:o}}function pi(e,r){return Is(e),Se[e]={f:Km,u:r,a:Gm},ci(e)}var Km=d(function(e,r){return function(n){return e(r(n))}});function Gm(e,r){var n=w,t=Se[e].u,a=ar(null);Se[e].b=a,Se[e].c=A(function(s,u,c){return n=u,a});function o(s){var u=i(ii,t,s);Je(u)||cn(4,e,u.a);for(var c=u.a,f=n;f.b;f=f.b)r(f.a(c))}return{send:o}}var _t,Or=typeof document<"u"?document:{};function fi(e,r){e.appendChild(r)}de(function(e,r,n,t){var a=t.node;return a.parentNode.replaceChild(vr(e,function(){}),a),{}});function xa(e){return{$:0,a:e}}var Ss=d(function(e,r){return d(function(n,t){for(var a=[],o=0;t.b;t=t.b){var s=t.a;o+=s.b||0,a.push(s)}return o+=a.length,{$:1,c:r,d:Vs(n),e:a,f:e,b:o}})}),Y=Ss(void 0),Qm=d(function(e,r){return d(function(n,t){for(var a=[],o=0;t.b;t=t.b){var s=t.a;o+=s.b.b||0,a.push(s)}return o+=a.length,{$:2,c:r,d:Vs(n),e:a,f:e,b:o}})});Qm(void 0);d(function(e,r){return{$:4,j:e,k:r,b:1+(r.b||0)}});function yr(e,r){return{$:5,l:e,m:r,k:void 0}}var Zm=d(function(e,r){return yr([e,r],function(){return e(r)})}),Ym=A(function(e,r,n){return yr([e,r,n],function(){return i(e,r,n)})});de(function(e,r,n,t){return yr([e,r,n,t],function(){return h(e,r,n,t)})});Ye(function(e,r,n,t,a){return yr([e,r,n,t,a],function(){return ie(e,r,n,t,a)})});Hn(function(e,r,n,t,a,o){return yr([e,r,n,t,a,o],function(){return le(e,r,n,t,a,o)})});xs(function(e,r,n,t,a,o,s){return yr([e,r,n,t,a,o,s],function(){return hr(e,r,n,t,a,o,s)})});ti(function(e,r,n,t,a,o,s,u){return yr([e,r,n,t,a,o,s,u],function(){return wc(e,r,n,t,a,o,s,u)})});Es(function(e,r,n,t,a,o,s,u,c){return yr([e,r,n,t,a,o,s,u,c],function(){return kc(e,r,n,t,a,o,s,u,c)})});var Ps=d(function(e,r){return{$:"a0",n:e,o:r}}),Xm=d(function(e,r){return{$:"a1",n:e,o:r}}),Os=d(function(e,r){return{$:"a2",n:e,o:r}}),sr=d(function(e,r){return{$:"a3",n:e,o:r}});A(function(e,r,n){return{$:"a4",n:r,o:{f:e,o:n}}});var ep=/^script$/i,rp=/^(on|formAction$)/i,np=/^\s*j\s*a\s*v\s*a\s*s\s*c\s*r\s*i\s*p\s*t\s*:/i,tp=/^\s*(j\s*a\s*v\s*a\s*s\s*c\s*r\s*i\s*p\s*t\s*:|d\s*a\s*t\s*a\s*:\s*t\s*e\s*x\s*t\s*\/\s*h\s*t\s*m\s*l\s*(,|;))/i;function ap(e){return ep.test(e)?"p":e}function ip(e){return rp.test(e)?"data-"+e:e}function op(e){return np.test(e)?"":e}function qs(e){return tp.test(e)?"":e}d(function(e,r){return r.$==="a0"?i(Ps,r.n,sp(e,r.o)):r});function sp(e,r){var n=gi(r);return{$:r.$,a:n?h(lu,n<3?up:lp,Ce(e),r.a):i(_e,e,r.a)}}var up=d(function(e,r){return l(e(r.a),r.b)}),lp=d(function(e,r){return{ag:e(r.ag),b8:r.b8,bW:r.bW}});function Vs(e){for(var r={};e.b;e=e.b){var n=e.a,t=n.$,a=n.n,o=n.o;if(t==="a2"){a==="className"?so(r,a,o):r[a]=o;continue}var s=r[t]||(r[t]={});t==="a3"&&a==="class"?so(s,a,o):s[a]=o}return r}function so(e,r,n){var t=e[r];e[r]=t?t+" "+n:n}function vr(e,r){var n=e.$;if(n===5)return vr(e.k||(e.k=e.m()),r);if(n===0)return Or.createTextNode(e.a);if(n===4){for(var t=e.k,a=e.j;t.$===4;)typeof a!="object"?a=[a,t.j]:a.push(t.j),t=t.k;var o={j:a,p:r},s=vr(t,o);return s.elm_event_node_ref=o,s}if(n===3){var s=e.h(e.g);return Ea(s,r,e.d),s}var s=e.f?Or.createElementNS(e.f,e.c):Or.createElement(e.c);_t&&e.c=="a"&&s.addEventListener("click",_t(s)),Ea(s,r,e.d);for(var u=e.e,c=0;c<u.length;c++)fi(s,vr(n===1?u[c]:u[c].b,r));return s}function Ea(e,r,n){for(var t in n){var a=n[t];t==="a1"?cp(e,a):t==="a0"?fp(e,r,a):t==="a3"?mp(e,a):t==="a4"?pp(e,a):(t!=="value"&&t!=="checked"||e[t]!==a)&&(e[t]=a)}}function cp(e,r){var n=e.style;for(var t in r)n[t]=r[t]}function mp(e,r){for(var n in r){var t=r[n];typeof t<"u"?e.setAttribute(n,t):e.removeAttribute(n)}}function pp(e,r){for(var n in r){var t=r[n],a=t.f,o=t.o;typeof o<"u"?e.setAttributeNS(a,n,o):e.removeAttributeNS(a,n)}}function fp(e,r,n){var t=e.elmFs||(e.elmFs={});for(var a in n){var o=n[a],s=t[a];if(!o){e.removeEventListener(a,s),t[a]=void 0;continue}if(s){var u=s.q;if(u.$===o.$){s.q=o;continue}e.removeEventListener(a,s)}s=$p(r,o),e.addEventListener(a,s,$i&&{passive:gi(o)<2}),t[a]=s}}var $i;try{window.addEventListener("t",null,Object.defineProperty({},"passive",{get:function(){$i=!0}}))}catch{}function $p(e,r){function n(t){var a=n.q,o=Be(a.a,t);if(Je(o)){for(var s=gi(a),u=o.a,c=s?s<3?u.a:u.ag:u,f=s==1?u.b:s==3&&u.b8,m=(f&&t.stopPropagation(),(s==2?u.b:s==3&&u.bW)&&t.preventDefault(),e),p,b;p=m.j;){if(typeof p=="function")c=p(c);else for(var b=p.length;b--;)c=p[b](c);m=m.p}m(c,f)}}return n.q=r,n}function dp(e,r){return e.$==r.$&&Qr(e.a,r.a)}function Rs(e,r){var n=[];return We(e,r,n,0),n}function Me(e,r,n,t){var a={$:r,r:n,s:t,t:void 0,u:void 0};return e.push(a),a}function We(e,r,n,t){if(e!==r){var a=e.$,o=r.$;if(a!==o)if(a===1&&o===2)r=yp(r),o=1;else{Me(n,0,t,r);return}switch(o){case 5:for(var s=e.l,u=r.l,c=s.length,f=c===u.length;f&&c--;)f=s[c]===u[c];if(f){r.k=e.k;return}r.k=r.m();var m=[];We(e.k,r.k,m,0),m.length>0&&Me(n,1,t,m);return;case 4:for(var p=e.j,b=r.j,v=!1,_=e.k;_.$===4;)v=!0,typeof p!="object"?p=[p,_.j]:p.push(_.j),_=_.k;for(var y=r.k;y.$===4;)v=!0,typeof b!="object"?b=[b,y.j]:b.push(y.j),y=y.k;if(v&&p.length!==b.length){Me(n,0,t,r);return}(v?!vp(p,b):p!==b)&&Me(n,2,t,b),We(_,y,n,t+1);return;case 0:e.a!==r.a&&Me(n,3,t,r.a);return;case 1:uo(e,r,n,t,bp);return;case 2:uo(e,r,n,t,hp);return;case 3:if(e.h!==r.h){Me(n,0,t,r);return}var E=di(e.d,r.d);E&&Me(n,4,t,E);var S=r.i(e.g,r.g);S&&Me(n,5,t,S);return}}}function vp(e,r){for(var n=0;n<e.length;n++)if(e[n]!==r[n])return!1;return!0}function uo(e,r,n,t,a){if(e.c!==r.c||e.f!==r.f){Me(n,0,t,r);return}var o=di(e.d,r.d);o&&Me(n,4,t,o),a(e,r,n,t)}function di(e,r,n){var t;for(var a in e){if(a==="a1"||a==="a0"||a==="a3"||a==="a4"){var o=di(e[a],r[a]||{},a);o&&(t=t||{},t[a]=o);continue}if(!(a in r)){t=t||{},t[a]=n?n==="a1"?"":n==="a0"||n==="a3"?void 0:{f:e[a].f,o:void 0}:typeof e[a]=="string"?"":null;continue}var s=e[a],u=r[a];s===u&&a!=="value"&&a!=="checked"||n==="a0"&&dp(s,u)||(t=t||{},t[a]=u)}for(var c in r)c in e||(t=t||{},t[c]=r[c]);return t}function bp(e,r,n,t){var a=e.e,o=r.e,s=a.length,u=o.length;s>u?Me(n,6,t,{v:u,i:s-u}):s<u&&Me(n,7,t,{v:s,e:o});for(var c=s<u?s:u,f=0;f<c;f++){var m=a[f];We(m,o[f],n,++t),t+=m.b||0}}function hp(e,r,n,t){for(var a=[],o={},s=[],u=e.e,c=r.e,f=u.length,m=c.length,p=0,b=0,v=t;p<f&&b<m;){var _=u[p],y=c[b],E=_.a,S=y.a,P=_.b,H=y.b,ne=void 0,Ie=void 0;if(E===S){v++,We(P,H,a,v),v+=P.b||0,p++,b++;continue}var ke=u[p+1],pr=c[b+1];if(ke){var ce=ke.a,fr=ke.b;Ie=S===ce}if(pr){var et=pr.a,jr=pr.b;ne=E===et}if(ne&&Ie){v++,We(P,jr,a,v),yn(o,a,E,H,b,s),v+=P.b||0,v++,xn(o,a,E,fr,v),v+=fr.b||0,p+=2,b+=2;continue}if(ne){v++,yn(o,a,S,H,b,s),We(P,jr,a,v),v+=P.b||0,p+=1,b+=2;continue}if(Ie){v++,xn(o,a,E,P,v),v+=P.b||0,v++,We(fr,H,a,v),v+=fr.b||0,p+=2,b+=1;continue}if(ke&&ce===et){v++,xn(o,a,E,P,v),yn(o,a,S,H,b,s),v+=P.b||0,v++,We(fr,jr,a,v),v+=fr.b||0,p+=2,b+=2;continue}break}for(;p<f;){v++;var _=u[p],P=_.b;xn(o,a,_.a,P,v),v+=P.b||0,p++}for(;b<m;){var g=g||[],y=c[b];yn(o,a,y.a,y.b,void 0,g),b++}(a.length>0||s.length>0||g)&&Me(n,8,t,{w:a,x:s,y:g})}var Ns="_elmW6BL";function yn(e,r,n,t,a,o){var s=e[n];if(!s){s={c:0,z:t,r:a,s:void 0},o.push({r:a,A:s}),e[n]=s;return}if(s.c===1){o.push({r:a,A:s}),s.c=2;var u=[];We(s.z,t,u,s.r),s.r=a,s.s.s={w:u,A:s};return}yn(e,r,n+Ns,t,a,o)}function xn(e,r,n,t,a){var o=e[n];if(!o){var s=Me(r,9,a,void 0);e[n]={c:1,z:t,r:a,s};return}if(o.c===0){o.c=2;var u=[];We(t,o.z,u,a),Me(r,9,a,{w:u,A:o});return}xn(e,r,n+Ns,t,a)}function Ts(e,r,n,t){En(e,r,n,0,0,r.b,t)}function En(e,r,n,t,a,o,s){for(var u=n[t],c=u.r;c===a;){var f=u.$;if(f===1)Ts(e,r.k,u.s,s);else if(f===8){u.t=e,u.u=s;var m=u.s.w;m.length>0&&En(e,r,m,0,a,o,s)}else if(f===9){u.t=e,u.u=s;var p=u.s;if(p){p.A.s=e;var m=p.w;m.length>0&&En(e,r,m,0,a,o,s)}}else u.t=e,u.u=s;if(t++,!(u=n[t])||(c=u.r)>o)return t}var b=r.$;if(b===4){for(var v=r.k;v.$===4;)v=v.k;return En(e,v,n,t,a+1,o,e.elm_event_node_ref)}for(var _=r.e,y=e.childNodes,E=0;E<_.length;E++){a++;var S=b===1?_[E]:_[E].b,P=a+(S.b||0);if(a<=c&&c<=P&&(t=En(y[E],S,n,t,a,P,s),!(u=n[t])||(c=u.r)>o))return t;a=P}return t}function Ds(e,r,n,t){return n.length===0?e:(Ts(e,r,n,t),wt(e,n))}function wt(e,r){for(var n=0;n<r.length;n++){var t=r[n],a=t.t,o=gp(a,t);a===e&&(e=o)}return e}function gp(e,r){switch(r.$){case 0:return _p(e,r.s,r.u);case 4:return Ea(e,r.u,r.s),e;case 3:return e.replaceData(0,e.length,r.s),e;case 1:return wt(e,r.s);case 2:return e.elm_event_node_ref?e.elm_event_node_ref.j=r.s:e.elm_event_node_ref={j:r.s,p:r.u},e;case 6:for(var o=r.s,t=0;t<o.i;t++)e.removeChild(e.childNodes[o.v]);return e;case 7:for(var o=r.s,n=o.e,t=o.v,a=e.childNodes[t];t<n.length;t++)e.insertBefore(vr(n[t],r.u),a);return e;case 9:var o=r.s;if(!o)return e.parentNode.removeChild(e),e;var s=o.A;return typeof s.r<"u"&&e.parentNode.removeChild(e),s.s=wt(e,o.w),e;case 8:return wp(e,r);case 5:return r.s(e);default:cn(10)}}function _p(e,r,n){var t=e.parentNode,a=vr(r,n);return a.elm_event_node_ref||(a.elm_event_node_ref=e.elm_event_node_ref),t&&a!==e&&t.replaceChild(a,e),a}function wp(e,r){var n=r.s,t=kp(n.y,r);e=wt(e,n.w);for(var a=n.x,o=0;o<a.length;o++){var s=a[o],u=s.A,c=u.c===2?u.s:vr(u.z,r.u);e.insertBefore(c,e.childNodes[s.r])}return t&&fi(e,t),e}function kp(e,r){if(e){for(var n=Or.createDocumentFragment(),t=0;t<e.length;t++){var a=e[t],o=a.A;fi(n,o.c===2?o.s:vr(o.z,r.u))}return n}}function vi(e){if(e.nodeType===3)return xa(e.textContent);if(e.nodeType!==1)return xa("");for(var r=w,n=e.attributes,t=n.length;t--;){var a=n[t],o=a.name,s=a.value;r=rr(i(sr,o,s),r)}for(var u=e.tagName.toLowerCase(),c=w,f=e.childNodes,t=f.length;t--;)c=rr(vi(f[t]),c);return h(Y,u,r,c)}function yp(e){for(var r=e.e,n=r.length,t=new Array(n),a=0;a<n;a++)t[a]=r[a].b;return{$:1,c:e.c,d:e.d,e:t,f:e.f,b:e.b}}var xp=de(function(e,r,n,t){return li(r,t,e.dZ,e.eH,e.es,function(a,o){var s=e.eJ,u=t.node,c=vi(u);return Bs(o,function(f){var m=s(f),p=Rs(c,m);u=Ds(u,c,p,a),c=m})})});de(function(e,r,n,t){return li(r,t,e.dZ,e.eH,e.es,function(a,o){var s=e.b0&&e.b0(a),u=e.eJ,c=Or.title,f=Or.body,m=vi(f);return Bs(o,function(p){_t=s;var b=u(p),v=Y("body")(w)(b.dy),_=Rs(m,v);f=Ds(f,m,_,a),m=v,_t=0,c!==b.dg&&(Or.title=c=b.dg)})})});var kt=typeof requestAnimationFrame<"u"?requestAnimationFrame:function(e){return setTimeout(e,1e3/60)};function Bs(e,r){r(e);var n=0;function t(){n=n===1?0:(kt(t),r(e),1)}return function(a,o){e=a,o?(r(e),n===2&&(n=1)):(n===0&&kt(t),n=2)}}d(function(e,r){return i($n,Wt,Ve(function(){r&&history.go(r),e()}))});d(function(e,r){return i($n,Wt,Ve(function(){history.pushState({},"",r),e()}))});d(function(e,r){return i($n,Wt,Ve(function(){history.replaceState({},"",r),e()}))});var Ep={addEventListener:function(){},removeEventListener:function(){}},jp=typeof window<"u"?window:Ep;A(function(e,r,n){return Ms(Ve(function(t){function a(o){si(n(o))}return e.addEventListener(r,a,$i&&{passive:!0}),function(){e.removeEventListener(r,a)}}))});d(function(e,r){var n=Be(e,r);return Je(n)?C(n.a):k});function Ls(e,r){return Ve(function(n){kt(function(){var t=document.getElementById(e);n(t?ar(r(t)):Om(tf(e)))})})}function Mp(e){return Ve(function(r){kt(function(){r(ar(e()))})})}d(function(e,r){return Ls(r,function(n){return n[e](),mn})});d(function(e,r){return Mp(function(){return jp.scroll(e,r),mn})});A(function(e,r,n){return Ls(e,function(t){return t.scrollLeft=r,t.scrollTop=n,mn})});var lo;function Cp(){return lo||(lo=document.createElement("a"))}var Ap=A(function(e,r,n){return Ve(function(t){var a=new Blob([n],{type:r});if(navigator.msSaveOrOpenBlob){navigator.msSaveOrOpenBlob(a,e);return}var o=Cp(),s=URL.createObjectURL(a);o.href=s,o.download=e,Fs(o),URL.revokeObjectURL(s)})});function Fs(e){if(typeof MouseEvent=="function")e.dispatchEvent(new MouseEvent("click"));else{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),document.body.appendChild(e),e.dispatchEvent(r),document.body.removeChild(e)}}var hn;function Ip(e){return Ve(function(r){hn=document.createElement("input"),hn.type="file",hn.accept=i(Pe,",",e),hn.addEventListener("change",function(n){r(ar(n.target.files[0]))}),Fs(hn)})}function Sp(e){return Ve(function(r){var n=new FileReader;return n.addEventListener("loadend",function(){r(ar(n.result))}),n.readAsText(e),function(){n.abort()}})}var Pp=/.^/,Op=d(function(e,r){var n="g";e.d4&&(n+="m"),e.dA&&(n+="i");try{return C(new RegExp(r,n))}catch{return k}}),qp=d(function(e,r){return r.match(e)!==null}),Us=A(function(e,r,n){for(var t=[],a=0,o=n,s=r.lastIndex,u=-1,c;a++<e&&(c=r.exec(o))&&u!=r.lastIndex;){for(var f=c.length-1,m=new Array(f);f>0;){var p=c[f];m[--f]=p?C(p):k}t.push(ie(Ou,c[0],c.index,a,$(m))),u=r.lastIndex}return r.lastIndex=s,$(t)}),Hs=de(function(e,r,n,t){var a=0;function o(s){if(a++>=e)return s;for(var u=arguments.length-3,c=new Array(u);u>0;){var f=arguments[u];c[--u]=f?C(f):k}return n(ie(Ou,s,arguments[arguments.length-2],a,$(c)))}return t.replace(r,o)});A(function(e,r,n){for(var t=n,a=[],o=r.lastIndex,s=r.lastIndex;e--;){var u=r.exec(t);if(!u)break;a.push(t.slice(o,u.index)),o=r.lastIndex}return a.push(t.slice(o)),r.lastIndex=s,$(a)});var zs=1/0;d(function(e,r){return e&r});d(function(e,r){return e|r});d(function(e,r){return e^r});d(function(e,r){return r<<e});d(function(e,r){return r>>e});d(function(e,r){return r>>>e});function Vp(e){return encodeURIComponent(e)}function Rp(e){try{return C(decodeURIComponent(e))}catch{return k}}var M=Pc,tt=Mc;A(function(e,r,n){var t=n.c,a=n.d,o=d(function(s,u){if(s.$){var f=s.a;return h(tt,e,u,f)}else{var c=s.a;return h(tt,o,u,c)}});return h(tt,o,h(tt,e,r,a),t)});var Js=A(function(e,r,n){e:for(;;){if(n.$===-2)return r;var t=n.b,a=n.c,o=n.d,s=n.e,u=e,c=h(e,t,a,h(Js,e,r,s)),f=o;e=u,r=c,n=f;continue e}}),Nr=function(e){return h(Js,A(function(r,n,t){return i(M,l(r,n),t)}),w,e)},Ws=1,Np=2,Ks=0,xe=function(e){return{$:1,a:e}},bi=d(function(e,r){return{$:3,a:e,b:r}}),co=d(function(e,r){return{$:0,a:e,b:r}}),Gs=d(function(e,r){return{$:1,a:e,b:r}}),fe=function(e){return{$:0,a:e}},Tp=function(e){return{$:2,a:e}},C=function(e){return{$:0,a:e}},k={$:1},Qs=nm,Zs=Mm,Oe=js,Pe=d(function(e,r){return i(Gc,e,ai(r))}),Jn=d(function(e,r){return $(i(Kc,e,r))}),Ys=function(e){return i(Pe,`
    `,i(Jn,`
`,e))},ve=A(function(e,r,n){e:for(;;)if(n.b){var t=n.a,a=n.b,o=e,s=i(e,t,r),u=a;e=o,r=s,n=u;continue e}else return r}),Xs=function(e){return h(ve,d(function(r,n){return n+1}),0,e)},Dp=Oc,Bp=A(function(e,r,n){e:for(;;)if(oe(e,r)<1){var t=e,a=r-1,o=i(M,r,n);e=t,r=a,n=o;continue e}else return n}),Lp=d(function(e,r){return h(Bp,e,r,w)}),eu=d(function(e,r){return h(Dp,e,i(Lp,0,Xs(r)-1),r)}),pn=um,ru=function(e){var r=pn(e);return 97<=r&&r<=122},nu=function(e){var r=pn(e);return r<=90&&65<=r},Fp=function(e){return ru(e)||nu(e)},yt=function(e){var r=pn(e);return r<=57&&48<=r},Up=function(e){return ru(e)||nu(e)||yt(e)},we=function(e){return h(ve,M,w,e)},fn=Uc,Hp=d(function(e,r){return`

(`+(Oe(e+1)+(") "+Ys(tu(r))))}),tu=function(e){return i(zp,e,w)},zp=d(function(e,r){e:for(;;)switch(e.$){case 0:var n=e.a,s=e.b,t=function(){var y=fn(n);if(y.$===1)return!1;var E=y.a,S=E.a,P=E.b;return Fp(S)&&i(Qs,Up,P)}(),a=t?"."+n:"['"+(n+"']"),c=s,f=i(M,a,r);e=c,r=f;continue e;case 1:var o=e.a,s=e.b,u="["+(Oe(o)+"]"),c=s,f=i(M,u,r);e=c,r=f;continue e;case 2:var m=e.a;if(m.b)if(m.b.b){var p=function(){return r.b?"The Json.Decode.oneOf at json"+i(Pe,"",we(r)):"Json.Decode.oneOf"}(),_=p+(" failed in the following "+(Oe(Xs(m))+" ways:"));return i(Pe,`

`,i(M,_,i(eu,Hp,m)))}else{var s=m.a,c=s,f=r;e=c,r=f;continue e}else return"Ran into a Json.Decode.oneOf with no possibilities"+function(){return r.b?" at json"+i(Pe,"",we(r)):"!"}();default:var b=e.a,v=e.b,_=function(){return r.b?"Problem with the value at json"+(i(Pe,"",we(r))+`:

    `):`Problem with the given value:

`}();return _+(Ys(i(Zs,4,v))+(`

`+b))}}),Ze=32,ja=de(function(e,r,n,t){return{$:0,a:e,b:r,c:n,d:t}}),Ma=yc,au=Nc,iu=d(function(e,r){return ro(r)/ro(e)}),Ca=au(i(iu,2,Ze)),Jp=ie(ja,0,Ca,Ma,Ma),ou=Ec,Wp=function(e){return{$:1,a:e}};d(function(e,r){return e(r)});var Kp=d(function(e,r){return r(e)}),Gp=Ac,Qp=Tc,mo=xc,su=d(function(e,r){return oe(e,r)>0?e:r}),Zp=function(e){return{$:0,a:e}},uu=jc,Yp=d(function(e,r){e:for(;;){var n=i(uu,Ze,e),t=n.a,a=n.b,o=i(M,Zp(t),r);if(a.b){var s=a,u=o;e=s,r=u;continue e}else return we(o)}}),hi=function(e){var r=e.a;return r},Xp=d(function(e,r){e:for(;;){var n=au(r/Ze);if(n===1)return i(uu,Ze,e).a;var t=i(Yp,e,w),a=n;e=t,r=a;continue e}}),ef=d(function(e,r){if(r.s){var n=r.s*Ze,t=Qp(i(iu,Ze,n-1)),a=e?we(r.x):r.x,o=i(Xp,a,r.s);return ie(ja,mo(r.w)+n,i(su,5,t*Ca),o,r.w)}else return ie(ja,mo(r.w),Ca,Ma,r.w)}),rf=Ye(function(e,r,n,t,a){e:for(;;){if(r<0)return i(ef,!1,{x:t,s:n/Ze|0,w:a});var o=Wp(h(ou,Ze,r,e)),s=e,u=r-Ze,c=n,f=i(M,o,t),m=a;e=s,r=u,n=c,t=f,a=m;continue e}}),nf=d(function(e,r){if(e<=0)return Jp;var n=e%Ze,t=h(ou,n,e-n,r),a=e-n-Ze;return le(rf,r,a,e,w,t)}),Je=function(e){return!e.$},ir=wm,_e=ym,lu=xm,Ce=cm,gi=function(e){switch(e.$){case 0:return 0;case 1:return 1;case 2:return 2;default:return 3}},Tr=function(e){return e},tf=Tr,po=Hn(function(e,r,n,t,a,o){return{cw:o,cA:r,cV:t,cX:n,c1:e,c2:a}}),af=tm,W=Hc,Ge=Qc,xr=d(function(e,r){return e<1?r:h(Ge,e,W(r),r)}),zt=im,ur=function(e){return e===""},Ur=d(function(e,r){return e<1?"":h(Ge,0,e,r)}),Jt=om,fo=Ye(function(e,r,n,t,a){if(ur(a)||i(af,"@",a))return k;var o=i(zt,":",a);if(o.b){if(o.b.b)return k;var s=o.a,u=Jt(i(xr,s+1,a));if(u.$===1)return k;var c=u;return C(hr(po,e,i(Ur,s,a),c,r,n,t))}else return C(hr(po,e,a,k,r,n,t))}),$o=de(function(e,r,n,t){if(ur(t))return k;var a=i(zt,"/",t);if(a.b){var o=a.a;return le(fo,e,i(xr,o,t),r,n,i(Ur,o,t))}else return le(fo,e,"/",r,n,t)}),vo=A(function(e,r,n){if(ur(n))return k;var t=i(zt,"?",n);if(t.b){var a=t.a;return ie($o,e,C(i(xr,a+1,n)),r,i(Ur,a,n))}else return ie($o,e,k,r,n)});d(function(e,r){if(ur(r))return k;var n=i(zt,"#",r);if(n.b){var t=n.a;return h(vo,e,C(i(xr,t+1,r)),i(Ur,t,r))}else return h(vo,e,k,r)});var cu=am,Wt=function(e){},Wn=ar,of=Wn(0),mu=de(function(e,r,n,t){if(t.b){var a=t.a,o=t.b;if(o.b){var s=o.a,u=o.b;if(u.b){var c=u.a,f=u.b;if(f.b){var m=f.a,p=f.b,b=n>500?h(ve,e,r,we(p)):ie(mu,e,r,n+1,p);return i(e,a,i(e,s,i(e,c,i(e,m,b))))}else return i(e,a,i(e,s,i(e,c,r)))}else return i(e,a,i(e,s,r))}else return i(e,a,r)}else return r}),Hr=A(function(e,r,n){return ie(mu,e,r,0,n)}),Z=d(function(e,r){return h(Hr,d(function(n,t){return i(M,e(n),t)}),w,r)}),xt=ya,_i=d(function(e,r){return i(xt,function(n){return Wn(e(n))},r)}),sf=A(function(e,r,n){return i(xt,function(t){return i(xt,function(a){return Wn(i(e,t,a))},n)},r)}),uf=function(e){return h(Hr,sf(M),Wn(w),e)},lf=Fm,cf=d(function(e,r){var n=r;return Ms(i(xt,lf(e),n))}),mf=A(function(e,r,n){return i(_i,function(t){return 0},uf(i(Z,cf(e),r)))}),pf=A(function(e,r,n){return Wn(0)}),ff=d(function(e,r){var n=r;return i(_i,e,n)});Se.Task=Bm(of,mf,pf,ff);var $f=ci("Task"),$n=d(function(e,r){return $f(i(_i,e,r))}),df=xp,Fe=hm,ft=function(e){return{$:0,a:e}},Yr=ii,Aa={$:-2},Ue=Aa,at={a5:w,ae:Ue,_:k,am:k,L:Ue,aR:Ue,aS:w,aD:Ue,ab:Ue,aU:w,P:Ue},Xr=d(function(e,r){return r.b?h(Hr,M,r,e):e}),qr=function(e){return h(Hr,Xr,w,e)},pu=d(function(e,r){return h(ve,Sm(e),Cm(),r)}),en=oi,vf=mi("evaluateAll",pu(en)),fu=Sc,Ee=d(function(e,r){e:for(;;){if(r.$===-2)return k;var n=r.b,t=r.c,a=r.d,o=r.e,s=i(fu,e,n);switch(s){case 0:var u=e,c=a;e=u,r=c;continue e;case 1:return C(t);default:var u=e,c=o;e=u,r=c;continue e}}}),x=d(function(e,r){if(r.$)return e;var n=r.a;return n}),Ia=function(e){var r=i(x,"",e.am),n=qr(i(x,w,i(Ee,r,e.aD)));return l(e,vf(i(Xr,e.a5,i(Xr,e.aS,i(Xr,n,i(Z,hi,e.aU))))))},bf=d(function(e,r){return qr(i(Z,e,r))}),hf=function(e){return i(bf,function(r){var n=r.a,t=r.b.er;return i(M,n,t)},Nr(e))},Kn=qc,gf=function(e){return i(Z,hi,i(Kn,function(r){var n=r.b.cE;return n},Nr(e)))},_f=A(function(e,r,n){var t=e(r);if(t.$)return n;var a=t.a;return i(M,a,n)}),je=d(function(e,r){return h(Hr,_f(e),w,r)}),wf="resultats",kf=function(e){return i(Jn," . ",e)},yf=function(e){return i(je,function(r){var n=r.a,t=r.b,a=kf(n);if(a.b&&a.b.b&&!a.b.b.b){var o=a.a;return a.b,re(o,wf)?C(l(n,t)):k}else return k},Nr(e))},te=function(e){if(e.b){var r=e.a;return e.b,C(r)}else return k},xf=As,dr=xf(w),Ne=Ye(function(e,r,n,t,a){return{$:-1,a:e,b:r,c:n,d:t,e:a}}),bo=Ye(function(e,r,n,t,a){if(a.$===-1&&!a.a){a.a;var o=a.b,s=a.c,u=a.d,c=a.e;if(t.$===-1&&!t.a){t.a;var f=t.b,m=t.c,p=t.d,b=t.e;return le(Ne,0,r,n,le(Ne,1,f,m,p,b),le(Ne,1,o,s,u,c))}else return le(Ne,e,o,s,le(Ne,0,r,n,t,u),c)}else if(t.$===-1&&!t.a&&t.d.$===-1&&!t.d.a){t.a;var f=t.b,m=t.c,v=t.d;v.a;var _=v.b,y=v.c,E=v.d,S=v.e,b=t.e;return le(Ne,0,f,m,le(Ne,1,_,y,E,S),le(Ne,1,r,n,b,a))}else return le(Ne,e,r,n,t,a)}),Sa=A(function(e,r,n){if(n.$===-2)return le(Ne,0,e,r,Aa,Aa);var t=n.a,a=n.b,o=n.c,s=n.d,u=n.e,c=i(fu,e,a);switch(c){case 0:return le(bo,t,a,o,h(Sa,e,r,s),u);case 1:return le(Ne,t,a,r,s,u);default:return le(bo,t,a,o,s,h(Sa,e,r,u))}}),Dr=A(function(e,r,n){var t=h(Sa,e,r,n);if(t.$===-1&&!t.a){t.a;var a=t.b,o=t.c,s=t.d,u=t.e;return le(Ne,1,a,o,s,u)}else{var c=t;return c}}),$u=function(e){return h(ve,d(function(r,n){var t=r.a,a=r.b;return h(Dr,t,a,n)}),Ue,e)},Ef=_m,Et=function(e){return i(_e,$u,Ef(e))},jf=ti(function(e,r,n,t,a,o,s,u){return{dK:a,dL:r,dS:o,d7:u,ef:e,et:n,dg:s,dj:t}}),Mf=A(function(e,r,n){return{ds:r,el:e,em:n}}),Cf=function(e){return{$:0,a:e}},Af=function(e){return{$:2,a:e}},If=function(e){return{$:7,a:e}},Sf=function(e){return{$:1,a:e}},Pf=function(e){return{$:5,a:e}},Of=function(e){return{$:6,a:e}},qf=function(e){return{$:4,a:e}},Vf=function(e){return{$:3,a:e}},fa=function(e){return i(ir,e,Ce(0))},Ke=vm,Cn=function(e){return{$:2,a:e}},Rf={$:3},du=function(e){return{$:1,a:e}},wi=function(e){return{$:0,a:e}},ki=pm,Nf=fm,Kt=bm,Gt=km,be=dm,yi=Gt($([i(_e,function(e){switch(e){case"oui":return Cn(!0);case"non":return Cn(!1);default:return wi(e)}},be),i(_e,du,Nf),i(_e,Cn,ki),Kt(Rf)])),Te=function(e){return Gt($([Kt(k),i(_e,C,e)]))},vu=lu(Kp),jt=d(function(e,r){return h(Hr,Fe,r,e)}),Vr=$m,Tf=A(function(e,r,n){var t=function(o){return Gt($([o,Kt(n)]))},a=function(o){var s=i(Yr,i(jt,e,Vr),o);if(s.$)return Ce(n);var u=s.a,c=i(Yr,t(r),u);if(c.$)return i(jt,e,t(r));var f=c.a;return Ce(f)};return i(ir,a,Vr)}),De=de(function(e,r,n,t){return i(vu,h(Tf,$([e]),r,n),t)}),Df=d(function(e,r){return{dC:e,ec:r}}),er=A(function(e,r,n){return i(vu,i(Fe,e,r),n)}),Bf=h(er,"possibilités",Ke(be),ie(De,"choix obligatoire",Te(be),k,Ce(Df))),Lf=d(function(e,r){return{dv:r,eg:e}}),xi=Et(yi),Ff=h(er,"avec",xi,h(er,"règle",be,Ce(Lf)));function An(){return ie(De,"sinon",Te(In()),k,ie(De,"alors",Te(In()),k,ie(De,"si",Te(In()),k,Ce(Mf))))}function In(){return Gt($([i(_e,Cf,yi),i(_e,Sf,i(Fe,"somme",Ke(be))),i(_e,Af,i(Fe,"moyenne",Ke(be))),i(_e,Vf,i(Fe,"variations",Ke(fa(function(e){return An()})))),i(_e,qf,i(Fe,"une possibilité",Bf)),i(_e,Pf,i(Fe,"toutes ces conditions",Ke(fa(function(e){return An()})))),i(_e,Of,i(Fe,"une de ces conditions",Ke(fa(function(e){return An()})))),i(_e,If,i(Fe,"recalcul",Ff))]))}var Uf=An();An=function(){return Uf};var Pa=In();In=function(){return Pa};var Hf=ie(De,"note",Te(be),k,ie(De,"titre",Te(be),k,ie(De,"formule",Te(Pa),k,ie(De,"par défaut",Te(Pa),k,ie(De,"unité",Te(be),k,ie(De,"résumé",Te(be),k,ie(De,"description",Te(be),k,ie(De,"question",Te(be),k,Ce(jf))))))))),zf=Et(Hf),Jf=d(function(e,r){return{ae:e,aD:r}}),Wf=d(function(e,r){return{cE:e,er:r}}),Kf=mm,Gf=h(er,"sub",Ke(be),h(er,"index",Kf,Ce(Wf))),Qf=h(er,"questions",Et(Ke(Ke(be))),h(er,"categories",Et(Gf),Ce(Jf))),Zf=function(e){var r=ye(i(Yr,zf,e.b_),i(Yr,Qf,e.b9),i(Yr,xi,e.P));if(r.a.$){var s=r.a.a;return l(O(at,{_:C(ft(s))}),dr)}else if(r.b.$){var s=r.b.a;return l(O(at,{_:C(ft(s))}),dr)}else if(r.c.$){var s=r.c.a;return l(O(at,{_:C(ft(s))}),dr)}else{var n=r.a.a,t=r.b.a,a=r.c.a,o=gf(t.ae);return Ia(O(at,{a5:hf(t.ae),ae:t.ae,am:te(o),aS:o,aD:t.aD,ab:n,aU:yf(n),P:a}))}},Yf={$:3},Xf=function(e){return{$:2,a:e}},e$=function(e){return{$:1,a:e}},r$=As,Mt=gm,n$=pi("evaluatedRule",i(ir,function(e){return i(ir,function(r){return Ce(l(e,r))},i(Mt,1,Vr))},i(Mt,0,be))),t$=pi("evaluatedRules",Ke(i(ir,function(e){return i(ir,function(r){return Ce(l(e,r))},i(Mt,1,Vr))},i(Mt,0,be)))),a$=pi("situationUpdated",Kt(0)),i$=function(e){return r$($([n$(e$),t$(Xf),a$(function(r){return Yf})]))},o$=function(e){return{$:8,a:e}},s$={$:1},u$=function(e){return{$:7,a:e}},l$=Em,Ei=A(function(e,r,n){e:for(;;){if(n.$===-2)return r;var t=n.b,a=n.c,o=n.d,s=n.e,u=e,c=h(e,t,a,h(Ei,e,r,o)),f=s;e=u,r=c,n=f;continue e}}),c$=A(function(e,r,n){return h(Ei,A(function(t,a,o){return h(Im,e(t),r(a),o)}),Am(),n)}),m$=oi,p$=Pm,f$=function(e){return"'"+(e+"'")},bu=function(e){switch(e.$){case 0:var r=e.a;return en(f$(r));case 1:var n=e.a;return m$(n);case 2:var t=e.a;return en(t?"oui":"non");default:return p$}},$a=function(e){return h(c$,Tr,bu,e)},$$=d(function(e,r){return i($n,r,Ip(e))}),ho=mi("setSituation",Tr),d$=A(function(e,r,n){return i($n,Wt,h(Ap,e,r,n))}),v$=Sp,b$=A(function(e,r,n){return{cI:n,d3:r,aC:e}}),h$=h(er,"isNullable",ki,h(er,"missingVariables",Ke(be),h(er,"nodeValue",yi,Ce(b$)))),go=d(function(e,r){var n=e.a,t=e.b,a=i(Yr,h$,t);if(a.$){var s=a.a;return O(r,{_:C(ft(s))})}else{var o=a.a;return O(r,{L:h(Dr,n,o,r.L)})}}),g$=mi("updateSituation",function(e){var r=e.a,n=e.b;return i(pu,Tr,$([en(r),Tr(n)]))}),_$=d(function(e,r){switch(e.$){case 0:var n=e.a,o=n.a,t=n.b;return l(O(r,{P:h(Dr,o,t,r.P)}),g$(l(o,bu(t))));case 1:var a=e.a,o=a.a,s=a.b;return l(i(go,l(o,s),r),dr);case 2:var u=e.a;return l(h(ve,go,r,u),dr);case 3:return Ia(r);case 4:var c=e.a;return Ia(O(r,{am:C(c)}));case 5:var c=e.a,f=e.b,m=h(Dr,c,f,r.aR);return l(O(r,{aR:m}),dr);case 9:return l(r,h(d$,"simulation-ekofest.json","json",i(Zs,0,$a(r.P))));case 7:var p=e.a;return l(r,i($n,o$,v$(p)));case 6:return l(r,i($$,$(["json"]),u$));case 10:return l(O(r,{P:Ue}),ho($a(Ue)));case 8:var b=e.a,v=i(l$,xi,b);if(v.$)return l(O(r,{_:C(s$)}),dr);var _=v.a;return l(O(r,{P:_}),ho($a(_)));default:return l(r,dr)}}),Re=d(function(e,r){return i(Os,e,en(r))}),I=Re("className"),T=Y("div"),_o=function(e){return e.$===-2},w$=Zm,it=w$,k$=Ym,y$=k$,x$=function(e){return{$:4,a:e}},Vn=Y("a"),me=d(function(e,r){if(r.$)return k;var n=r.a;return e(n)}),hu=Y("li"),E$=function(e){return{$:0,a:e}},gu=Ps,_u=d(function(e,r){return i(gu,e,E$(r))}),Sn=function(e){return i(_u,"click",Ce(e))},j$=xa,B=j$,Qt=em,wu=Y("ul"),M$=d(function(e,r){return i(T,$([I("flex flex-wrap md:justify-center bg-neutral rounded-md border border-base-200 p-2 mb-4")]),$([i(wu,$([I("menu menu-horizontal gap-2")]),i(Z,function(n){var t=i(x,"",i(me,function(a){return re(a,n)?C(" bg-primary text-white border-transparent"):k},r));return i(hu,w,$([i(Vn,$([I("bg-base-100 rounded-md border border-base-200 cursor-pointer px-4 py-2 text-xs font-semibold hover:bg-primary hover:text-white hover:border-transparent"+t),Sn(x$(n))]),$([B(Qt(n))]))]))},e))]))}),Zt=function(e){var r=e.a;return r},R=A(function(e,r,n){return r(e(n))}),lr=function(e){return i(Pe,"",e)},ji=function(e){return i(R,Z(e),lr)},C$=Ue,A$=d(function(e,r){var n=r;return h(Dr,e,0,n)}),I$=function(e){return h(ve,A$,C$,e)},S$=I$($(["."," ",",","#","$","%","(",")","&",";",":",'"',"'","*","~","!","@","^","+","=","/","?",">","<","[","]","{","}","|","`"])),ku=d(function(e,r){var n=i(Ee,e,r);return!n.$}),P$=d(function(e,r){var n=r;return i(ku,e,n)}),yu=Lc,O$=function(e){return!i(P$,e,S$)},Ct=zc,Oa=Ct(O$),Mi=Dc,Ir=d(function(e,r){return Oe(Mi(r)*e)}),q$=function(e){switch(e.$){case 0:switch(e.a.$){case 1:var a=e.a.a;return"y"+i(Ir,1,a);case 0:var t=e.a.a;return"x"+i(Ir,1,t);default:var r=e.a,t=r.a,a=r.b;return"x"+(i(Ir,1,t)+("y"+i(Ir,1,a)))}case 2:var n=e.a;return"r"+i(Ir,1,n);default:var t=e.a,a=e.b;return"sx"+(i(Ir,100,t)+("sy"+i(Ir,100,a)))}},V$=d(function(e,r){return Oe(Mi(r*e))}),R$=function(e){switch(e.$){case 0:var n=e.a;return"o"+i(V$,100,n);case 1:var r=e.a;return q$(r);default:var n=e.a,t=e.b;return J(Oa(n),Oa(t))}},N$=function(e){var r=e.a,n=e.b;return"f"+(Oe(Mi(r))+i(ji,R$,n))},T$=ji(N$),xu=function(e){var r=e.c;return r},D$=function(e){return!Zt(e)},B$=function(e){if(e.$){var r=e.a;return"count-"+Oe(r)}else return"infinite"},he=js,Eu=function(e){switch(e.$){case 0:var r=e.a,n=e.b,t=e.c,a=e.d;return"cubic-bezier("+(i(Pe,",",$([he(r),he(n),he(t),he(a)]))+")");case 1:return"linear";case 2:return"ease";case 3:return"ease-in";case 4:return"ease-out";default:return"ease-in-out"}},L$=function(e){switch(e.$){case 1:var r=e.a;return"d"+Oe(r);case 2:var n=e.a;return Oa(Eu(n));case 0:var t=e.a;return B$(t);case 3:return"yoyo";default:return"rev"}},F$=ji(L$),ju=function(e){var r=e.b;return r},Yt=function(e){return D$(e)?"anim-empty":"anim-"+(Oe(Zt(e))+(F$(ju(e))+T$(xu(e))))},U$=function(e){return Y(ap(e))},Mu=U$,Cu=function(e){return Oe(e)+"ms"},H$=function(e){return Cu(Zt(e))},z$=d(function(e,r){switch(e.$){case 1:var n=e.a;return O(r,{a9:C(n)});case 0:var t=e.a;return O(r,{aA:C(t)});case 2:var a=e.a;return O(r,{bq:C(a)});case 3:return O(r,{az:!0});default:return O(r,{aV:!0})}}),J$={a9:k,az:!1,aA:k,aV:!1,bq:k},wo=function(e){return{$:1,a:e}},W$={$:0},K$=function(e){var r=e.aA;if(r.$)return wo(2);if(r.a.$){var n=r.a.a;return wo(n*2)}else return r.a,W$},G$=function(e){return e.az?O(e,{aA:C(K$(e))}):e},Q$=i(R,ju,i(R,i(ve,z$,J$),G$)),Z$=function(e){switch(e){case 0:return"alternate";case 1:return"reverse";default:return"alternate-reverse"}},Y$=function(e){if(e.$){var r=e.a;return Oe(r)}else return"infinite"},V=d(function(e,r){if(r.$)return k;var n=r.a;return C(e(n))}),ot=d(function(e,r){return V(function(n){return e+(": "+r(n))})}),X$=function(e){return e.az&&e.aV?C(2):e.aV?C(1):e.az?C(0):k},ed=function(e){return $([h(ot,"animation-delay",Cu,e.a9),h(ot,"animation-timing-function",Eu,e.bq),h(ot,"animation-iteration-count",Y$,e.aA),h(ot,"animation-direction",Z$,X$(e))])},rd=i(R,Q$,i(R,ed,je(Tr))),nd=function(e){return i(Pe,`;
`,i(Xr,$(["animation-name: "+Yt(e),"animation-duration: "+H$(e),"animation-fill-mode: both"]),rd(e)))},td=function(e){return"."+(Yt(e)+(`{
`+(nd(e)+`
};`)))},ad=function(e){return he(e)+"%"},id=je(Tr),od=function(e){return i(R,je(e),te)},sd=function(e){if(e.$)return k;var r=e.a;return C("opacity:"+he(r))},ud=function(e){if(e.$===2){var r=e.a,n=e.b;return C(r+(":"+n))}else return k},ld=i(ve,d(function(e,r){if(e.$===1){var n=e.a;return i(M,n,r)}else return r}),w),cd=d(function(e,r){switch(e.$){case 2:var n=e.a;return O(r,{bj:C(n)});case 1:var t=e.a,a=e.b;return O(r,{bk:C(l(t,a))});default:switch(e.a.$){case 2:var o=e.a,t=o.a,a=o.b;return O(r,{bv:C(l(t,a))});case 0:var n=e.a.a;return O(r,{bu:C(n)});default:var n=e.a.a;return O(r,{bw:C(n)})}}}),md={bj:k,bk:k,bu:k,bv:k,bw:k},Gn=d(function(e,r){return h(Hr,d(function(n,t){return e(n)?i(M,n,t):t}),w,r)}),ko=function(e){return i(R,V(e),x(""))},pd=function(e){return e?he(e)+"deg":"0"},fd=function(e){return lr($(["rotate3d(0,0,1,",pd(e),")"]))},$d=function(e){var r=e.a,n=e.b;return lr($(["scale3d(",he(r),",",he(n),",1)"]))},At=function(e){return e?he(e)+"px":"0"},yo=d(function(e,r){return lr($(["translate3d(",At(e),",",At(r),",0)"]))}),dd=function(e){return lr($(["translate3d(",At(e),",0,0)"]))},vd=function(e){return lr($(["translate3d(0,",At(e),",0)"]))},bd=function(e){var r=ye(e.bv,e.bu,e.bw);if(r.a.$)if(r.b.$){if(r.c.$)return r.a,r.b,r.c,"";r.a,r.b;var a=r.c.a;return vd(a)}else if(r.c.$===1){r.a;var t=r.b.a;return r.c,dd(t)}else{r.a;var t=r.b.a,a=r.c.a;return i(yo,t,a)}else{var n=r.a.a,t=n.a,a=n.b;return i(yo,t,a)}},hd=function(e){return i(Pe," ",i(Gn,i(R,ur,yu),$([bd(e),i(ko,$d,e.bk),i(ko,fd,e.bj)])))},gd=i(R,i(ve,cd,md),hd),_d=function(e){var r=ld(e);if(r.b){var n=r;return C("transform:"+gd(n))}else return k},wd=function(e){return i(Pe,";",id(qr($([i(Z,ud,e),$([i(od,sd,e),_d(e)])]))))},kd=function(e){var r=e.a,n=e.b;return ad(r)+("{"+(wd(n)+";}"))},yd=i(R,xu,i(R,Z(kd),Pe(`
`))),xd=function(e){return"@keyframes "+(Yt(e)+("{"+(yd(e)+"}")))},Ed=function(e){return xd(e)+(`
`+td(e))},jd=function(e){return h(Mu,"style",w,$([B(Ed(e))]))},Md=Ye(function(e,r,n,t,a){return i(r,i(M,e.aM(Yt(n)),t),i(M,jd(n),a))}),Cd=Md({aM:I}),Ad=Cd(T),Id=function(e){return{$:2,a:e}},Sd={$:3},Pd=Id(Sd),Od=d(function(e,r){return{$:0,a:e,b:r}}),qd=Od,Vd=A(function(e,r,n){return{$:0,a:e,b:r,c:n}}),st=d(function(e,r){return{$:0,a:e,b:r}}),Rd=Zt,Au=d(function(e,r){var n=Rd(e);return n-r>=1?n:r+1}),xo=function(e){var r=e.b;return r},Nd=d(function(e,r){switch(e.$){case 0:var n=e.a;return n+r;case 1:var n=e.a;return n+r;default:var t=e.a;return i(Au,t,r)}}),Iu=i(ve,Nd,0),Td=d(function(e,r){var n=100/Iu(r),t=d(function(u,c){var f=c.a,m=c.b,p=c.c;switch(u.$){case 0:var v=u.a,b=u.b;return ye(f+v,J(m,$([p])),i(st,n*(f+v),b));case 1:var v=u.a;return ye(f+v,J(m,$([p])),i(st,n*(f+v),xo(p)));default:var v=u.a,_=i(Au,v,f);return ye(_,J(m,$([p])),i(st,n*_,xo(p)))}}),a=h(ve,t,ye(0,w,i(st,0,e)),r),o=a.b,s=a.c;return J(o,$([s]))}),Dd=function(e){var r=e;return h(Vd,Iu(r.bn),r.cT,i(Td,r.bm,r.bn))},Bd=A(function(e,r,n){return Dd({cT:e.cT,bm:r,bn:$([i(qd,e.cp,n)])})}),Ld=function(e){return{$:0,a:e}},Eo=Ld,Fd=h(Bd,{cp:250,cT:$([Pd])},$([Eo(.5)]),$([Eo(1)])),Ud=Xm,Hd=Ud,Rn=function(e){return{$:5,a:e}},gr=d(function(e,r){return{$:6,a:e,b:r}}),Xt=d(function(e,r){return{$:4,a:e,b:r}}),Nn=d(function(e,r){return e<1?"":h(Ge,-e,W(r),r)}),It=Zc,Su=function(e){return i(Nn,2,e)==="  "?It(e)+"  ":It(e)},qa=d(function(e,r){return i(Xt,e+(`
`+Su(r)),w)}),Ci=d(function(e,r){e:for(;;)if(r.b){var n=r.a,t=r.b;if(e(n))return!0;var a=e,o=t;e=a,r=o;continue e}else return!1}),Pu=A(function(e,r,n){return e(r(n))}),zd=d(function(e,r){return!i(Ci,i(Pu,yu,e),r)}),Ou=de(function(e,r,n,t){return{cE:r,cM:e,d8:n,eq:t}}),Jd=Op,K=function(e){return i(Jd,{dA:!1,d4:!1},e)},G=Pp,Wd=i(x,G,K("^ {0,3}(?:>[ ]?)(.*)$")),Ai=i(x,G,K("^\\s*$")),dn=qp,Kd=function(e){var r=e.a,n=e.b,t=e.c,a=W(n),o=a>=4,s=o?J(n,t):t,u=o||i(dn,Ai,t)?r.y-a:r.y;return l(O(r,{y:u}),s)},Gd=i(x,G,K("^ {0,3}(#{1,6})(?:[ \\t]+[ \\t#]+$|[ \\t]+|$)(.*?)(?:\\s+[ \\t#]*)?$")),Ii=A(function(e,r,n){return{$:2,a:e,b:r,c:n}}),Qd=function(e){var r=e.eq;if(r.b&&!r.a.$&&r.b.b){var n=r.a.a,t=r.b,a=t.a;return C(h(Ii,i(x,"",a),W(n),w))}else return k},Ae=Us,Xe=d(function(e,r){if(r.$)return xe(e);var n=r.a;return fe(n)}),qu=function(e){var r=e.a,n=e.b;return i(Xe,l(r,n),i(V,function(t){return i(M,t,n)},i(me,Qd,te(h(Ae,1,Gd,r)))))},Vu=function(e){return{$:0,a:e}},br=d(function(e,r){return{$:3,a:e,b:r}}),St=d(function(e,r){return{$:1,a:e,b:r}}),Zd=d(function(e,r){if(r.b){var n=r.a,t=r.b;return i(M,i(Ru,n,e),t)}else return $([$([Vu(e.cM)])])}),Ru=d(function(e,r){e:for(;;)if(e.b)switch(e.a.$){case 3:if(e.a.a.$===1&&e.a.a.a){var n=e.a,t=n.a,a=t.b,o=n.b,f=e.b;return function(p){return i(M,p,f)}(i(br,i(St,!0,a),o+`
`))}else break e;case 6:var s=e.a,u=s.a,c=s.b,f=e.b;return i(M,i(gr,u,i(Zd,r,c)),f);default:break e}else break e;return i(M,Vu(r.cM),e)}),Nu=function(e){var r=e.a,n=e.b;return i(Xe,l(r,n),i(V,Ru(n),te(h(Ae,1,Ai,r))))},Yd=i(x,G,K("^(?: {4,4}| {0,3}\\t)(.*)$")),$t={$:0},Xd=d(function(e,r){e:for(;;)if(e.b&&!e.a.$){var n=e.a.a,t=e.b,a=t,o=i(M,n,r);e=a,r=o;continue e}else return l(e,r)}),Pt=d(function(e,r){e:for(;;)if(r.b)switch(r.a.$){case 4:var n=r.a,t=n.a,c=r.b;return C(i(M,i(qa,t,e),c));case 5:var a=r.a.a,c=r.b;return i(V,function(p){return i(M,Rn(p),c)},i(Pt,e,a));case 6:var o=r.a,s=o.a,u=o.b,c=r.b;if(u.b){var f=u.a,m=u.b;return i(V,i(R,function(p){return i(M,p,m)},i(R,gr(s),function(p){return i(M,p,c)})),i(Pt,e,f))}else return k;default:break e}else break e;return k}),cr=Hs(zs),ev=Hs,Tu=i(x,G,K("\\t")),Ot=function(e){return i(R,i(cr,Tu,function(r){return"    "}),h(ev,1,i(x,G,K("^ {0,"+(Oe(e)+"}"))),function(r){return""}))},rv=d(function(e,r){var n=r.a,t=r.b;if(n.b&&n.a.$===3&&!n.a.a.$){var a=n.a;a.a;var o=a.b,s=n.b;return C(function(u){return i(M,u,s)}(i(br,$t,function(u){return u+(e+`
`)}(J(o,lr(i(Z,function(u){return i(Ot,4,u)+`
`},t)))))))}else return k}),nv=d(function(e,r){e:for(;;)if(e.b)switch(e.a.$){case 3:if(e.a.a.$)break e;var n=e.a;n.a;var t=n.b,o=e.b;return function(u){return i(M,u,o)}(i(br,$t,t+(r+`
`)));case 0:var a=e.a.a,o=e.b;return i(x,function(s){return i(M,s,e)}(i(br,$t,r+`
`)),i(rv,r,i(Xd,o,$([a]))));default:break e}else break e;return i(x,function(s){return i(M,s,e)}(i(br,$t,r+`
`)),i(Pt,r,e))}),Du=function(e){var r=e.a,n=e.b;return i(Xe,l(r,n),i(V,nv(n),i(x,k,i(x,k,i(V,i(R,function(t){return t.eq},te),te(h(Ae,1,Yd,r)))))))},tv=i(x,G,K("&#([0-9]{1,8});")),Va=Fc,tn=function(e){return i(Va,e,"")},qt=lm,Tn=Vc,av=function(e){var r=i(Tn,16,e),n=i(Tn,131070,e);return e>=131070&&(0<=n&&n<=15||65536<=n&&n<=65551)&&(r===14||r===15)},iv=function(e){return e===9||e===10||e===13||e===133||32<=e&&e<=126||160<=e&&e<=55295||57344<=e&&e<=64975||65008<=e&&e<=65533||65536<=e&&e<=1114109},Bu=function(e){return iv(e)&&!av(e)?tn(qt(e)):tn(qt(65533))},ov=function(e){return i(x,e.cM,i(V,Bu,i(me,Jt,i(x,k,te(e.eq)))))},sv=i(cr,tv,ov),uv=i(x,G,K("&([0-9a-zA-Z]+);")),lv=$u($([l("quot",34),l("amp",38),l("apos",39),l("lt",60),l("gt",62),l("nbsp",160),l("iexcl",161),l("cent",162),l("pound",163),l("curren",164),l("yen",165),l("brvbar",166),l("sect",167),l("uml",168),l("copy",169),l("ordf",170),l("laquo",171),l("not",172),l("shy",173),l("reg",174),l("macr",175),l("deg",176),l("plusmn",177),l("sup2",178),l("sup3",179),l("acute",180),l("micro",181),l("para",182),l("middot",183),l("cedil",184),l("sup1",185),l("ordm",186),l("raquo",187),l("frac14",188),l("frac12",189),l("frac34",190),l("iquest",191),l("Agrave",192),l("Aacute",193),l("Acirc",194),l("Atilde",195),l("Auml",196),l("Aring",197),l("AElig",198),l("Ccedil",199),l("Egrave",200),l("Eacute",201),l("Ecirc",202),l("Euml",203),l("Igrave",204),l("Iacute",205),l("Icirc",206),l("Iuml",207),l("ETH",208),l("Ntilde",209),l("Ograve",210),l("Oacute",211),l("Ocirc",212),l("Otilde",213),l("Ouml",214),l("times",215),l("Oslash",216),l("Ugrave",217),l("Uacute",218),l("Ucirc",219),l("Uuml",220),l("Yacute",221),l("THORN",222),l("szlig",223),l("agrave",224),l("aacute",225),l("acirc",226),l("atilde",227),l("auml",228),l("aring",229),l("aelig",230),l("ccedil",231),l("egrave",232),l("eacute",233),l("ecirc",234),l("euml",235),l("igrave",236),l("iacute",237),l("icirc",238),l("iuml",239),l("eth",240),l("ntilde",241),l("ograve",242),l("oacute",243),l("ocirc",244),l("otilde",245),l("ouml",246),l("divide",247),l("oslash",248),l("ugrave",249),l("uacute",250),l("ucirc",251),l("uuml",252),l("yacute",253),l("thorn",254),l("yuml",255),l("OElig",338),l("oelig",339),l("Scaron",352),l("scaron",353),l("Yuml",376),l("fnof",402),l("circ",710),l("tilde",732),l("Alpha",913),l("Beta",914),l("Gamma",915),l("Delta",916),l("Epsilon",917),l("Zeta",918),l("Eta",919),l("Theta",920),l("Iota",921),l("Kappa",922),l("Lambda",923),l("Mu",924),l("Nu",925),l("Xi",926),l("Omicron",927),l("Pi",928),l("Rho",929),l("Sigma",931),l("Tau",932),l("Upsilon",933),l("Phi",934),l("Chi",935),l("Psi",936),l("Omega",937),l("alpha",945),l("beta",946),l("gamma",947),l("delta",948),l("epsilon",949),l("zeta",950),l("eta",951),l("theta",952),l("iota",953),l("kappa",954),l("lambda",955),l("mu",956),l("nu",957),l("xi",958),l("omicron",959),l("pi",960),l("rho",961),l("sigmaf",962),l("sigma",963),l("tau",964),l("upsilon",965),l("phi",966),l("chi",967),l("psi",968),l("omega",969),l("thetasym",977),l("upsih",978),l("piv",982),l("ensp",8194),l("emsp",8195),l("thinsp",8201),l("zwnj",8204),l("zwj",8205),l("lrm",8206),l("rlm",8207),l("ndash",8211),l("mdash",8212),l("lsquo",8216),l("rsquo",8217),l("sbquo",8218),l("ldquo",8220),l("rdquo",8221),l("bdquo",8222),l("dagger",8224),l("Dagger",8225),l("bull",8226),l("hellip",8230),l("permil",8240),l("prime",8242),l("Prime",8243),l("lsaquo",8249),l("rsaquo",8250),l("oline",8254),l("frasl",8260),l("euro",8364),l("image",8465),l("weierp",8472),l("real",8476),l("trade",8482),l("alefsym",8501),l("larr",8592),l("uarr",8593),l("rarr",8594),l("darr",8595),l("harr",8596),l("crarr",8629),l("lArr",8656),l("uArr",8657),l("rArr",8658),l("dArr",8659),l("hArr",8660),l("forall",8704),l("part",8706),l("exist",8707),l("empty",8709),l("nabla",8711),l("isin",8712),l("notin",8713),l("ni",8715),l("prod",8719),l("sum",8721),l("minus",8722),l("lowast",8727),l("radic",8730),l("prop",8733),l("infin",8734),l("ang",8736),l("and",8743),l("or",8744),l("cap",8745),l("cup",8746),l("int",8747),l("there4",8756),l("sim",8764),l("cong",8773),l("asymp",8776),l("ne",8800),l("equiv",8801),l("le",8804),l("ge",8805),l("sub",8834),l("sup",8835),l("nsub",8836),l("sube",8838),l("supe",8839),l("oplus",8853),l("otimes",8855),l("perp",8869),l("sdot",8901),l("lceil",8968),l("rceil",8969),l("lfloor",8970),l("rfloor",8971),l("lang",9001),l("rang",9002),l("loz",9674),l("spades",9824),l("clubs",9827),l("hearts",9829),l("diams",9830)])),cv=function(e){return i(x,e.cM,i(V,i(R,qt,tn),i(me,function(r){return i(Ee,r,lv)},i(x,k,te(e.eq)))))},mv=i(cr,uv,cv),pv=i(x,G,K("(\\\\+)([!\"#$%&\\'()*+,./:;<=>?@[\\\\\\]^_`{|}~-])")),Lu=A(function(e,r,n){return e<=0?n:h(Lu,e>>1,J(r,r),e&1?J(n,r):n)}),an=d(function(e,r){return h(Lu,e,r,"")}),fv=i(cr,pv,function(e){var r=e.eq;if(r.b&&!r.a.$&&r.b.b&&!r.b.a.$){var n=r.a.a,t=r.b,a=t.a.a;return J(i(an,W(n)/2|0,"\\"),a)}else return e.cM}),$v=i(x,G,K("&#[Xx]([0-9a-fA-F]{1,8});")),dv=Wc,Fu=function(e){return h(dv,M,w,e)},Uu=rm,vv=i(R,Uu,i(R,Fu,i(ve,d(function(e,r){return r*16+i(Tn,39,pn(e))-9}),0))),bv=function(e){return i(x,e.cM,i(V,i(R,vv,Bu),i(x,k,te(e.eq))))},hv=i(cr,$v,bv),Vt=function(e){return hv(sv(mv(fv(e))))},gv=Yc,_v=function(e){var r=e.eq;if(r.b&&r.b.b&&!r.b.a.$&&r.b.b.b){var n=r.a,t=r.b,a=t.a.a,o=t.b,s=o.a;return C(i(St,!0,{bB:i(Ur,1,a),bC:W(a),y:i(x,0,i(V,W,n)),bL:i(V,Vt,i(me,function(u){return u===""?k:C(u)},te(i(x,w,i(V,gv,s)))))}))}else return k},wv=i(x,G,K("^( {0,3})(`{3,}(?!.*`)|~{3,}(?!.*~))(.*)$")),Hu=function(e){var r=e.a,n=e.b;return i(Xe,l(r,n),i(V,function(t){return i(M,t,n)},i(V,function(t){return i(br,t,"")},i(me,_v,te(h(Ae,1,wv,r))))))},kv=function(e){return{$:1,a:e}},zu={$:0},yv=function(e){var r=e.eq;if(r.b&&!r.a.$&&r.b.b&&!r.b.a.$&&r.b.b.b&&!r.b.b.a.$&&r.b.b.b.b&&r.b.b.b.b.b){var n=r.a.a,t=r.b,a=t.a.a,o=t.b,s=o.a.a,u=o.b,c=u.a,f=u.b,m=f.a;return C(ye({aN:s,y:W(n)+1,af:!1,a_:i(x,zu,i(V,kv,Jt(a)))},i(x,"",c),i(x,"",m)))}else return k},xv=i(x,G,K("^( *(\\d{1,9})([.)])( {0,4}))(?:[ \\t](.*))?$")),Ev=function(e){return i(Xe,e,i(me,yv,te(h(Ae,1,xv,e))))},jv=function(e){var r=e.eq;if(r.b&&!r.a.$){var n=r.a.a;return i(cu,"=",n)?C(l(1,n)):C(l(2,n))}else return k},Mv=A(function(e,r,n){var t=n.a;if(n.b,r.b&&r.a.$===4){var a=r.a,o=a.a,s=r.b;return C(i(M,h(Ii,o,t,w),s))}else return k}),Cv=i(x,G,K("^ {0,3}(=+|-+)[ \\t]*$")),Ju=function(e){var r=e.a,n=e.b;return i(Xe,l(r,n),i(me,i(Mv,r,n),i(me,jv,te(h(Ae,1,Cv,r)))))},Av={$:1},Iv=i(x,G,K("^ {0,3}(?:(?:\\*[ \\t]*){3,}|(?:_[ \\t]*){3,}|(?:-[ \\t]*){3,})[ \\t]*$")),Wu=function(e){var r=e.a,n=e.b;return i(Xe,l(r,n),i(V,function(t){return i(M,Av,n)},te(h(Ae,1,Iv,r))))},Sv=function(e){var r=e.eq;if(r.b&&!r.a.$&&r.b.b&&!r.b.a.$&&r.b.b.b&&r.b.b.b.b&&!r.b.b.b.b.b){var n=r.a.a,t=r.b,a=t.a.a,o=t.b,s=o.a,u=o.b,c=u.a;return C(ye({aN:a,y:W(n)+1,af:!1,a_:zu},i(x,"",s),i(x,"",c)))}else return k},Pv=i(x,G,K("^( *([\\*\\-\\+])( {0,4}))(?:[ \\t](.*))?$")),Ov=function(e){return i(Xe,e,i(me,Sv,te(h(Ae,1,Pv,e))))},qv=i(x,G,K("^ {0,3}(`{3,}|~{3,})\\s*$")),Vv=d(function(e,r){var n=r.eq;if(n.b&&!n.a.$){var t=n.a.a;return oe(W(t),e.bC)>-1&&re(i(Ur,1,t),e.bB)}else return!1}),Rv=function(e){return i(R,i(Ae,1,qv),i(R,te,i(R,V(Vv(e)),x(!1))))},Nv=A(function(e,r,n){return i(Rv,e,n)?i(br,i(St,!1,e),r):i(br,i(St,!0,e),r+(i(Ot,e.y,n)+`
`))}),pe=d(function(e,r){if(r.$){var n=r.a;return e(n)}else return r}),Tv=i(x,G,K("^ +")),Ku=i(R,i(cr,Tu,function(e){return"    "}),i(R,i(Ae,1,Tv),i(R,te,i(R,V(i(R,function(e){return e.cM},W)),x(0))))),Gu=function(e){e:for(;;)if(e.b){var r=e.a;e.b;r:for(;;)if(r.b)switch(r.a.$){case 0:return!!r.b.b;case 6:var n=r.a,t=n.b,a=t;e=a;continue e;default:break r}else break r;return!1}else return!1},rn=d(function(e,r){if(r.$){var t=r.a;return xe(t)}else{var n=r.a;return fe(e(n))}}),Ra=d(function(e,r){if(r.$){var t=r.a;return xe(e(t))}else{var n=r.a;return fe(n)}}),Qu=d(function(e,r){return i(x,i(M,i(Xt,Su(e),w),r),i(Pt,e,r))}),Zu=d(function(e,r){if(r.$)return e;var n=r.a;return n}),Yu=function(e){var r=e.a,n=e.b;return i(Xe,l(r,n),i(V,Dv(n),i(V,i(R,function(t){return t.eq},i(R,te,i(R,x(k),x("")))),te(h(Ae,1,Wd,r)))))},Xu=function(e){var r=e.a,n=e.b;return i(Ra,function(t){return l(t,n)},i(rn,i(Lv,r,n),i(rn,Kd,i(pe,Ov,Ev(r)))))},on=d(function(e,r){e:for(;;)if(r.b)switch(r.a.$){case 3:if(r.a.a.$===1&&r.a.a.a){var n=r.a,t=n.a,a=t.b,o=n.b,f=r.b;return function(p){return i(M,p,f)}(h(Nv,a,o,e))}else break e;case 6:var s=r.a,u=s.a,c=s.b,f=r.b;return oe(Ku(e),u.y)>-1?le(Bv,e,u,c,r,f):i(Zu,i(Qu,e,r),i(pe,Yu,i(pe,qu,i(pe,Ju,i(pe,Hu,i(pe,Du,i(pe,Nu,i(pe,Xu,Wu(l(e,r))))))))));default:break e}else break e;return i(el,e,r)}),Dv=d(function(e,r){if(e.b&&e.a.$===5){var n=e.a.a,t=e.b;return function(a){return i(M,a,t)}(Rn(i(on,r,n)))}else return function(a){return i(M,a,e)}(Rn(i(on,r,w)))}),Bv=Ye(function(e,r,n,t,a){if(n.b){var o=n.a,s=n.b,u=i(Ot,r.y,e),c=function(v){return function(_){return i(M,_,a)}(i(gr,v,function(_){return i(M,_,s)}(i(on,u,o))))};e:for(;;)if(o.b)switch(o.a.$){case 0:if(o.b.b){var b=o.b;return i(zd,function(_){return!_.$},b)?i(el,e,t):c(O(r,{af:!0}))}else return c(r);case 6:var f=o.a,m=f.a,p=f.b,b=o.b;return oe(Ku(u),m.y)>-1?c(r):Gu(p)?c(O(r,{af:!0})):c(r);default:break e}else break e;return c(r)}else return function(v){return i(M,v,a)}(i(gr,r,function(v){return i(M,v,w)}(function(v){return i(on,v,w)}(i(Ot,r.y,e)))))}),Lv=A(function(e,r,n){var t=n.a,a=n.b,o=i(on,a,w),s=i(M,i(gr,t,$([o])),r);e:for(;;)if(r.b)switch(r.a.$){case 6:var u=r.a,c=u.a,f=u.b,b=r.b;return re(t.aN,c.aN)?function(_){return i(M,_,b)}(i(gr,O(c,{y:t.y,af:c.af||Gu(f)}),i(M,o,f))):s;case 4:var m=r.a,p=m.a;m.b;var b=r.b;if(o.b&&!o.a.$&&!o.b.b)return i(M,i(qa,p,e),b);var v=t.a_;return v.$===1?v.a===1?s:(v.a,i(M,i(qa,p,e),b)):s;default:break e}else break e;return s}),el=d(function(e,r){return i(Zu,i(Qu,e,r),i(pe,Xu,i(pe,Wu,i(pe,Yu,i(pe,qu,i(pe,Ju,i(pe,Hu,i(pe,Du,Nu(l(e,r))))))))))}),rl=d(function(e,r){if(e.b){var n=e.a,t=e.b;return i(rl,t,i(on,n,r))}else return r}),Fv=Xc,nl=d(function(e,r){return{$:8,a:e,b:r}}),jo=function(e){return{$:7,a:e}},Uv=function(e){return{$:1,a:e}},Hv=$(["name","class"]),zv=$(["address","article","aside","b","blockquote","br","caption","center","cite","code","col","colgroup","dd","details","div","dl","dt","figcaption","figure","footer","h1","h2","h3","h4","h5","h6","hr","i","legend","li","menu","menuitem","nav","ol","optgroup","option","p","pre","section","strike","summary","small","table","tbody","td","tfoot","th","thead","tr","ul"]),Jv={cf:Hv,cg:zv},Wv={c3:Uv(Jv),db:!1},Kv=A(function(e,r,n){return{d:w,cT:e,G:n,bY:r,i:w}}),Gv=function(e){return{$:2,a:e}},tl=d(function(e,r){return{$:6,a:e,b:r}}),Qv={$:1},Zv=A(function(e,r,n){return{$:5,a:e,b:r,c:n}}),Yv=A(function(e,r,n){return{$:4,a:e,b:r,c:n}}),Mo=A(function(e,r,n){return{$:3,a:e,b:r,c:n}}),Co=function(e){return{$:0,a:e}},Xv=function(e){var r=e,n=r.a_;switch(n.$){case 0:return Co(r.df);case 1:return Qv;case 2:return Gv(r.df);case 3:var t=n.a,a=t.a,u=t.b;return h(Mo,u,k,$([Co(a)]));case 4:var o=n.a,u=o.a,c=o.b;return h(Mo,u,c,jn(r.d));case 5:var s=n.a,u=s.a,c=s.b;return h(Yv,u,c,jn(r.d));case 6:var f=n.a;return h(Zv,f.aX,f.ch,jn(r.d));default:var m=n.a;return i(tl,m,jn(r.d))}},jn=function(e){return i(Z,Xv,e)},al=d(function(e,r){return O(r,{cq:r.cq-e.Y,b7:r.b7-e.Y,aG:r.aG-e.Y,Y:r.Y-e.Y})}),eb=d(function(e,r){return O(e,{d:i(M,i(al,e,r),e.d)})}),rb=d(function(e,r){var n=e;if(r.b){var t=r.a,a=r.b;return oe(t.cq,n.b7)<1?i(M,n,r):oe(t.b7,n.b7)<0&&oe(t.cq,n.cq)>0?i(M,i(eb,t,n),a):r}else return $([n])});function Si(){return i(R,Kn(function(e){var r=e;return r.b7}),i(R,i(ve,rb,w),Z(function(e){var r=e;return O(r,{d:Si()(r.d)})})))}var il=Si();Si=function(){return il};var nb=function(e){return O(e,{d:il(e.d)})},ol={$:0},Rt=function(e){return{cq:0,d:w,b7:0,df:Vt(e),aG:0,Y:0,a_:ol}},tb=A(function(e,r,n){var t=r,a=O(t,{d:h(sl,t.df,w,t.d)});if(n.b){var s=n.a;return n.b,re(s.a_,ol)||re(t.cq,s.b7)?i(M,a,n):oe(t.cq,s.b7)<0?i(M,a,i(M,Rt(h(Ge,t.cq,s.b7,e)),n)):n}else{var o=i(xr,t.cq,e);return ur(o)?$([a]):$([a,Rt(o)])}}),sl=A(function(e,r,n){e:for(;;)if(n.b){var a=n.a,o=n.b,s=e,u=h(tb,e,a,r),c=o;e=s,r=u,n=c;continue e}else if(r.b){var t=r.a;return t.b7>0?i(M,Rt(i(Ur,t.b7,e)),r):r}else return ur(e)?w:$([Rt(e)])}),ab=function(e){return O(e,{d:h(sl,e.G,w,e.d)})},ib=i(x,G,K("(\\\\*)(\\<)")),nr=Us(zs),Nt=function(e){return{$:3,a:e}},Er=function(e){return!i(Tn,2,e)},ob=function(e){var r=e.eq;if(r.b&&r.b.b&&!r.b.a.$){var n=r.a,t=r.b;t.a.a;var a=i(x,0,i(V,W,n));return Er(a)?C({cE:e.cE+a,e:1,g:Nt("<")}):k}else return k},sb=function(e){return i(je,ob,i(nr,ib,e))},ub=i(x,G,K("(\\\\*)(\\>)")),lb=function(e){return{$:4,a:e}},cb=function(e){var r=e.eq;if(r.b&&r.b.b&&!r.b.a.$){var n=r.a;r.b;var t=i(x,0,i(V,W,n));return C({cE:e.cE+t,e:1,g:lb(!Er(t))})}else return k},mb=function(e){return i(je,cb,i(nr,ub,e))},pb=i(x,G,K("(\\\\*)([^*])?(\\*+)([^*])?")),fb=d(function(e,r){return{$:6,a:e,b:r}}),$b=i(x,G,K("[!-#%-\\*,-/:;\\?@\\[-\\]_\\{\\}]")),db=dn($b),vb=i(x,G,K("\\s")),bb=dn(vb),hb=function(e){var r=tn(e);return bb(r)?0:db(r)?1:2},gb=function(e){return i(x,0,i(V,hb,e))},Ao=i(R,V(i(R,fn,i(R,V(hi),gb))),x(0)),_b=Ic,ul=A(function(e,r,n){var t=n.eq;if(t.b&&t.b.b&&t.b.b.b&&!t.b.b.a.$&&t.b.b.b.b){var a=t.a,o=t.b,s=o.a,u=o.b,c=u.a.a,f=u.b,m=f.a,p=i(x,0,i(V,W,s)),b=n.cE&&!p?C(h(Ge,n.cE-1,n.cE,r)):s,v=i(x,0,i(V,W,a)),_=!Er(v)&&!p||re(b,C("\\")),y=_?W(c)-1:W(c),E=l(_?1:Ao(b),Ao(m)),S=n.cE+v+p+(_?1:0);return y<=0||e==="_"&&re(E,l(2,2))?k:C({cE:S,e:y,g:i(fb,e,E)})}else return k}),wb=function(e){return i(je,i(ul,"*",e),i(nr,pb,e))},kb=i(x,G,K("(\\\\*)(\\`+)")),ll=function(e){return{$:0,a:e}},yb=function(e){var r=e.eq;if(r.b&&r.b.b&&!r.b.a.$){var n=r.a,t=r.b,a=t.a.a,o=i(x,0,i(V,W,n));return C({cE:e.cE+o,e:W(a),g:ll(!Er(o))})}else return k},xb=function(e){return i(je,yb,i(nr,kb,e))},Eb=i(x,G,K("(?:(\\\\+)|( {2,}))\\n")),nn={$:8},jb=function(e){var r=e.eq;e:for(;;)if(r.b)if(r.a.$){if(r.b.b&&!r.b.a.$)return r.b,C({cE:e.cE,e:W(e.cM),g:nn});break e}else{var n=r.a.a,t=W(n);return Er(t)?k:C({cE:e.cE+t-1,e:2,g:nn})}else break e;return k},Mb=function(e){var r=e.eq;e:for(;;)if(r.b)if(r.a.$)if(r.b.b){var a=r.b;return a.a,C({cE:e.cE,e:W(e.cM),g:nn})}else break e;else{var n=r.a.a,t=W(n);return Er(t)?C({cE:e.cE+t,e:1,g:nn}):C({cE:e.cE+t-1,e:2,g:nn})}else break e;return k},Cb=i(x,G,K("(?:(\\\\+)|( *))\\n")),Ab=d(function(e,r){return e?i(je,Mb,i(nr,Cb,r)):i(je,jb,i(nr,Eb,r))}),Ib=i(x,G,K("(\\\\*)(\\])")),Sb=function(e){var r=e.eq;if(r.b&&r.b.b&&!r.b.a.$){var n=r.a,t=r.b;t.a.a;var a=i(x,0,i(V,W,n));return Er(a)?C({cE:e.cE+a,e:1,g:Nt("]")}):k}else return k},Pb=function(e){return i(je,Sb,i(nr,Ib,e))},Ob=i(x,G,K("(\\\\*)(\\!)?(\\[)")),Io={$:2},Na=function(e){return{$:1,a:e}},qb=function(e){var r=e.eq;if(r.b&&r.b.b&&r.b.b.b&&!r.b.b.a.$){var n=r.a,t=r.b,a=t.a,o=t.b;o.a.a;var s=i(x,0,i(V,W,n)),u=!Er(s),c=e.cE+s+(u&&re(a,C("!"))?1:0),f=u?i(V,function(b){return Na(!0)},a):C(i(x,Na(!0),i(V,function(b){return Io},a))),m=re(f,C(Io))?2:1,p=function(b){return{cE:c,e:m,g:b}};return i(V,p,f)}else return k},Vb=function(e){return i(je,qb,i(nr,Ob,e))},Rb=i(x,G,K("(\\\\*)([^_])?(\\_+)([^_])?")),Nb=function(e){return i(je,i(ul,"_",e),i(nr,Rb,e))},Tb=function(e){return O(e,{i:i(Kn,function(r){return r.cE},J(mb(e.G),J(sb(e.G),J(i(Ab,e.cT.db,e.G),J(Pb(e.G),J(Vb(e.G),J(Nb(e.G),J(wb(e.G),xb(e.G)))))))))})},cl={$:2},Db=function(e){return{$:7,a:e}},Ta=function(e){return{$:6,a:e}},Pi=function(e){return{$:5,a:e}},Oi=function(e){return{$:4,a:e}},Tt=d(function(e,r){return O(e,{d:i(M,r,e.d)})}),or=d(function(e,r){return O(e,{i:i(M,r,e.i)})}),So=d(function(e,r){if(r.$){var t=r.a;return xe(t)}else{var n=r.a;return e(n)}}),gn=d(function(e,r){return e(l(r.i,O(r,{i:w})))}),ml=function(e){return{$:3,a:e}},Bb=i(x,G,K("%(?:3B|2C|2F|3F|3A|40|26|3D|2B|24|23|25)")),Lb=Rp,Fb=Vp,qi=i(R,Fb,i(cr,Bb,function(e){return i(x,e.cM,Lb(e.cM))})),Ub=i(x,G,K("^([A-Za-z][A-Za-z0-9.+\\-]{1,31}:[^<>\\x00-\\x20]*)$")),Hb=function(e){var r=e;return i(dn,Ub,r.df)?fe(O(r,{a_:ml(l(r.df,qi(r.df)))})):xe(r)},Pn=" \\t\\f\\v\\r\\n",zb="(?:<([^<>"+(Pn+("]*)>|([^"+(Pn+("\\(\\)\\\\]*(?:\\\\.[^"+(Pn+"\\(\\)\\\\]*)*))"))))),pl="(?:["+(Pn+`]+(?:'([^'\\\\]*(?:\\\\.[^'\\\\]*)*)'|"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"|\\(([^\\)\\\\]*(?:\\\\.[^\\)\\\\]*)*)\\)))?`),Jb=i(x,G,K("^\\(\\s*"+(zb+(pl+"\\s*\\)")))),fl=function(e){var r=e.a,n=e.b;return l(qi(Vt(r)),i(V,Vt,n))},Dn=function(e){var r=d(function(n,t){if(t.$)return n;var a=t.a;return C(a)});return h(ve,r,k,e)},Wb=A(function(e,r,n){var t=n.eq;if(t.b&&t.b.b&&t.b.b.b&&t.b.b.b.b&&t.b.b.b.b.b){var a=t.a,o=t.b,s=o.a,u=o.b,c=u.a,f=u.b,m=f.a,p=f.b,b=p.a,v=Dn($([c,m,b])),_=function(E){return O(e,{cq:e.cq+W(n.cM),a_:function(){var S=e.a_;return S.$===5?Pi:Oi}()(fl(l(E,v)))})},y=Dn($([a,s]));return C(_(i(x,"",y)))}else return k}),Po=function(e){var r=e.a,n=e.b,t=e.c;return i(Xe,ye(r,n,t),i(V,Tt(t),i(me,i(Wb,n,t),te(h(Ae,1,Jb,r)))))},$l="[^\\[\\]\\\\]*(?:\\\\.[^\\[\\]\\\\]*)*",Kb=i(x,G,K("^\\[\\s*("+($l+")\\s*\\]"))),Gb=i(x,G,K("["+(Pn+"]+"))),dl=i(R,It,i(cr,Gb,function(e){return" "})),vl=i(R,dl,Uu),Qb=A(function(e,r,n){var t=i(x,0,i(V,i(R,function(u){return u.cM},W),n)),a=function(u){return O(e,{cq:e.cq+t,a_:function(){var c=e.a_;return c.$===5?Pi:Oi}()(fl(u))})},o=function(u){return ur(u)?e.df:u}(i(x,e.df,i(x,k,i(x,k,i(V,i(R,function(u){return u.eq},te),n))))),s=i(Ee,vl(o),r.bY);return i(V,a,s)}),Oo=function(e){var r=e.a,n=e.b,t=e.c;return i(Xe,ye(r,n,t),i(V,Tt(t),h(Qb,n,t,te(h(Ae,1,Kb,r)))))},qo=function(e){return!e.b},Vo=function(e){var r=e.d;if(r.b){var n=r.a,t=r.b,a=i(Gn,function(o){var s=o;return oe(n.cq,s.b7)>0&&oe(n.cq,s.cq)<0},t);return qo(t)||qo(a)?fe(e):xe(0)}else return xe(0)},Zb=i(x,G,K("^([a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~\\-]+@[a-zA-Z0-9](?:[a-zA-Z0-9\\-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9\\-]{0,61}[a-zA-Z0-9])?)*)$")),Yb=function(e){var r=e;return i(dn,Zb,r.df)?fe(O(r,{a_:ml(l(r.df,"mailto:"+qi(r.df)))})):xe(r)},Xb=d(function(e,r){return O(r,{i:i(Gn,e,r.i)})}),sn=d(function(e,r){var n=d(function(a,o){var s=o.a,u=o.b,c=o.c;return s.$===1?e(a)?ye(C(a),u,w):ye(k,i(M,a,u),w):ye(s,u,i(M,a,c))}),t=function(a){var o=a.a,s=a.b,u=a.c;return i(V,function(c){return ye(c,we(s),we(u))},o)};return t(h(ve,n,ye(k,w,w),r))}),eh=d(function(e,r){return{ch:r,aX:e}}),rh=d(function(e,r){return{$:5,a:e,b:r}}),nh=function(e){var r=e.eq;e:for(;;)if(r.b&&!r.a.$){if(r.a.a==="")return k;if(r.b.b&&r.b.b.b&&r.b.b.b.b){var n=r.a.a,t=r.b,a=t.a,o=t.b,s=o.a,u=o.b,c=u.a,f=Dn($([a,s,c]));return C(l(n,f))}else break e}else break e;return k},th=i(x,G,K(`([a-zA-Z:_][a-zA-Z0-9\\-_.:]*)(?: ?= ?(?:"([^"]*)"|'([^']*)'|([^\\s"'=<>\`]*)))?`)),ah=i(R,nr(th),je(nh)),Da=d(function(e,r){return i(Ci,function(n){return re(n,e)},r)}),ih=A(function(e,r,n){var t=n.eq;if(t.b&&t.b.b&&!t.b.a.$&&t.b.b.b&&t.b.b.b.b){var a=t.a,o=t.b,s=o.a.a,u=o.b,c=u.a,f=u.b,m=f.a,p=function(P){return i(or,e,{cE:r.b7,e:r.cq-r.b7,g:i(rh,re(a,k)&&re(m,k),i(eh,s,P))})},b=d(function(P,H){return i(Gn,function(ne){return i(Da,ne.a,H)},P)}),v=i(x,w,i(V,ah,c)),_=re(a,k)||!re(a,k)&&re(v,w),y=e.cT.c3;switch(y.$){case 0:return _?C(p(v)):k;case 1:var E=y.a.cg,S=y.a.cf;return i(Da,s,E)&&_?C(p(i(b,v,S))):k;default:return k}}else return k}),oh=i(x,G,K("^(\\/)?([a-zA-Z][a-zA-Z0-9\\-]*)(?:\\s+([^<>]*?))?(\\/)?$")),sh=d(function(e,r){var n=r,t=e.cT.c3;return t.$===2?k:i(me,i(ih,e,n),te(h(Ae,1,oh,n.df)))}),uh=d(function(e,r){var n=r.g;if(n.$===5&&!n.a){var t=n.b;return re(e.aX,t.aX)}else return!1}),lh=d(function(e,r){var n=r.g;if(n.$)return!1;var t=n.a;return re(t?r.e-1:r.e,e.e)}),ch=function(e){var r=e.g;switch(r.$){case 1:return!0;case 2:return!0;default:return!1}},Ro=d(function(e,r){var n=r.g;if(n.$===6){var t=n.a,a=n.b,o=a.a,s=a.b,u=e.g;if(u.$===6){var c=u.a,f=u.b,m=f.a,p=f.b;return re(t,c)?re(o,s)||re(m,p)?!!i(Tn,3,e.e+r.e):!0:!1}else return!1}else return!1}),mh=$(["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]),ph=function(e){return i(Da,e.aX,mh)},fh={$:1},$h={$:7},Qn=function(e){return O(e,{i:we(e.i)})},Ba=d(function(e,r){return{cq:e.cE+e.e,d:w,b7:e.cE,df:"",aG:0,Y:0,a_:r}}),bl=function(e){e:for(;;){var r=e.a,n=e.b;if(r.b){var t=r.a,a=r.b;if(re(t.g,nn)||re(t.g,$h)&&n.cT.db)return bl(function(s){return l(a,s)}(O(n,{d:i(M,i(Ba,t,fh),n.d)})));var o=l(a,i(or,n,t));e=o;continue e}else return Qn(n)}},No=d(function(e,r){var n=r.d;if(n.b){var t=n.a;return l(i(Gn,function(a){return oe(a.cE,t.cq)>-1},e),r)}else return l(e,r)}),Dt=function(e){if(e.$)return k;var r=e.a;return C(r)},dh=de(function(e,r,n,t){var a=t.a,o=t.c;return function(s){if(s.$===1){var u=s.a;return r?Dt(s):i(sh,O(n,{i:o}),u)}else return Dt(s)}(i(rn,function(s){return O(n,{d:i(M,s,n.d),i:o})},i(pe,Yb,Hb(hr(Zn,n,function(s){return s},cl,a,e,w)))))}),La=function(e){e:for(;;){var r=e.a,n=e.b;if(r.b){var t=r.a,a=r.b,o=t.g;switch(o.$){case 0:var s=o.a;return La(function(c){return l(a,c)}(i(x,i(or,n,t),i(V,i(vh,t,n),i(sn,lh(t),n.i)))));case 4:var s=o.a;return La(function(c){return l(a,c)}(i(Xb,i(R,function(c){return c.g},_b(Nt("<"))),i(x,n,i(me,h(dh,t,s,n),i(sn,i(R,function(c){return c.g},Gp(Nt("<"))),n.i))))));default:var u=l(a,i(or,n,t));e=u;continue e}}else return Qn(n)}},vh=A(function(e,r,n){var t=n.a,a=n.c,o=re(t.g,ll(!0))?O(t,{cE:t.cE+1,e:t.e-1}):t;return O(r,{d:i(M,hr(Zn,r,dl,cl,o,e,w),r.d),i:a})}),Fa=function(e){e:for(;;){var r=e.a,n=e.b;if(r.b){var t=r.a,a=r.b,o=t.g;if(o.$===6){var s=o.a,u=o.b,c=u.a,f=u.b;if(re(c,f)){if(f&&(s!=="_"||f===1))return Fa(i(x,l(a,i(or,n,t)),i(V,h(To,t,a,n),i(sn,Ro(t),n.i))));var m=l(a,n);e=m;continue e}else if(oe(c,f)<0){var m=l(a,i(or,n,t));e=m;continue e}else return Fa(i(x,l(a,n),i(V,h(To,t,a,n),i(sn,Ro(t),n.i))))}else{var m=l(a,i(or,n,t));e=m;continue e}}else return Qn(n)}},To=de(function(e,r,n,t){var a=t.a,o=t.b,s=t.c,u=a.e-e.e,c=u?u>0?{a6:e,aQ:O(a,{cE:a.cE+u,e:e.e}),bh:i(M,O(a,{e:u}),s),br:r}:{a6:O(e,{e:a.e}),aQ:a,bh:s,br:i(M,O(e,{cE:e.cE+a.e,e:-u}),r)}:{a6:e,aQ:a,bh:s,br:r},f=hr(Zn,n,function(m){return m},Db(c.aQ.e),c.aQ,c.a6,we(o));return l(c.br,O(n,{d:i(M,f,n.d),i:c.bh}))}),Ua=function(e){e:for(;;){var r=e.a,n=e.b;if(r.b){var t=r.a,a=r.b,o=t.g;if(o.$===5){var s=o.a,u=o.b;return ph(u)||!s?Ua(function(f){return l(a,f)}(i(Tt,n,i(Ba,t,Ta(u))))):Ua(i(x,function(f){return l(a,f)}(i(Tt,n,i(Ba,t,Ta(u)))),i(V,h(bh,t,n,u),i(sn,uh(u),a))))}else{var c=l(a,i(or,n,t));e=c;continue e}}else return Qn(n)}},bh=de(function(e,r,n,t){var a=t.a,o=t.b,s=t.c;return l(s,O(r,{d:i(M,hr(Zn,r,function(u){return u},Ta(n),e,a,o),r.d)}))}),hl=function(e){e:for(;;){var r=e.a,n=e.b;if(r.b){var t=r.a,a=r.b,o=t.g;if(o.$===3&&o.a==="]")return hl(i(x,l(a,n),i(me,h(hh,t,a,n),i(sn,ch,n.i))));var s=l(a,i(or,n,t));e=s;continue e}else return Qn(n)}},hh=de(function(e,r,n,t){var a=t.a,o=t.b,s=t.c,u=function(v){return hr(Zn,n,function(_){return _},v?Oi(l("",k)):Pi(l("",k)),a,e,we(o))},c=l(r,O(n,{i:J(o,s)})),f=i(xr,e.cE+1,n.G),m=function(v){var _=function(y){var E=y.g;return E.$===1?O(y,{g:Na(!1)}):y};return O(v,{i:i(Z,_,v.i)})},p=function(v){return ye(f,u(v),O(n,{i:s}))},b=a.g;switch(b.$){case 2:return Dt(i(pe,function(v){return fe(c)},i(rn,No(r),i(So,Vo,i(Ra,function(v){return 0},i(pe,Oo,Po(p(!1))))))));case 1:return b.a?Dt(i(pe,function(v){return fe(c)},i(rn,No(r),i(rn,m,i(So,Vo,i(Ra,function(v){return 0},i(pe,Oo,Po(p(!0))))))))):C(c);default:return k}}),Zn=Hn(function(e,r,n,t,a,o){var s=t.cE+t.e,u=a.cE,c=t.cE,f=a.cE+a.e,m={cq:f,d:w,b7:c,df:r(h(Ge,s,u,e.G)),aG:u,Y:s,a_:n},p=i(Z,function(b){var v=b;return i(al,m,v)},Vi()(O(e,{d:w,i:o})).d);return O(m,{d:p})});function Vi(){return i(R,gn(La),i(R,gn(Ua),i(R,gn(hl),i(R,gn(Fa),gn(bl)))))}var gl=Vi();Vi=function(){return gl};var Do=A(function(e,r,n){return jn(ab(nb(gl(Tb(h(Kv,e,r,It(n)))))).d)}),gh=de(function(e,r,n,t){var a=i(x,Wv,e);switch(t.$){case 2:var s=t.a,o=t.b;return h(Ii,s,o,h(Do,a,n,s));case 4:var s=t.a,u=h(Do,a,n,s);return u.b&&u.a.$===5&&!u.b.b?(u.a,jo(u)):r?i(Xt,s,u):jo(u);case 5:var p=t.a;return Rn(h(dt,e,!0,l(n,p)));case 6:var c=t.a,f=t.b;return i(gr,c,function(b){return i(Z,b,f)}(i(Pu,i(dt,e,c.af),function(b){return l(n,b)})));case 8:var m=t.a,p=t.b;return i(nl,m,h(dt,e,!0,l(n,p)));default:return t}}),dt=A(function(e,r,n){var t=n.a,a=n.b;return i(Z,h(gh,e,r,t),a)}),_n=d(function(e,r){var n=r.a,t=r.b;return l(n,e(t))}),_h=d(function(e,r){var n=i(xr,r.bM,e);return i(dn,Ai,n)?k:C(n)}),wh=d(function(e,r){return i(ku,r.ap,e)?e:h(Dr,r.ap,l(r.bt,r.bN),e)}),kh=function(e){var r=e.eq;if(r.b&&!r.a.$&&r.b.b&&r.b.b.b&&r.b.b.b.b&&r.b.b.b.b.b&&r.b.b.b.b.b.b){var n=r.a.a,t=r.b,a=t.a,o=t.b,s=o.a,u=o.b,c=u.a,f=u.b,m=f.a,p=f.b,b=p.a,v=function(y){return{ap:n,bM:W(e.cM),bN:Dn($([c,m,b])),bt:y}},_=Dn($([a,s]));return i(V,v,_)}else return k},yh="\\s*(?:<([^<>\\s]*)>|([^\\s]*))",xh=i(x,G,K("^\\s*\\[("+($l+(")\\]:"+(yh+(pl+"\\s*(?![^\\n])")))))),Eh=function(e){return i(me,function(r){return r.bt===""||r.ap===""?k:C(r)},i(V,function(r){return O(r,{ap:vl(r.ap)})},i(me,kh,te(h(Ae,1,xh,e)))))},jh=d(function(e,r){e:for(;;){var n=Eh(r);if(n.$)return l(e,C(r));var t=n.a,a=i(wh,e,t),o=i(_h,r,t);if(o.$)return l(a,k);var s=o.a,u=a,c=s;e=u,r=c;continue e}}),Mh=d(function(e,r){return h(Ei,Dr,r,e)}),vt=function(e){return i(ve,Ch,l(e,w))},Ch=d(function(e,r){var n=r.a,t=r.b;switch(e.$){case 4:var a=e.a,o=i(jh,Ue,a),s=o.a,u=o.b,b=i(Mh,s,n);if(u.$)return l(b,t);var c=u.a;return l(b,i(M,i(Xt,c,w),t));case 6:var f=e.a,m=e.b,p=h(ve,d(function(E,S){var P=S.a,H=S.b;return i(_n,function(ne){return i(M,ne,H)},i(vt,P,E))}),l(n,w),m),b=p.a,v=p.b;return l(b,i(M,i(gr,f,v),t));case 5:var y=e.a;return i(_n,function(E){return i(M,E,t)},i(_n,Rn,i(vt,n,y)));case 8:var _=e.a,y=e.b;return i(_n,function(E){return i(M,E,t)},i(_n,nl(_),i(vt,n,y)));default:return l(n,i(M,e,t))}}),Ah=function(e){return i(R,Fv,i(R,function(r){return i(rl,r,w)},i(R,vt(Ue),i(dt,e,!0))))},Ih=Y("blockquote"),Ha=Y("code"),Sh=Y("h1"),Ph=Y("h2"),Oh=Y("h3"),qh=Y("h4"),Vh=Y("h5"),Rh=Y("h6"),Nh=Y("hr"),Bo=Y("ol"),Th=Y("p"),Lo=Y("pre"),Dh=function(e){return i(Re,"start",Oe(e))},Fo=Re("alt"),Bh=d(function(e,r){return i(sr,ip(e),qs(r))}),Lh=Bh,Fh=function(e){var r=e.a,n=e.b;return i(Lh,r,i(x,r,n))},Uh=Z(Fh),Hh=Y("br"),Uo=Y("em"),Sr=function(e){return h(ve,zh,"",e)},zh=d(function(e,r){switch(e.$){case 0:var n=e.a;return J(r,n);case 1:return r+" ";case 2:var n=e.a;return J(r,n);case 3:var t=e.c;return J(r,Sr(t));case 4:var t=e.c;return J(r,Sr(t));case 5:var t=e.c;return J(r,Sr(t));case 6:var t=e.b;return J(r,Sr(t));default:var t=e.b;return J(r,Sr(t))}}),Bt=function(e){return i(Re,"href",op(e))},Ho=Y("img"),zo=function(e){return i(Re,"src",qs(e))},Jo=Y("strong"),Wo=Re("title"),_l=d(function(e,r){var n=i(x,_l(k),e);switch(r.$){case 0:var t=r.a;return B(t);case 1:return i(Hh,w,w);case 2:var a=r.a;return i(Ha,w,$([B(a)]));case 3:var s=r.a,u=r.b,p=r.c;if(u.$)return i(Vn,$([Bt(s)]),i(Z,n,p));var o=u.a;return i(Vn,$([Bt(s),Wo(o)]),i(Z,n,p));case 4:var s=r.a,u=r.b,p=r.c;if(u.$)return i(Ho,$([Fo(Sr(p)),zo(s)]),w);var o=u.a;return i(Ho,$([Fo(Sr(p)),zo(s),Wo(o)]),w);case 5:var c=r.a,f=r.b,p=r.c;return h(Mu,c,Uh(f),i(Z,n,p));case 6:var m=r.a,p=r.b;switch(m){case 1:return i(Uo,w,i(Z,n,p));case 2:return i(Jo,w,i(Z,n,p));default:return m-2>0?i(Jo,w,function(b){return i(M,b,w)}(n(i(tl,m-2,p)))):i(Uo,w,i(Z,n,p))}default:var p=r.b;return B("")}}),Jh=_l(k),wl=A(function(e,r,n){var t=i(x,Jh,r),a=i(x,i(wl,k,r),e);switch(n.$){case 0:return w;case 2:var o=n.b,_=n.c,s=function(){switch(o){case 1:return Sh(w);case 2:return Ph(w);case 3:return Oh(w);case 4:return qh(w);case 5:return Vh(w);default:return Rh(w)}}();return $([s(i(Z,t,_))]);case 1:return $([i(Nh,w,w)]);case 4:var _=n.b;return $([i(Th,w,i(Z,t,_))]);case 3:if(n.a.$===1){var u=n.a,b=u.b,c=n.b,f=function(S){return $([i(Lo,w,$([i(Ha,S,$([B(c)]))]))])},m=b.bL;if(m.$)return f(w);var p=m.a;return f($([I("language-"+p)]))}else{n.a;var c=n.b;return $([i(Lo,w,$([i(Ha,w,$([B(c)]))]))])}case 5:var y=n.a;return function(E){return i(M,E,w)}(i(Ih,w,qr(i(Z,a,y))));case 6:var b=n.a,v=n.b;return function(E){return i(M,E,w)}(function(){var E=b.a_;if(E.$===1){var S=E.a;return Bo(S===1?w:$([Dh(S)]))}else return wu(w)}()(i(Z,i(R,Z(a),i(R,qr,hu(w))),v)));case 7:var _=n.a;return i(Z,t,_);default:n.a;var y=n.b;return function(E){return i(M,E,w)}(i(T,w,i(M,B("Unhandled custom block."),qr(i(Z,a,y)))))}}),Wh=i(wl,k,k),Kh=d(function(e,r){return qr(i(Z,Wh,i(Ah,e,r)))}),Gh=d(function(e,r){var n=i(me,function(a){return a.dL},i(Ee,r,e.ab));if(n.$===1)return B("");var t=n.a;return i(T,$([I("px-6 py-3 mb-4 border-b bg-orange-50")]),$([i(T,$([I("prose max-w-full")]),i(Kh,k,t))]))}),za=Y("label"),qe=Y("span"),Qh=function(e){return{$:1,a:e}},Zh=Ye(function(e,r,n,t,a){return{dI:n,cH:r,cU:e,bg:t,bo:a}}),Yh=function(e){return $([e])},Xh=function(e){var r=i(Qs,function(n){return n==="0"},lr(i(Xr,e.cH,Yh(e.dI))));return r?1:e.cU<0?2:0},Bn=function(e){return e<0?-e:e},eg=d(function(e,r){var n=W(r),t=oe(n,e)<0?Bn(e-n):0;return J(r,i(an,t,"0"))}),Lt=d(function(e,r){return e<1?r:h(Ge,0,-e,r)}),kl=function(e){return i(Nn,1,e)!=="0"?e:kl(i(Lt,1,e))},rg=d(function(e,r){var n=e.dI;switch(n.$){case 1:return kl(r);case 2:return r;default:var t=n.a;return i(eg,t,r)}}),ng=d(function(e,r){var n=i(Ci,function(t){return t!=="0"&&t!=="."},Fu(r));return J(e&&n?"-":"",r)}),yl=function(e){var r=e.a,n=e.b;if(r==="9"){var t=fn(n);if(t.$===1)return"01";var a=t.a;return i(Va,"0",yl(a))}else{var o=pn(r);return o>=48&&o<57?i(Va,qt(o+1),n):"0"}},tg=Rc,ag=Bc,Ja=A(function(e,r,n){return J(n,i(an,e-W(n),tn(r)))}),Ko=Jc,xl=function(e){var r=i(Jn,".",e);if(r.b)if(r.b.b){var n=r.a,t=r.b,a=t.a;return l(n,a)}else{var n=r.a;return l(n,"0")}else return l("0","0")},ig=d(function(e,r){var n=r.a,t=r.b;return l(e(n),t)}),og=function(e){var r=i(Jn,"e",he(Bn(e)));if(r.b)if(r.b.b){var n=r.a,t=r.b,a=t.a,o=i(x,0,Jt(i(cu,"+",a)?i(xr,1,a):a)),s=xl(n),u=s.a,c=s.b,f=J(u,c),m=o<0?i(x,"0",i(V,function(p){var b=p.a,v=p.b;return b+("."+v)},i(V,ig(tn),fn(J(i(an,Bn(o),"0"),f))))):h(Ja,o+1,"0",f);return J(e<0?"-":"",m)}else{var n=r.a;return J(e<0?"-":"",n)}else return""},sg=A(function(e,r,n){if(tg(n)||ag(n))return he(n);var t=n<0,a=xl(og(Bn(n))),o=a.a,s=a.b,u=W(o)+r,c=J(i(an,-u+1,"0"),h(Ja,u,"0",J(o,s))),f=W(c),m=i(su,1,u),p=i(e,t,h(Ge,m,f,c)),b=h(Ge,0,m,c),v=p?Ko(i(x,"1",i(V,yl,fn(Ko(b))))):b,_=W(v),y=v==="0"?v:r<=0?J(v,i(an,Bn(r),"0")):oe(r,W(s))<0?h(Ge,0,_-r,v)+("."+h(Ge,_-r,_,v)):J(o+".",h(Ja,r,"0",s));return i(ng,t,y)}),Go=sg(d(function(e,r){var n=fn(r);if(n.$===1)return!1;if(n.a.a==="5")return n.a.b===""?(n.a,!e):(n.a,!0);var t=n.a,a=t.a;return function(o){return o>53&&e||o>=53&&!e}(pn(a))})),ug=function(e){if(e.b){e.a;var r=e.b;return C(r)}else return k},lg=d(function(e,r){var n=function(){var s=e.dI;switch(s.$){case 1:var u=s.a;return Go(u);case 0:return he;default:var c=s.a;return Go(c)}}(),t=i(Jn,".",n(r)),a=function(){var s=ug(t);if(s.$)return"";var u=s.a;return i(x,"",te(u))}(),o=i(x,"",te(t));return l(o,a)}),cg=function(e){var r=W(e)>3?i(Nn,3,e):e,n=function(t){return W(t)>2?i(M,i(Nn,2,t),n(i(Lt,2,t))):W(t)?$([t]):w};return we(i(M,r,n(i(Lt,3,e))))},mg=function(e){var r=function(n){return W(n)>3?i(M,i(Nn,3,n),r(i(Lt,3,n))):$([n])};return we(r(e))},pg=d(function(e,r){return e?cg(i(Ct,yt,r)):mg(i(Ct,yt,r))}),fg=d(function(e,r){var n=i(lg,e,r),t=i(pg,e.bp,i(Ct,yt,n.a)),a=i(rg,e,n.b),o=le(Zh,r,t,a,"",""),s=Xh(o);switch(s){case 2:return O(o,{bg:e.bS,bo:e.bT});case 0:return O(o,{bg:e.cY,bo:e.cZ});default:return O(o,{bg:e.dq,bo:e.dr})}}),$g=d(function(e,r){return r===""?"":J(e.an,r)}),dg=d(function(e,r){var n=$g(e),t=i(Pe,e.ai,r.cH),a=n(r.dI);return lr($([r.bg,t,a,r.bo]))}),El=d(function(e,r){return i(dg,e,i(fg,e,r))}),jl=function(e){return{$:2,a:e}},vg=function(e){return{$:0,a:e}},bg={an:".",dI:vg(0),bS:"−",bT:"",cY:"",cZ:"",bp:0,ai:"",dq:"",dr:""},Ml=O(bg,{an:",",dI:jl(3),ai:" "}),Ln=function(e){return El(O(Ml,{dI:Qh(e)}))},hg=d(function(e,r){var n=i(V,function(a){var o=a.aC;return o},i(Ee,r,e.L));if(!n.$&&n.a.$===1){var t=n.a.a;return t===100?i(T,$([I("text-end text-success")]),$([B("100 % ✅")])):i(T,$([I("text-end text-error")]),$([B(i(Ln,1,t)+" %")]))}else return B("")}),Fn=function(e){return{$:0,a:e}},gg={$:11},_g=sm,wg=oi,ea=d(function(e,r){return i(Os,e,wg(r))}),Qo=ea("checked"),Br=ea("disabled"),un=Y("input"),kg=i(jt,$(["target","checked"]),ki),Zo=function(e){return i(_u,"change",i(_e,e,kg))},ln=Re("type"),yg=A(function(e,r,n){return i(T,$([I("form-control")]),$([i(za,$([I("label cursor-pointer")]),$([i(qe,$([I("label-text")]),$([B("Oui")])),i(un,$([I("radio radio-sm"),ln("radio"),Qo(r),Br(n),Zo(function(t){return Fn(l(e,Cn(t)))})]),w)])),i(za,$([I("label cursor-pointer")]),$([i(qe,$([I("label-text")]),$([B("Non")])),i(un,$([I("radio radio-sm"),ln("radio"),Qo(!r),Br(n),Zo(function(t){return Fn(l(e,Cn(!t)))})]),w)]))]))}),Yo=i(un,$([I("input"),Br(!0)]),w),xg=function(e){return l(e,!0)},Eg=function(e){return{$:1,a:e}},jg=d(function(e,r){return i(gu,e,Eg(r))}),Mg=i(jt,$(["target","value"]),be),ra=function(e){return i(jg,"input",i(_e,xg,i(_e,e,Mg)))},Cl=Re("placeholder"),Cg=A(function(e,r,n){return i(un,$([ln("number"),Br(n),I("input input-bordered"),Cl(he(e)),ra(r)]),w)}),Ri=Re("max"),Ag=Re("min"),na=Re("value"),Ig=A(function(e,r,n){var t=n?" opacity-50 cursor-not-allowed":"";return i(T,$([I("flex flex-row")]),$([i(un,$([ln("range"),Br(n),I("range range-accent range-xs my-2"+t),na(he(e)),ra(r),Ag("0"),Ri("100")]),w),i(qe,$([I("ml-4"+t)]),$([B(he(e))]))]))}),Sg=A(function(e,r,n){return i(x,n,i(me,function(t){return t.dg},i(Ee,r+(" . "+n),e)))}),Al=function(e){switch(e.$){case 0:var r=e.a;return r;case 1:var n=e.a;return i(El,O(Ml,{dI:jl(1)}),n);case 2:var t=e.a;return t?"oui":"non";default:return""}},Pg=function(e){var r=i(x,G,K("^'|'$"));return h(cr,r,function(n){return""},Al(e))},Og=Y("option"),qg=Y("select"),Vg=ea("selected"),Rg=Ye(function(e,r,n,t,a){return i(qg,$([ra(function(o){return Fn(l(r,wi(o)))}),I("select select-bordered"),Br(a)]),i(Z,function(o){return i(Og,$([na(o),Vg(re(Pg(t),o))]),$([B(h(Sg,e,r,o))]))},n))}),Ng=A(function(e,r,n){return i(un,$([ln("text"),Br(n),I("input input-bordered"),Cl(e),ra(r)]),w)}),Tg=A(function(e,r,n){var t=r.a,a=r.b,o=function(_){var y=_g(_);if(y.$)return ur(_)?gg:Fn(l(t,wi(_)));var E=y.a;return Fn(l(t,du(E)))},s=i(V,function(_){return _.aC},i(Ee,t,e.L));if(n)return Yo;var u=l(l(a.dS,a.dj),s);e:for(;;){r:for(;;){if(u.b.$)break r;switch(u.b.a.$){case 1:if(!u.a.a.$&&u.a.a.a.$===4)break e;if(!u.a.b.$&&u.a.b.a==="%"){u.a;var c=u.b.a.a;return h(Ig,c,o,n)}else{var c=u.b.a.a;return h(Cg,c,o,n)}case 0:if(!u.a.a.$&&u.a.a.a.$===4)break e;var f=u.b.a.a;return h(Ng,f,o,n);case 2:if(!u.a.a.$&&u.a.a.a.$===4)break e;var m=u.b.a.a;return h(yg,t,m,n);default:if(!u.a.a.$&&u.a.a.a.$===4)break e;break r}}return Yo}var p=u.a,b=p.a.a.a.ec,v=u.b.a;return le(Rg,e.ab,t,b,v,n)}),Il=function(e){var r=e.dj;if(r.$)return B("");if(r.a==="l")return B(" litre");var n=r.a;return B(" "+n)},Dg=A(function(e,r,n){var t=r.a,a=r.b;return i(x,B(""),i(V,function(o){return i(T,w,$([i(za,$([I("form-control mb-1")]),$([i(T,$([I("label")]),$([i(qe,$([I("label-text text-md font-semibold")]),$([B(o)])),i(qe,$([I("label-text-alt text-md")]),$([Il(a)]))])),t==="transport . public . parts totales"?i(hg,e,t):h(Tg,e,l(t,a),n)]))]))},a.dg))}),Bg=d(function(e,r){return i(T,$([I("bg-neutral rounded-md p-4 border border-base-200")]),i(Z,function(n){var t=l(i(Ee,n,e.ab),i(Ee,n,e.L));if(!t.a.$&&!t.b.$){var a=t.a.a,o=t.b.a;return h(Dg,e,l(n,a),o.cI)}else return B("")},r))}),Lg=d(function(e,r){if(r.$)return B("");var n=r.a;return i(T,$([I("grid grid-cols-1 lg:grid-cols-2 gap-6 px-6")]),i(Z,Bg(e),n))}),Fg=function(e){var r=i(x,"",e.am);return i(T,$([I("bg-neutral border-x border-b border-base-200 rounded-md ")]),i(Z,function(n){var t=n.a,a=re(r,t);return h(Ad,Fd,$([I("mb-8"),i(Hd,"display",a?"block":"none")]),$([i(T,$([I("pl-6 bg-base-200 font-semibold p-2 border border-base-300 rounded-t-md")]),$([B(Qt(t))])),i(Gh,e,t),i(Lg,e,i(Ee,t,e.aD))]))},Nr(e.ae)))},Ni=sr("class"),Ti=sr("d"),Di=sr("fill"),Sl=Ss("http://www.w3.org/2000/svg"),Bi=Sl("path"),Li=sr("stroke-linecap"),Fi=sr("stroke-linejoin"),Ui=sr("stroke-width"),Hi=Sl("svg"),zi=sr("viewBox"),Xo=i(Hi,$([Di("none"),zi("0 0 24 24"),Ni("stroke-current shrink-0 h-6 w-6")]),$([i(Bi,$([Li("round"),Fi("round"),Ui("2"),Ti("M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z")]),w)])),es=function(e){if(e.$)return B("");if(e.a.$)return e.a,i(T,$([I("alert alert-error flex")]),$([Xo,i(qe,w,$([B("Le fichier renseigné ne contient pas de situation valide.")]))]));var r=e.a.a;return i(T,$([I("alert alert-error flex")]),$([Xo,i(qe,w,$([B(tu(r))]))]))},Ug=Y("footer"),rs=Re("target"),Hg=i(Ug,w,$([i(T,$([I("flex flex-col gap-y-2 items-center justify-center w-full px-4 py-4 mt-4 border-t border-base-200 text-primary bg-neutral")]),$([i(T,$([I("flex gap-x-4")]),$([i(Vn,$([I("hover:text-primary cursor-pointer"),Bt("https://ekofest.github.io/publicodes-evenements"),rs("_blank")]),$([B("Consulter le modèle de calcul")])),i(T,$([I("text-base-200")]),$([B(" | ")])),i(Vn,$([I("hover:text-primary cursor-pointer"),Bt("https://github.com/ekofest/ekofest"),rs("_blank")]),$([B("Consulter le code source")]))])),i(T,$([I("text-accent text-sm")]),$([B("Fait avec amour par Milou et Clemog au Moulin Bonne Vie 🏡")]))]))])),zg=d(function(e,r){return{$:5,a:e,b:r}}),Jg=Y("details"),Pl=d(function(e,r){var n=i(Ee,r,e);if(n.$)return r;var t=n.a;return i(x,r,t.dg)}),ns=A(function(e,r,n){return i(me,function(t){var a=t.aC;if(a.$===1){var o=a.a;return C({as:o/n*100,aT:o,dg:i(Pl,e.ab,r)})}else return k},i(Ee,r,e.L))}),Wg=function(e){if(e.$===1){var r=e.a;return C(r)}else return k},Kg=Y("summary"),Gg="resultats . bilan total",Ol=Y("progress"),Qg=i(Hi,$([zi("0 0 24 24"),Di("none"),Ni("inline-block w-5 h-5 stroke-current")]),$([i(Bi,$([Li("round"),Fi("round"),Ui("2"),Ti("m6 9 6 6 6-6")]),w)])),Zg=i(Hi,$([zi("0 0 24 24"),Di("none"),Ni("inline-block w-5 h-5 stroke-current")]),$([i(Bi,$([Li("round"),Fi("round"),Ui("2"),Ti("m18 15-6-6-6 6")]),w)])),Yg=function(e){if(e.$===1)return B("");var r=e.a;return i(qe,$([I("mr-2 text-xs")]),$([r?Zg:Qg]))},Xg=de(function(e,r,n,t){return i(T,w,$([i(T,$([I("stat-title flex w-full justify-between")]),$([i(qe,w,$([B(Qt(e)),i(qe,$([I("ml-2 font-bold")]),$([B(i(Ln,0,n/1e3)+" tCO2e")]))])),Yg(t)])),i(T,$([I("flex items-center")]),$([i(T,$([I("stat-value text-primary text-2xl text-right w-20 mr-4")]),$([B(i(Ln,1,r)+" %")])),i(Ol,$([I("progress progress-primary h-3"),na(he(r)),Ri("100")]),w)]))]))}),e0=A(function(e,r,n){return i(T,$([I("mb-0")]),$([i(T,$([I("stat-title text-sm flex w-full justify-between")]),$([i(qe,w,$([B(Qt(e))])),i(qe,w,$([B(i(Ln,0,n/1e3)+" tCO2e")]))])),i(T,$([I("flex items-center")]),$([i(T,$([I("stat-value text-accent text-lg  w-16 mr-4")]),$([B(i(Ln,1,r)+" %")])),i(Ol,$([I("progress progress-accent h-2"),na(he(r)),Ri("100")]),w)]))]))}),r0=function(e){return i(T,$([I("p-4 border-t border-base-200 bg-base-100")]),i(Z,function(r){var n=r.dg,t=r.as,a=r.aT;return h(e0,n,t,a)},we(i(Kn,function(r){return r.as},e))))},n0=function(e){var r=i(x,0,i(me,function(t){var a=t.aC;return Wg(a)},i(Ee,Gg,e.L))),n=i(je,function(t){var a=t.a,o=t.b.er;return i(me,function(s){var u=s.dg,c=s.as,f=s.aT;return C({ck:u,as:c,aT:f,dd:i(je,function(m){return h(ns,e,m,f)},o)})},h(ns,e,a,r))},Nr(e.ae));return i(T,$([I("border border-base-200 w-full rounded-md bg-neutral mt-4")]),i(eu,d(function(t,a){var o=a.ck,s=a.as,u=a.aT,c=a.dd,f=t?" border-t border-base-200":" rounded-t-md",m=i(x,!0,i(Ee,o,e.aR));return i(Jg,$([I("collapse rounded-none"+f)]),$([i(Kg,$([I("collapse-title cursor-pointer hover:bg-base-200 rounded-none pr-4"),Sn(i(zg,o,!m))]),$([ie(Xg,o,s,u,C(m))])),i(T,$([I("collapse-content p-0 m-0 bg-base-100")]),$([r0(c)]))]))}),we(i(Kn,function(t){return t.as},n))))},t0={$:9},a0={$:10},i0={$:6},o0=Re("accept"),da=Y("button"),s0=Y("header"),u0=ea("multiple"),l0=function(){var e="join-item btn-sm bg-base-100 font-semibold border border-base-200 hover:bg-base-200";return i(s0,w,$([i(T,$([I("flex items-center justify-between w-full px-8 mb-4 border-b border-base-200 text-primary bg-neutral")]),$([i(T,$([I("flex items-center")]),$([i(T,$([I("text-3xl font-bold text-dark m-2")]),$([B("EkoFest")])),i(qe,$([I("badge badge-accent badge-outline")]),$([B("beta")]))])),i(T,$([I("join join-vertical p-2 sm:join-horizontal")]),$([i(da,$([I(e+" btn-primary"),Sn(a0)]),$([B("Recommencer ↺ ")])),i(da,$([I(e),Sn(t0)]),$([B("Exporter ↑")])),i(da,$([I(e),ln("file"),u0(!1),o0(".json"),Sn(i0)]),$([B("Importer ↓")]))]))]))]))}(),c0=function(e){if(e.$)return B("");var r=e.a.aC;return B(Al(r))},m0=function(e){return i(T,$([I("stats stats-vertical border w-full rounded-md bg-neutral border-base-200")]),i(Z,function(r){var n=r.a,t=r.b;return i(T,$([I("stat")]),$([i(T,$([I("stat-title")]),$([B(i(Pl,e.ab,n))])),i(T,$([I("flex items-baseline")]),$([i(T,$([I("stat-value text-primary")]),$([c0(i(Ee,n,e.L))])),i(T,$([I("stat-desc text-primary ml-2 text-base")]),$([Il(t)]))]))]))},e.aU))},p0=function(e){return i(T,$([I("h-screen")]),$([l0,_o(e.ab)||_o(e.L)?i(T,$([I("flex flex-col w-full items-center")]),$([es(e._),i(T,$([I("loading loading-lg text-primary mt-4")]),w)])):i(T,$([I("flex flex-col-reverse lg:grid lg:grid-cols-3")]),$([i(T,$([I("p-4 lg:pl-8 lg:pr-4 lg:col-span-2")]),$([h(y$,M$,e.aS,e.am),i(it,Fg,e)])),i(it,es,e._),i(T,$([I("flex flex-col p-4 lg:pl-4 lg:col-span-1 lg:pr-8")]),$([i(it,m0,e),i(it,n0,e)]))])),Hg]))},f0=df({dZ:Zf,es:i$,eH:_$,eJ:p0});const $0={Main:{init:f0(i(ir,function(e){return i(ir,function(r){return i(ir,function(n){return Ce({b_:n,P:r,b9:e})},i(Fe,"rules",Vr))},i(Fe,"situation",Vr))},i(Fe,"ui",Vr)))(0)}};var d0=Object.create,Ji=Object.defineProperty,v0=Object.getOwnPropertyDescriptor,ql=Object.getOwnPropertyNames,b0=Object.getPrototypeOf,h0=Object.prototype.hasOwnProperty,Vl=(e,r)=>function(){return r||(0,e[ql(e)[0]])((r={exports:{}}).exports,r),r.exports},g0=(e,r)=>{for(var n in r)Ji(e,n,{get:r[n],enumerable:!0})},_0=(e,r,n,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of ql(r))!h0.call(e,a)&&a!==n&&Ji(e,a,{get:()=>r[a],enumerable:!(t=v0(r,a))||t.enumerable});return e},Rl=(e,r,n)=>(n=e!=null?d0(b0(e)):{},_0(r||!e||!e.__esModule?Ji(n,"default",{value:e,enumerable:!0}):n,e)),w0=Vl({"../../node_modules/nearley/lib/nearley.js"(e,r){(function(n,t){typeof r=="object"&&r.exports?r.exports=t():n.nearley=t()})(e,function(){function n(m,p,b){return this.id=++n.highestId,this.name=m,this.symbols=p,this.postprocess=b,this}n.highestId=0,n.prototype.toString=function(m){var p=typeof m>"u"?this.symbols.map(f).join(" "):this.symbols.slice(0,m).map(f).join(" ")+" ● "+this.symbols.slice(m).map(f).join(" ");return this.name+" → "+p};function t(m,p,b,v){this.rule=m,this.dot=p,this.reference=b,this.data=[],this.wantedBy=v,this.isComplete=this.dot===m.symbols.length}t.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},t.prototype.nextState=function(m){var p=new t(this.rule,this.dot+1,this.reference,this.wantedBy);return p.left=this,p.right=m,p.isComplete&&(p.data=p.build(),p.right=void 0),p},t.prototype.build=function(){var m=[],p=this;do m.push(p.right.data),p=p.left;while(p.left);return m.reverse(),m},t.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,u.fail))};function a(m,p){this.grammar=m,this.index=p,this.states=[],this.wants={},this.scannable=[],this.completed={}}a.prototype.process=function(m){for(var p=this.states,b=this.wants,v=this.completed,_=0;_<p.length;_++){var y=p[_];if(y.isComplete){if(y.finish(),y.data!==u.fail){for(var E=y.wantedBy,S=E.length;S--;){var P=E[S];this.complete(P,y)}if(y.reference===this.index){var H=y.rule.name;(this.completed[H]=this.completed[H]||[]).push(y)}}}else{var H=y.rule.symbols[y.dot];if(typeof H!="string"){this.scannable.push(y);continue}if(b[H]){if(b[H].push(y),v.hasOwnProperty(H))for(var ne=v[H],S=0;S<ne.length;S++){var Ie=ne[S];this.complete(y,Ie)}}else b[H]=[y],this.predict(H)}}},a.prototype.predict=function(m){for(var p=this.grammar.byName[m]||[],b=0;b<p.length;b++){var v=p[b],_=this.wants[m],y=new t(v,0,this.index,_);this.states.push(y)}},a.prototype.complete=function(m,p){var b=m.nextState(p);this.states.push(b)};function o(m,p){this.rules=m,this.start=p||this.rules[0].name;var b=this.byName={};this.rules.forEach(function(v){b.hasOwnProperty(v.name)||(b[v.name]=[]),b[v.name].push(v)})}o.fromCompiled=function(v,p){var b=v.Lexer;v.ParserStart&&(p=v.ParserStart,v=v.ParserRules);var v=v.map(function(y){return new n(y.name,y.symbols,y.postprocess)}),_=new o(v,p);return _.lexer=b,_};function s(){this.reset("")}s.prototype.reset=function(m,p){this.buffer=m,this.index=0,this.line=p?p.line:1,this.lastLineBreak=p?-p.col:0},s.prototype.next=function(){if(this.index<this.buffer.length){var m=this.buffer[this.index++];return m===`
`&&(this.line+=1,this.lastLineBreak=this.index),{value:m}}},s.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},s.prototype.formatError=function(m,p){var b=this.buffer;if(typeof b=="string"){var v=b.split(`
`).slice(Math.max(0,this.line-5),this.line),_=b.indexOf(`
`,this.index);_===-1&&(_=b.length);var y=this.index-this.lastLineBreak,E=String(this.line).length;return p+=" at line "+this.line+" col "+y+`:

`,p+=v.map(function(P,H){return S(this.line-v.length+H+1,E)+" "+P},this).join(`
`),p+=`
`+S("",E+y)+`^
`,p}else return p+" at index "+(this.index-1);function S(P,H){var ne=String(P);return Array(H-ne.length+1).join(" ")+ne}};function u(m,p,b){if(m instanceof o)var v=m,b=p;else var v=o.fromCompiled(m,p);this.grammar=v,this.options={keepHistory:!1,lexer:v.lexer||new s};for(var _ in b||{})this.options[_]=b[_];this.lexer=this.options.lexer,this.lexerState=void 0;var y=new a(v,0);this.table=[y],y.wants[v.start]=[],y.predict(v.start),y.process(),this.current=0}u.fail={},u.prototype.feed=function(m){var p=this.lexer;p.reset(m,this.lexerState);for(var b;;){try{if(b=p.next(),!b)break}catch(ce){var E=new a(this.grammar,this.current+1);this.table.push(E);var v=new Error(this.reportLexerError(ce));throw v.offset=this.current,v.token=ce.token,v}var _=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var y=this.current+1,E=new a(this.grammar,y);this.table.push(E);for(var S=b.text!==void 0?b.text:b.value,P=p.constructor===s?b.value:b,H=_.scannable,ne=H.length;ne--;){var Ie=H[ne],ke=Ie.rule.symbols[Ie.dot];if(ke.test?ke.test(P):ke.type?ke.type===b.type:ke.literal===S){var pr=Ie.nextState({data:P,token:b,isToken:!0,reference:y-1});E.states.push(pr)}}if(E.process(),E.states.length===0){var v=new Error(this.reportError(b));throw v.offset=this.current,v.token=b,v}this.options.keepHistory&&(_.lexerState=p.save()),this.current++}return _&&(this.lexerState=p.save()),this.results=this.finish(),this},u.prototype.reportLexerError=function(m){var p,b,v=m.token;return v?(p="input "+JSON.stringify(v.text[0])+" (lexer error)",b=this.lexer.formatError(v,"Syntax error")):(p="input (lexer error)",b=m.message),this.reportErrorCommon(b,p)},u.prototype.reportError=function(m){var p=(m.type?m.type+" token: ":"")+JSON.stringify(m.value!==void 0?m.value:m),b=this.lexer.formatError(m,"Syntax error");return this.reportErrorCommon(b,p)},u.prototype.reportErrorCommon=function(m,p){var b=[];b.push(m);var v=this.table.length-2,_=this.table[v],y=_.states.filter(function(S){var P=S.rule.symbols[S.dot];return P&&typeof P!="string"});if(y.length===0)b.push("Unexpected "+p+`. I did not expect any more input. Here is the state of my parse table:
`),this.displayStateStack(_.states,b);else{b.push("Unexpected "+p+`. Instead, I was expecting to see one of the following:
`);var E=y.map(function(S){return this.buildFirstStateStack(S,[])||[S]},this);E.forEach(function(S){var P=S[0],H=P.rule.symbols[P.dot],ne=this.getSymbolDisplay(H);b.push("A "+ne+" based on:"),this.displayStateStack(S,b)},this)}return b.push(""),b.join(`
`)},u.prototype.displayStateStack=function(m,p){for(var b,v=0,_=0;_<m.length;_++){var y=m[_],E=y.rule.toString(y.dot);E===b?v++:(v>0&&p.push("    ^ "+v+" more lines identical to this"),v=0,p.push("    "+E)),b=E}},u.prototype.getSymbolDisplay=function(m){return c(m)},u.prototype.buildFirstStateStack=function(m,p){if(p.indexOf(m)!==-1)return null;if(m.wantedBy.length===0)return[m];var b=m.wantedBy[0],v=[m].concat(p),_=this.buildFirstStateStack(b,v);return _===null?null:[m].concat(_)},u.prototype.save=function(){var m=this.table[this.current];return m.lexerState=this.lexerState,m},u.prototype.restore=function(m){var p=m.index;this.current=p,this.table[p]=m,this.table.splice(p+1),this.lexerState=m.lexerState,this.results=this.finish()},u.prototype.rewind=function(m){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[m])},u.prototype.finish=function(){var m=[],p=this.grammar.start,b=this.table[this.table.length-1];return b.states.forEach(function(v){v.rule.name===p&&v.dot===v.rule.symbols.length&&v.reference===0&&v.data!==u.fail&&m.push(v)}),m.map(function(v){return v.data})};function c(m){var p=typeof m;if(p==="string")return m;if(p==="object"){if(m.literal)return JSON.stringify(m.literal);if(m instanceof RegExp)return"character matching "+m;if(m.type)return m.type+" token";if(m.test)return"token matching "+String(m.test);throw new Error("Unknown symbol type: "+m)}}function f(m){var p=typeof m;if(p==="string")return m;if(p==="object"){if(m.literal)return JSON.stringify(m.literal);if(m instanceof RegExp)return m.toString();if(m.type)return"%"+m.type;if(m.test)return"<"+String(m.test)+">";throw new Error("Unknown symbol type: "+m)}}return{Parser:u,Grammar:o,Rule:n}})}}),k0=Vl({"../../node_modules/moo/moo.js"(e,r){(function(n,t){typeof define=="function"&&define.amd?define([],t):typeof r=="object"&&r.exports?r.exports=t():n.moo=t()})(e,function(){var n=Object.prototype.hasOwnProperty,t=Object.prototype.toString,a=typeof new RegExp().sticky=="boolean";function o(g){return g&&t.call(g)==="[object RegExp]"}function s(g){return g&&typeof g=="object"&&!o(g)&&!Array.isArray(g)}function u(g){return g.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function c(g){var j=new RegExp("|"+g);return j.exec("").length-1}function f(g){return"("+g+")"}function m(g){if(!g.length)return"(?!)";var j=g.map(function(q){return"(?:"+q+")"}).join("|");return"(?:"+j+")"}function p(g){if(typeof g=="string")return"(?:"+u(g)+")";if(o(g)){if(g.ignoreCase)throw new Error("RegExp /i flag not allowed");if(g.global)throw new Error("RegExp /g flag is implied");if(g.sticky)throw new Error("RegExp /y flag is implied");if(g.multiline)throw new Error("RegExp /m flag is implied");return g.source}else throw new Error("Not a pattern: "+g)}function b(g,j){return g.length>j?g:Array(j-g.length+1).join(" ")+g}function v(g,j){for(var q=g.length,N=0;;){var z=g.lastIndexOf(`
`,q-1);if(z===-1||(N++,q=z,N===j)||q===0)break}var D=N<j?0:q+1;return g.substring(D).split(`
`)}function _(g){for(var j=Object.getOwnPropertyNames(g),q=[],N=0;N<j.length;N++){var z=j[N],D=g[z],Q=[].concat(D);if(z==="include"){for(var se=0;se<Q.length;se++)q.push({include:Q[se]});continue}var ee=[];Q.forEach(function(U){s(U)?(ee.length&&q.push(E(z,ee)),q.push(E(z,U)),ee=[]):ee.push(U)}),ee.length&&q.push(E(z,ee))}return q}function y(g){for(var j=[],q=0;q<g.length;q++){var N=g[q];if(N.include){for(var z=[].concat(N.include),D=0;D<z.length;D++)j.push({include:z[D]});continue}if(!N.type)throw new Error("Rule has no type: "+JSON.stringify(N));j.push(E(N.type,N))}return j}function E(g,j){if(s(j)||(j={match:j}),j.include)throw new Error("Matching rules cannot also include states");var q={defaultType:g,lineBreaks:!!j.error||!!j.fallback,pop:!1,next:null,push:null,error:!1,fallback:!1,value:null,type:null,shouldThrow:!1};for(var N in j)n.call(j,N)&&(q[N]=j[N]);if(typeof q.type=="string"&&g!==q.type)throw new Error("Type transform cannot be a string (type '"+q.type+"' for token '"+g+"')");var z=q.match;return q.match=Array.isArray(z)?z:z?[z]:[],q.match.sort(function(D,Q){return o(D)&&o(Q)?0:o(Q)?-1:o(D)?1:Q.length-D.length}),q}function S(g){return Array.isArray(g)?y(g):_(g)}var P=E("error",{lineBreaks:!0,shouldThrow:!0});function H(g,j){for(var q=null,N=Object.create(null),z=!0,D=null,Q=[],se=[],ee=0;ee<g.length;ee++)g[ee].fallback&&(z=!1);for(var ee=0;ee<g.length;ee++){var U=g[ee];if(U.include)throw new Error("Inheritance is not allowed in stateless lexers");if(U.error||U.fallback){if(q)throw!U.fallback==!q.fallback?new Error("Multiple "+(U.fallback?"fallback":"error")+" rules not allowed (for token '"+U.defaultType+"')"):new Error("fallback and error are mutually exclusive (for token '"+U.defaultType+"')");q=U}var ge=U.match.slice();if(z)for(;ge.length&&typeof ge[0]=="string"&&ge[0].length===1;){var Mr=ge.shift();N[Mr.charCodeAt(0)]=U}if(U.pop||U.push||U.next){if(!j)throw new Error("State-switching options are not allowed in stateless lexers (for token '"+U.defaultType+"')");if(U.fallback)throw new Error("State-switching options are not allowed on fallback tokens (for token '"+U.defaultType+"')")}if(ge.length!==0){z=!1,Q.push(U);for(var Cr=0;Cr<ge.length;Cr++){var Ar=ge[Cr];if(o(Ar)){if(D===null)D=Ar.unicode;else if(D!==Ar.unicode&&U.fallback===!1)throw new Error("If one rule is /u then all must be")}}var Wr=m(ge.map(p)),ze=new RegExp(Wr);if(ze.test(""))throw new Error("RegExp matches empty string: "+ze);var vn=c(Wr);if(vn>0)throw new Error("RegExp has capture groups: "+ze+`
Use (?: … ) instead`);if(!U.lineBreaks&&ze.test(`
`))throw new Error("Rule should declare lineBreaks: "+ze);se.push(f(Wr))}}var Kr=q&&q.fallback,bn=a&&!Kr?"ym":"gm",rt=a||Kr?"":"|";D===!0&&(bn+="u");var hc=new RegExp(m(se)+rt,bn);return{regexp:hc,groups:Q,fast:N,error:q||P}}function ne(g){var j=H(S(g));return new ce({start:j},"start")}function Ie(g,j,q){var N=g&&(g.push||g.next);if(N&&!q[N])throw new Error("Missing state '"+N+"' (in token '"+g.defaultType+"' of state '"+j+"')");if(g&&g.pop&&+g.pop!=1)throw new Error("pop must be 1 (in token '"+g.defaultType+"' of state '"+j+"')")}function ke(g,j){var q=g.$all?S(g.$all):[];delete g.$all;var N=Object.getOwnPropertyNames(g);j||(j=N[0]);for(var z=Object.create(null),D=0;D<N.length;D++){var Q=N[D];z[Q]=S(g[Q]).concat(q)}for(var D=0;D<N.length;D++)for(var Q=N[D],se=z[Q],ee=Object.create(null),U=0;U<se.length;U++){var ge=se[U];if(ge.include){var Mr=[U,1];if(ge.include!==Q&&!ee[ge.include]){ee[ge.include]=!0;var Cr=z[ge.include];if(!Cr)throw new Error("Cannot include nonexistent state '"+ge.include+"' (in state '"+Q+"')");for(var Ar=0;Ar<Cr.length;Ar++){var Wr=Cr[Ar];se.indexOf(Wr)===-1&&Mr.push(Wr)}}se.splice.apply(se,Mr),U--}}for(var ze=Object.create(null),D=0;D<N.length;D++){var Q=N[D];ze[Q]=H(z[Q],!0)}for(var D=0;D<N.length;D++){for(var vn=N[D],Kr=ze[vn],bn=Kr.groups,U=0;U<bn.length;U++)Ie(bn[U],vn,ze);for(var rt=Object.getOwnPropertyNames(Kr.fast),U=0;U<rt.length;U++)Ie(Kr.fast[rt[U]],vn,ze)}return new ce(ze,j)}function pr(g){for(var j=typeof Map<"u",q=j?new Map:Object.create(null),N=Object.getOwnPropertyNames(g),z=0;z<N.length;z++){var D=N[z],Q=g[D],se=Array.isArray(Q)?Q:[Q];se.forEach(function(ee){if(typeof ee!="string")throw new Error("keyword must be string (in keyword '"+D+"')");j?q.set(ee,D):q[ee]=D})}return function(ee){return j?q.get(ee):q[ee]}}var ce=function(g,j){this.startState=j,this.states=g,this.buffer="",this.stack=[],this.reset()};ce.prototype.reset=function(g,j){return this.buffer=g||"",this.index=0,this.line=j?j.line:1,this.col=j?j.col:1,this.queuedToken=j?j.queuedToken:null,this.queuedText=j?j.queuedText:"",this.queuedThrow=j?j.queuedThrow:null,this.setState(j?j.state:this.startState),this.stack=j&&j.stack?j.stack.slice():[],this},ce.prototype.save=function(){return{line:this.line,col:this.col,state:this.state,stack:this.stack.slice(),queuedToken:this.queuedToken,queuedText:this.queuedText,queuedThrow:this.queuedThrow}},ce.prototype.setState=function(g){if(!(!g||this.state===g)){this.state=g;var j=this.states[g];this.groups=j.groups,this.error=j.error,this.re=j.regexp,this.fast=j.fast}},ce.prototype.popState=function(){this.setState(this.stack.pop())},ce.prototype.pushState=function(g){this.stack.push(this.state),this.setState(g)};var fr=a?function(g,j){return g.exec(j)}:function(g,j){var q=g.exec(j);return q[0].length===0?null:q};ce.prototype._getGroup=function(g){for(var j=this.groups.length,q=0;q<j;q++)if(g[q+1]!==void 0)return this.groups[q];throw new Error("Cannot find token type for matched text")};function et(){return this.value}if(ce.prototype.next=function(){var g=this.index;if(this.queuedGroup){var j=this._token(this.queuedGroup,this.queuedText,g);return this.queuedGroup=null,this.queuedText="",j}var q=this.buffer;if(g!==q.length){var Q=this.fast[q.charCodeAt(g)];if(Q)return this._token(Q,q.charAt(g),g);var N=this.re;N.lastIndex=g;var z=fr(N,q),D=this.error;if(z==null)return this._token(D,q.slice(g,q.length),g);var Q=this._getGroup(z),se=z[0];return D.fallback&&z.index!==g?(this.queuedGroup=Q,this.queuedText=se,this._token(D,q.slice(g,z.index),g)):this._token(Q,se,g)}},ce.prototype._token=function(g,j,q){var N=0;if(g.lineBreaks){var z=/\n/g,D=1;if(j===`
`)N=1;else for(;z.exec(j);)N++,D=z.lastIndex}var Q={type:typeof g.type=="function"&&g.type(j)||g.defaultType,value:typeof g.value=="function"?g.value(j):j,text:j,toString:et,offset:q,lineBreaks:N,line:this.line,col:this.col},se=j.length;if(this.index+=se,this.line+=N,N!==0?this.col=se-D+1:this.col+=se,g.shouldThrow){var ee=new Error(this.formatError(Q,"invalid syntax"));throw ee}return g.pop?this.popState():g.push?this.pushState(g.push):g.next&&this.setState(g.next),Q},typeof Symbol<"u"&&Symbol.iterator){var jr=function(g){this.lexer=g};jr.prototype.next=function(){var g=this.lexer.next();return{value:g,done:!g}},jr.prototype[Symbol.iterator]=function(){return this},ce.prototype[Symbol.iterator]=function(){return new jr(this)}}return ce.prototype.formatError=function(g,j){if(g==null)var q=this.buffer.slice(this.index),g={text:q,offset:this.index,lineBreaks:q.indexOf(`
`)===-1?0:1,line:this.line,col:this.col};var N=2,z=Math.max(g.line-N,1),D=g.line+N,Q=String(D).length,se=v(this.buffer,this.line-g.line+N+1).slice(0,5),ee=[];ee.push(j+" at line "+g.line+" col "+g.col+":"),ee.push("");for(var U=0;U<se.length;U++){var ge=se[U],Mr=z+U;ee.push(b(String(Mr),Q)+"  "+ge),Mr===g.line&&ee.push(b("",Q+g.col+1)+"^")}return ee.join(`
`)},ce.prototype.clone=function(){return new ce(this.states,this.state)},ce.prototype.has=function(g){return!0},{compile:ne,states:ke,error:Object.freeze({error:!0}),fallback:Object.freeze({fallback:!0}),keywords:pr}})}}),F=class extends Error{constructor(r,n,t,a){super(Wi(r,n,t,a));ae(this,"name");ae(this,"info");this.name=r,this.info=t}},Wi=(e,r,n,t)=>{const a={SyntaxError:"Erreur syntaxique",EvaluationError:"Erreur d'évaluation",UnknownRule:"Règle inconnue",PrivateRule:"Règle privée"},o=/error/i.test(e);return`
[ ${a[e]??e} ]`+(n&&"dottedName"in n&&n.dottedName?.length?`
➡️  Dans la règle "${n.dottedName}"`:"")+`
${o?"✖️":"⚠️"}  ${r}`+(t?`
`+(o?"    ":"ℹ️  ")+t.message:"")},ta=class extends F{constructor(e){super("InternalError",`
Erreur interne du moteur.

Cette erreur est le signe d'un bug dans publicodes. Pour nous aider à le résoudre, vous pouvez copier ce texte dans un nouveau ticket : https://github.com/betagouv/mon-entreprise/issues/new.

payload:
${JSON.stringify(e,null,2)}
`,e)}},y0=class extends ta{constructor(e){super(e)}};function aa(e,r,n,t){e.warn(Wi("Avertissement",r,n,t))}function ts(e,r){e.warn(Wi("Avertissement",`Cette règle est tagguée comme experimentale. 

Cela veut dire qu'elle peut être modifiée, renommée, ou supprimée sans qu'il n'y ait de changement de version majeure dans l'API.
`,{dottedName:r}))}function as(e,r,n){if(e.has(r)){e.get(r).add(n);return}e.set(r,new Set([n]))}function x0(e,r){return Object.entries(r).reduce((n,[t,a])=>({...n,[t]:[...n[t]??[],...a]}),e)}var _r=e=>{const r={};for(const n in e)r[n]=e[n];return r};function Ft(e,r=!0){function n(t){const a=e(t,n);return a===!1?t:a===void 0?Wa(n,t):r?a:Wa(n,a)}return n}function Nl(e){function r(t){switch(e(t,r)){case"continue":Wa(n,t);return;case"stop":return}}const n=t=>(r(t),t);return r}function E0(e,r){const n={};for(const t in r)n[t]=e(r[t]);return n}var Wa=(e,r)=>{switch(r=j0(e,r),r.nodeKind){case"rule":return M0(e,r);case"reference":case"constant":return r;case"arrondi":return R0(e,r);case"simplifier unité":case"variable manquante":case"est non applicable":case"est non défini":return A0(e,r);case"barème":case"taux progressif":case"grille":return S0(e,r);case"une possibilité":return P0(e,r);case"durée":return q0(e,r);case"résoudre référence circulaire":return N0(e,r);case"inversion":return V0(e,r);case"operation":return O0(e,r);case"contexte":return D0(e,r);case"unité":return B0(e,r);case"variations":return L0(e,r);case"replacementRule":return C0(e,r);case"texte":return T0(e,r);case"condition":return F0(e,r);default:throw new y0(r)}},j0=(e,r)=>{if(!("sourceMap"in r)||!r.sourceMap||!r.sourceMap.args)return r;const n=r.sourceMap,t={};for(const a in n.args){const o=n.args[a];t[a]=Array.isArray(o)?o.map(s=>e(s)):e(o)}return{...r,sourceMap:{...n,args:t}}},M0=(e,r)=>{const n=_r(r);n.suggestions={};for(const t in r.suggestions)n.suggestions[t]=e(r.suggestions[t]);return n.replacements=r.replacements.map(e),n.explanation={ruleDisabledByItsParent:r.explanation.ruleDisabledByItsParent,nullableParent:r.explanation.nullableParent?e(r.explanation.nullableParent):void 0,parents:r.explanation.parents.map(e),valeur:e(r.explanation.valeur)},n},C0=(e,r)=>({...r,definitionRule:e(r.definitionRule),replacedReference:e(r.replacedReference),whiteListedNames:r.whiteListedNames.map(e),blackListedNames:r.blackListedNames.map(e)}),A0=(e,r)=>({...r,explanation:e(r.explanation)});function I0(e,r){return r.map(n=>({...n,...n.plafond&&{plafond:e(n.plafond)},..."montant"in n&&{montant:e(n.montant)},..."taux"in n&&{taux:e(n.taux)}}))}var S0=(e,r)=>({...r,explanation:{assiette:e(r.explanation.assiette),multiplicateur:e(r.explanation.multiplicateur),tranches:I0(e,r.explanation.tranches)}}),P0=(e,r)=>({...r,explanation:r.explanation.map(e)}),O0=(e,r)=>{const n=_r(r);return n.explanation=[e(r.explanation[0]),e(r.explanation[1])],n},q0=(e,r)=>({...r,explanation:{depuis:e(r.explanation.depuis),"jusqu'à":e(r.explanation["jusqu'à"])}}),V0=(e,r)=>({...r,explanation:{...r.explanation,inversionCandidates:r.explanation.inversionCandidates.map(e)}}),R0=(e,r)=>({...r,explanation:{valeur:e(r.explanation.valeur),arrondi:e(r.explanation.arrondi)}}),N0=(e,r)=>({...r,explanation:{...r.explanation,valeur:e(r.explanation.valeur)}}),T0=(e,r)=>({...r,explanation:r.explanation.map(n=>typeof n=="string"?n:e(n))}),D0=(e,r)=>({...r,explanation:{...r.explanation,contexte:r.explanation.contexte.map(([n,t])=>[e(n),e(t)]),node:e(r.explanation.node)}}),B0=(e,r)=>{const n=_r(r);return n.explanation=e(r.explanation),n},L0=(e,r)=>({...r,explanation:r.explanation.map(({condition:n,consequence:t})=>({condition:e(n),consequence:t&&e(t)}))}),F0=(e,r)=>{const n=_r(r);return n.explanation={si:e(r.explanation.si),alors:e(r.explanation.alors),sinon:e(r.explanation.sinon)},n},On={constant:e=>e};function $e(e,r){if(On??(On={}),On[e])throw new F("EvaluationError",`Multiple evaluation functions registered for the nodeKind \x1B[4m${e}`,{dottedName:""});On[e]=r}var is={isNullable:void 0,type:void 0};function U0(e,r,n){function t(o){if(!o||typeof o!="object")return is;if(n.has(o))return n.get(o);n.set(o,is);const s=a(o);return n.set(o,s),s}function a(o){switch(o.nodeKind){case"barème":case"durée":case"grille":case"taux progressif":return{isNullable:!1,type:"number"};case"est non défini":case"est non applicable":return{isNullable:!1,type:"boolean"};case"constant":return{isNullable:o.isNullable??o.nodeValue===null,type:o.type};case"operation":return{isNullable:["<","<=",">",">=","/","*"].includes(o.operationKind)?t(o.explanation[0]).isNullable||t(o.explanation[1]).isNullable:o.operationKind==="-"?t(o.explanation[0]).isNullable:!1,type:["<","<=",">",">=","=","!=","et","ou"].includes(o.operationKind)?"boolean":"number"};case"inversion":case"contexte":case"replacementRule":case"résoudre référence circulaire":return{isNullable:!1,type:"number"};case"texte":case"une possibilité":return{isNullable:!1,type:"string"};case"rule":case"arrondi":return t(o.explanation.valeur);case"unité":case"simplifier unité":case"variable manquante":return t(o.explanation);case"condition":return{isNullable:[o.explanation.si,o.explanation.alors,o.explanation.sinon].some(u=>t(u).isNullable),type:t(o.explanation.alors).type??t(o.explanation.sinon).type};case"variations":const s=o.explanation.map(({consequence:u})=>t(u));return{isNullable:s.some(u=>u.isNullable),type:s.map(u=>u.type).find(u=>u!==void 0)};case"reference":return t(r[o.dottedName])}}return e.forEach(o=>{const s=r[o];t(s),s.explanation.parents.forEach(t)}),n}var H0=e=>"missingVariables"in e?e.missingVariables:{},Tl=(e={})=>Object.fromEntries(Object.entries(e).map(([r,n])=>[r,n+1])),Lr=(e={},r={})=>Object.fromEntries([...Object.keys(e),...Object.keys(r)].map(n=>[n,(e[n]??0)+(r[n]??0)])),He=e=>e.map(H0).reduce(Lr,{}),tr=e=>({nodeValue:e,type:typeof e,isDefault:!0,nodeKind:"constant"}),zr={nodeKind:"constant",nodeValue:null,missingVariables:{},type:void 0,isNullable:!0},Dl={nodeKind:"constant",nodeValue:void 0,missingVariables:{},type:void 0,isNullable:!1},Ut={...Dl,type:"number"};function mr(e,r,n){let t,a;function o(s,u){t??(t=L(n,Un({dottedName:"INLINE_MECANISM"}))),a??(a={});for(const m in r)"par défaut"in r[m]&&(a[m]=L(r[m]["par défaut"],Un({})));Object.keys(r).length===1&&"valeur"in r&&(s={valeur:s});const c={};for(const m in s)c[m]=L(s[m],u);const f=Ft(m=>{if(m.nodeKind!=="reference"||!(m.name in r))return;const p=m.name;if(p in c)return c[p];if(p in a)return a[p];throw new F("SyntaxError",`Il manque la clé '${p} dans le mécanisme ${e}`,{dottedName:p})})(t);return f.sourceMap={mecanismName:e,args:c},f}return o.nom=e,Object.assign(o,"name",{value:`parse${Bl(e)}Inline`})}function Jr(e,r,n){function t(a,o){Object.keys(r).length===1&&"valeur"in r&&(a={valeur:a});const s={};for(const c in a){const f=a[c];s[c]=Array.isArray(f)?f.map(m=>L(m,o)):L(f,o)}const u=L(n(s),o);return u.sourceMap={mecanismName:e,args:s},u}return t.nom=e,Object.assign(t,"name",{value:`parse${Bl(e)}Inline`})}function Bl(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,r=>r.toUpperCase()).replace(/\s+/g,"")}var z0=mr("abattement",{abattement:{},valeur:{}},{"-":["valeur","abattement"],plancher:0}),J0=mr("applicable si",{"applicable si":{},valeur:{}},{condition:{si:"applicable si != non",alors:"valeur",sinon:zr}}),Pr=(e,r=n=>n)=>{if(e.includes(" /")||e.includes("/ "))throw new Error(`L'unité "${e}" ne doit pas contenir d'espace avant et après "/"`);const[n,...t]=e.split("/"),a=s=>K0(s.split(".").filter(Boolean).map(u=>r(u)));return{numerators:a(n),denominators:t.flatMap(s=>a(s))}},W0=/(\d+)(?!.*[A-Za-z])/g;function Ll(e){let r={};return e.forEach(n=>{const t=n.match(W0);if(t!=null){const a=t[0],o=n.split(a)[0];r[o]=(r[o]??0)+ +a}else r[n]=(r[n]??0)+1}),r}function K0(e){let r=Ll(e);return Object.entries(r).flatMap(([n,t])=>Array(t).fill(n))}function G0(e){let r=Ll(e);return Object.entries(r).map(([n,t])=>t>1?`${n}${t}`:n)}var ut=(e,r,n=t=>t)=>G0(e.map(t=>n(t,r))).join("."),os=2;function Qe(e,r=os,n=t=>t){if(e===null||typeof e!="object")return typeof e=="string"?n(e,r):e;const t=ia(e),{numerators:a=[],denominators:o=[]}=t,s=a.length>0,u=o.length>0;return!s&&!u?"":s&&!u?ut(a,r,n):!s&&u?`/${ut(o,1,n)}`:`${ut(a,os,n)}/${ut(o,1,n)}`}var qn={numerators:[],denominators:[]},$r=(e,r)=>{if(e==="/"){if(r.length!==2)throw new F("InternalError","Infer units of a division with units.length !== 2)",{});return $r("*",[r[0]||qn,{numerators:(r[1]||qn).denominators,denominators:(r[1]||qn).numerators}])}const n=r.filter(Boolean);if(n.length<=1)return n[0];if(e==="*")return ia({numerators:n.flatMap(t=>t?.numerators??[]),denominators:n.flatMap(t=>t?.denominators??[])});if(e==="-"||e==="+")return r.find(t=>t)},Fl=(e,r)=>Array.isArray(e)&&Array.isArray(r)?e.length===r.length&&e.every((n,t)=>e[t]===r[t]):e===r,ss=(e,r=Fl)=>n=>{const t=n.findIndex(a=>r(a,e));return n.filter((a,o)=>o!==t)},ia=(e,r=Fl)=>[...e.numerators,...e.denominators].reduce(({numerators:t,denominators:a},o)=>t.find(s=>r(o,s))&&a.find(s=>r(o,s))?{numerators:ss(o,r)(t),denominators:ss(o,r)(a)}:{numerators:t,denominators:a},e),bt={"mois/an":12,"jour/an":365,"jour/mois":365/12,"trimestre/an":4,"mois/trimestre":3,"jour/trimestre":365/12*3,"€/k€":10**3,"g/kg":10**3,"mg/g":10**3,"mg/kg":10**6,"m/km":10**3,"cm/m":10**2,"mm/cm":10**1,"mm/m":10**3,"cm/km":10**5,"mm/km":10**6};function us(e,r){return bt[`${r}/${e}`]||bt[`${e}/${r}`]&&1/bt[`${e}/${r}`]}function Ka(e,r){let n=100**(r.filter(t=>t==="%").length-e.filter(t=>t==="%").length);return[n]=e.reduce(([t,a],o)=>{const s=a.findIndex(c=>!!us(o,c)),u=us(o,a[s])||1;return[t*u,[...a.slice(0,s+1),...a.slice(s+1)]]},[n,r]),n}var ls={"kW.h":"kWh","mn/h":"noeud"};function Q0(e,r){return!e||!r?!1:e===r||e===ls[r]||r===ls[e]}function Yn(e,r,n){const t=Qe(e),a=Qe(r);if(!Q0(t,a)&&!Y0(e,r))throw new F("EngineError",`Impossible de convertir l'unité '${t}' en '${a}'`,{});if(!n||e===void 0)return n;const[o,s]=cs(e||qn),[u,c]=cs(r||qn);return zl(n*s/c*Ka(o.numerators,u.numerators)*Ka(u.denominators,o.denominators))}var Ul=Z0(bt);function Z0(e){return Object.keys(e).reduce((r,n)=>{const[t,a]=n.split("/"),o=r.findIndex(u=>u.has(t)),s=r.findIndex(u=>u.has(a));if(o>-1&&s>-1&&o!==s)throw new F("EngineError",`Invalid ratio ${n}`,{});return o===-1&&s===-1?r.push(new Set([t,a])):o>-1?r[o].add(a):s>-1&&r[s].add(t),r},[])}function Hl(e,r){return e===r||Ul.some(n=>n.has(e)&&n.has(r))}function zl(e){return+e.toFixed(16)}function Jl(e){const{numerators:r,denominators:n}=ia(e,Hl);return r.length&&r.every(t=>t==="%")?{numerators:["%"],denominators:n}:Wl({numerators:r,denominators:n})}function cs(e,r=1){const n=Ka(e.numerators,e.denominators);return[ia(Wl(e),Hl),r&&zl(r*n)]}var Wl=e=>({numerators:e.numerators.filter(r=>r!=="%"),denominators:e.denominators.filter(r=>r!=="%")});function Y0(e,r){if(e==null||r==null)return!0;const n=f=>f.reduce((m,p)=>{const b=Ul.findIndex(_=>_.has(p)),v=b===-1?p:""+b;return{...m,[v]:1+(m[v]??0)}},{}),[t,a,o,s]=[e.numerators,e.denominators,r.numerators,r.denominators].map(n),u=f=>[...new Set(f)],c=[t,a,o,s].map(Object.keys).flat();return u(c).every(f=>(t[f]||0)-(a[f]||0)===(o[f]||0)-(s[f]||0)||f==="%")}function ms(e,r){return+e.toFixed(r)}var X0=function(e){const r=Kl(this.evaluateNode(e.explanation.valeur)),n=r.nodeValue;let t=e.explanation.arrondi;if(n!==!1&&(t=this.evaluateNode(t),typeof t.nodeValue=="number"&&!Qe(t.unit)?.match(/décimales?/)))throw new F("EvaluationError",`L'unité ${Qe(t.unit)} de l'arrondi est inconnu. Vous devez utiliser l'unité “décimales”`,{dottedName:this.cache._meta.evaluationRuleStack[0]});return{...e,nodeValue:typeof r.nodeValue!="number"||!("nodeValue"in t)?r.nodeValue:typeof t.nodeValue=="number"?ms(r.nodeValue,t.nodeValue):t.nodeValue===!0?ms(r.nodeValue,0):t.nodeValue===void 0?void 0:r.nodeValue,explanation:{valeur:r,arrondi:t},missingVariables:He([r,t]),unit:r.unit}};function oa(e,r){return{explanation:{valeur:L(e.valeur,r),arrondi:L(e.arrondi,r)},nodeKind:oa.nom}}oa.nom="arrondi";$e(oa.nom,X0);function Kl(e){if(!e.unit)return e;const r=Jl(e.unit);return Rr(r,e)}function Rr(e,r){return{...r,nodeValue:r.unit&&typeof r.nodeValue=="number"?Yn(r.unit,e,r.nodeValue):r.nodeValue,unit:e}}var va=({style:e,maximumFractionDigits:r=2,minimumFractionDigits:n=0,language:t})=>a=>{const o=e==="currency"&&r>=2&&n===0&&!Number.isInteger(a)?2:n;return Intl.NumberFormat(t,{style:e,currency:"EUR",maximumFractionDigits:r,minimumFractionDigits:o}).format(a)};function e_({maximumFractionDigits:e,minimumFractionDigits:r,language:n,formatUnit:t,unit:a,nodeValue:o}){if(typeof o!="number")return o;const s=a?Qe(a,o,t):void 0;switch(s){case"€":return va({style:"currency",maximumFractionDigits:e,minimumFractionDigits:r,language:n})(o);case"%":return va({style:"percent",maximumFractionDigits:e,language:n})(o/100);default:return va({style:"decimal",minimumFractionDigits:r,maximumFractionDigits:e,language:n})(o)+(typeof s=="string"?` ${s}`:"")}}function r_(e){return e&&e[0].toUpperCase()+e.slice(1)}var n_={fr:{true:"oui",false:"non"},en:{true:"yes",false:"no"}};function t_(e,{language:r="fr",displayedUnit:n,formatUnit:t,precision:a=2}={}){let o=typeof e=="number"||typeof e>"u"||e===null?e:e.nodeValue;if(typeof o=="number"&&Number.isNaN(o))return"Erreur dans le calcul du nombre";if(o===void 0)return"Pas encore défini";if(o===null)return"Non applicable";if(typeof o=="string")return o.replace("\\n",`
`);if(typeof o=="boolean")return n_[r][o];if(typeof o=="number"){let s=typeof e=="number"||typeof e>"u"||!("unit"in e)?void 0:e.unit;if(s){const u=Kl({unit:s,nodeValue:o});s=u.unit,o=u.nodeValue}return e_({minimumFractionDigits:0,maximumFractionDigits:a,language:r,formatUnit:t,nodeValue:o,unit:n??s}).trim()}}var a_={};g0(a_,{contextNameToDottedName:()=>Ga,cyclicDependencies:()=>p_,decodeRuleName:()=>v_,disambiguateReference:()=>Yl,disambiguateReferenceNode:()=>Za,encodeRuleName:()=>d_,findCommonAncestor:()=>Zl,getChildrenRules:()=>b_,isAccessible:()=>sa,isExperimental:()=>Qa,nameLeaf:()=>Gl,ruleParent:()=>Ql,ruleParents:()=>Xn,ruleWithDedicatedDocumentationPage:()=>h_,updateReferencesMapsFromReferenceNode:()=>Gi});function wn(e,r){return e!=null&&Object.prototype.hasOwnProperty.call(e,r)}function ps(e){return function(...r){return e}}var i_="\0",fs="",$s=(e,r)=>{e[r]?e[r]++:e[r]=1},ds=(e,r)=>{--e[r]||delete e[r]},Mn=(e,r,n,t)=>{let a=""+r,o=""+n;if(!e&&a>o){const s=a;a=o,o=s}return a+fs+o+fs+(t===void 0?i_:t)},o_=(e,r,n,t)=>{let a=""+r,o=""+n;if(!e&&a>o){const u=a;a=o,o=u}const s={v:a,w:o};return t&&(s.name=t),s},ba=(e,r)=>Mn(e,r.v,r.w,r.name),s_=class{constructor(e={}){ae(this,"_nodeCount",0);ae(this,"_edgeCount",0);ae(this,"_isDirected");ae(this,"_label");ae(this,"_defaultNodeLabelFn");ae(this,"_defaultEdgeLabelFn");ae(this,"_nodes");ae(this,"_in");ae(this,"_preds");ae(this,"_out");ae(this,"_sucs");ae(this,"_edgeObjs");ae(this,"_edgeLabels");this._isDirected=wn(e,"directed")?e.directed:!0,this._label=void 0,this._defaultNodeLabelFn=ps(void 0),this._defaultEdgeLabelFn=ps(void 0),this._nodes={},this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}isDirected(){return this._isDirected}setGraph(e){return this._label=e,this}graph(){return this._label}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}setNode(e,r=void 0){return wn(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=r),this):(this._nodes[e]=arguments.length>1?r:this._defaultNodeLabelFn(e),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)}setNodes(e,r){return e.forEach(n=>{r!==void 0?this.setNode(n,r):this.setNode(n)}),this}node(e){return this._nodes[e]}hasNode(e){return wn(this._nodes,e)}successors(e){const r=this._sucs[e];if(r)return Object.keys(r)}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setEdge(e,r,n=void 0,t=void 0){e=""+e,r=""+r;const a=Mn(this._isDirected,e,r,t);if(wn(this._edgeLabels,a))return n!==void 0&&(this._edgeLabels[a]=n),this;this.setNode(e),this.setNode(r),this._edgeLabels[a]=n!==void 0?n:this._defaultEdgeLabelFn(e,r,t);const o=o_(this._isDirected,e,r,t);return e=o.v,r=o.w,Object.freeze(o),this._edgeObjs[a]=o,$s(this._preds[r],e),$s(this._sucs[e],r),this._in[r][a]=o,this._out[e][a]=o,this._edgeCount++,this}edge(e,r,n){const t=arguments.length===1?ba(this._isDirected,arguments[0]):Mn(this._isDirected,e,r,n);return this._edgeLabels[t]}hasEdge(e,r,n){const t=arguments.length===1?ba(this._isDirected,arguments[0]):Mn(this._isDirected,e,r,n);return wn(this._edgeLabels,t)}removeEdge(e,r,n){const t=arguments.length===1?ba(this._isDirected,arguments[0]):Mn(this._isDirected,e,r,n),a=this._edgeObjs[t];return a&&(e=a.v,r=a.w,delete this._edgeLabels[t],delete this._edgeObjs[t],ds(this._preds[r],e),ds(this._sucs[e],r),delete this._in[r][t],delete this._out[e][t],this._edgeCount--),this}outEdges(e,r=void 0){const n=this._out[e];if(n){const t=Object.values(n);return r===void 0?t:t.filter(function(a){return a.w===r})}}};function u_(e){let r=0;const n=[],t={},a=[];function o(s){const u=t[s]={onStack:!0,lowlink:r,index:r++};if(n.push(s),e.successors(s).forEach(function(c){Object.prototype.hasOwnProperty.call(t,c)?t[c].onStack&&(u.lowlink=Math.min(u.lowlink,t[c].index)):(o(c),u.lowlink=Math.min(u.lowlink,t[c].lowlink))}),u.lowlink===u.index){const c=[];let f;do f=n.pop(),t[f].onStack=!1,c.push(f);while(s!==f);a.push(c)}}return e.nodes().forEach(function(s){Object.prototype.hasOwnProperty.call(t,s)||o(s)}),a}function l_(e){return u_(e).filter(function(r){return r.length>1||r.length===1&&e.hasEdge(r[0],r[0])})}function c_(e){const r=new s_;return[...e.entries()].forEach(([n,t])=>{t.forEach(a=>{r.setEdge(n,a)})}),r}function m_(e,r){function*n(o){let s=o;for(;;)yield r[s++%r.length]}const t=[];for(let o=0;o<r.length;o++){const s=[];let u;for(const c of n(o))if(u===void 0)s.push(c),u=c;else if(e.get(u)?.has(c)){if(s.includes(c)){s.splice(0,s.lastIndexOf(c));break}s.push(c),u=c}t.push(s)}return t.reduce((o,s)=>s.length>o.length?o:s)}function p_(e){const{referencesMaps:r}=ht(e),n=c_(r.referencesIn),a=l_(n).map(u=>u.reverse()),o=a.map(u=>m_(r.referencesIn,u)),s=a.map((u,c)=>$_(n,u,o[c]));return[o,s]}var f_=(e,r,n)=>{for(let t=0;t<e.length+1;t++)if(r===e[t]&&n===e[(t+1)%e.length])return!0;return!1};function $_(e,r,n){const t=new Set;return r.forEach(a=>{e.outEdges(a).filter(({w:o})=>r.includes(o)).forEach(({v:o,w:s})=>{t.add(`"${o}" -> "${s}"`+(f_(n,o,s)?" [color=red]":""))})}),`digraph Cycle {
	${[...t].join(`;
	`)};
}`}var Fr=e=>e.split(" . "),Ki=e=>e.join(" . "),Gl=e=>Fr(e).slice(-1)?.[0],d_=e=>e?.replace(/\s\.\s/g,"/").replace(/-/g,"‑").replace(/\s/g,"-"),v_=e=>e.replace(/\//g," . ").replace(/-/g," ").replace(/\u2011/g,"-"),Ga=e=>e.endsWith("$SITUATION")?Ql(e):e,Ql=e=>Ki(Fr(e).slice(0,-1));function Xn(e){return Fr(e).slice(0,-1).map((r,n,t)=>Ki(t.slice(0,n+1))).reverse()}var b_=(e,r)=>Object.keys(e).filter(t=>t.startsWith(r)&&Fr(t).length===Fr(r).length+1);function Zl(e,r){const n=Fr(e),t=Fr(r),a=n.findIndex((o,s)=>t[s]!==o);return a===-1?e:Ki(n.slice(0,a))}function sa(e,r,n){if(!(n in e))throw new F("InternalError",`La règle "${n}" n'existe pas`,{dottedName:n});const t=Zl(r,n),a=[n,...Xn(n),""];return a.slice(0,Math.max(a.indexOf(t)-1,0)).every(s=>!(s in e)||e[s].private===!1)}function Qa(e,r){if(!(r in e))throw new F("InternalError",`La règle "${r}" n'existe pas`,{dottedName:r});return[r,...Xn(r)].some(t=>t in e&&e[t].rawNode?.experimental==="oui")}function ha(e,r){return e?e+" . "+r:r}function Yl(e,r="",n){const t=Xn(r);if(t.push(r),n.startsWith("^ . ")){const u=n.match(/^(\^ \. )+/)[0].length/4;n=n.replace(/^(\^ \. )+/,""),t.splice(-u)}const a=t.pop();t.unshift(a),t.push("");const o=t.find(u=>{const c=ha(u,n);return!(c in e)||c===r?!1:sa(e,r,c)});if(o!==void 0)return ha(o,n);if(r.endsWith(n))return r;const s=t.map(u=>ha(u,n));throw s.every(u=>!(u in e))?new F("SyntaxError",`La référence "${n}" est introuvable.
Vérifiez que l'orthographe et l'espace de nom sont corrects`,{dottedName:Ga(r)}):new F("SyntaxError",`La règle "${s.find(u=>u in e)}" n'est pas accessible depuis "${r}".
	Cela vient du fait qu'elle est privée ou qu'un de ses parent est privé`,{dottedName:Ga(r)})}function h_(e){return e.virtualRule!==!0&&e.type!=="groupe"&&e.type!=="texte"&&e.type!=="paragraphe"&&e.type!=="notification"}function Gi(e,r,n){e.nodeKind==="reference"&&(as(r.referencesIn,n??e.contextDottedName,e.dottedName),as(r.rulesThatUse,e.dottedName,n??e.contextDottedName))}function Za(e,r){if(e.nodeKind==="reference")return e.dottedName||(e.dottedName=Yl(r,e.contextDottedName,e.name),e.title=r[e.dottedName].title,e.acronym=r[e.dottedName].rawNode.acronyme),e}function g_(e,r,n){const t=r.privé==="oui"||e.startsWith("[privé] ");e=e.replace(/^\[privé\] /,"");const a=[n.dottedName,e].filter(Boolean).join(" . "),o=Gl(a),s=r_(r.titre??o);if(n.parsedRules[a])throw new F("EvaluationError",`La référence '${a}' a déjà été définie`,{dottedName:a});const u={};for(const p in r)Ew.includes(p)&&(u[p]=r[p]);if("formule"in r&&(u.valeur=r.formule),!t&&!a.endsWith("$SITUATION")){u["dans la situation"]=`${a} . $SITUATION`,u.avec=_r(u.avec)??{};const p=_r(Dl);p.isNullable=r["possiblement non applicable"]==="oui",u.avec["[privé] $SITUATION"]={valeur:p},u["par défaut"]!=null&&(u["par défaut"]={valeur:u["par défaut"],"variable manquante":a})}const c=n.dottedName;n.dottedName=a,n.parsedRules[a]=void 0;const f={valeur:L(u,n),parents:Xn(a).map(p=>({dottedName:p,nodeKind:"reference",contextDottedName:n.dottedName}))},m={};if(r.suggestions)for(const p in r.suggestions)m[p]=L(r.suggestions[p],n);return n.parsedRules[a]={dottedName:a,replacements:[...Mw(r["rend non applicable"],n),...fc(r.remplace,n)],title:s,private:t,suggestions:m,nodeKind:"rule",explanation:f,rawNode:r,virtualRule:t},n.dottedName=c,n.parsedRules[a]}function Xl(e,r){for(const n in e){let t=e[n];if((typeof t=="string"||typeof t=="number")&&(t={valeur:`${t}`}),typeof t!="object")throw new F("SyntaxError",`Rule ${n} is incorrectly written. Please give it a proper value.`,{dottedName:n});const a=t===null?{}:_r(t);g_(n,a,r)}}$e("rule",function(r){const{ruleDisabledByItsParent:n,nullableParent:t,parentMissingVariables:a}=ec(this,r);let o={...r.explanation.valeur,nodeValue:null,missingVariables:{}};return n||(this.cache._meta.evaluationRuleStack.filter(u=>u===r.dottedName).length>1?o={nodeValue:void 0}:(this.cache._meta.evaluationRuleStack.unshift(r.dottedName),o=this.evaluateNode(r.explanation.valeur),this.cache._meta.evaluationRuleStack.shift())),o.missingVariables??(o.missingVariables={}),__(this,r,o),{...o,missingVariables:Lr(o.missingVariables,a),...r,explanation:{parents:r.explanation.parents,valeur:o,nullableParent:t,ruleDisabledByItsParent:n}}});function __(e,r,n){r.private===!0||!sa(e.context.parsedRules,"",r.dottedName)||n.nodeValue===void 0&&!Object.keys(n.missingVariables).length&&(n.missingVariables[r.dottedName]=1)}function ec(e,r){if(r.private)return{ruleDisabledByItsParent:!1,parentMissingVariables:{}};const n=e.context.nodesTypes,t=r.explanation.parents.find(o=>n.get(o)?.isNullable||n.get(o)?.type==="boolean");if(!t)return{ruleDisabledByItsParent:!1,parentMissingVariables:{}};if(!e.cache._meta.parentRuleStack.includes(r.dottedName)){e.cache._meta.parentRuleStack.unshift(r.dottedName);let o=tr(!1);if(n.get(t)?.isNullable&&(o=e.evaluateNode({nodeKind:"est non applicable",explanation:t})),o.nodeValue!==!0&&n.get(t)?.type==="boolean"&&(o=e.evaluateNode({nodeKind:"operation",operator:"=",operationKind:"=",explanation:[t,tr(!1)]})),e.cache._meta.parentRuleStack.shift(),o.nodeValue===!0)return{ruleDisabledByItsParent:!0,parentMissingVariables:o.missingVariables??{},nullableParent:t}}let a={};if(n.get(t)?.type==="boolean"){const o=e.evaluateNode(t);return a=o.missingVariables??{},{ruleDisabledByItsParent:o.nodeValue===!1,parentMissingVariables:a,nullableParent:t}}return{ruleDisabledByItsParent:!1,parentMissingVariables:a,nullableParent:t}}function rc(e,r){return Xl(e.avec,r),L(e.valeur,r)}rc.nom="avec";var Qi=(e,r)=>e.map((n,t)=>{if(!n.plafond&&t>e.length)throw new F("SyntaxError",`La tranche n°${t} du barème n'a pas de plafond précisé. Seule la dernière tranche peut ne pas être plafonnée`,{dottedName:""});return{...n,...n.taux!==void 0?{taux:L(n.taux,r)}:{},...n.montant!==void 0?{montant:L(n.montant,r)}:{},plafond:"plafond"in n?L(n.plafond,r):{nodeValue:1/0,nodeKind:"constant",type:"number",isNullable:!1}}});function Zi({multiplicateur:e,assiette:r,parsedTranches:n}){return n.reduce(([t,a],o,s)=>{if(a)return[[...t,{...o,isAfterActive:!0}],a];const u=this.evaluateNode(o.plafond),c=t[s-1]?t[s-1].plafond:{nodeValue:0};let f=u.nodeValue===void 0||e.nodeValue===void 0?void 0:u.nodeValue*e.nodeValue;try{f=f===1/0||f===0?f:Yn($r("*",[u.unit,e.unit]),r.unit,f)}catch(_){aa(this.context.logger,`L'unité du plafond de la tranche n°${s+1}  n'est pas compatible avec celle l'assiette`,{dottedName:this.cache._meta.evaluationRuleStack[0]},_)}const m=t[s-1]?t[s-1].plafondValue:0,p=m===void 0||r.nodeValue===void 0?void 0:m>r.nodeValue,b=[u,r,e,c];if(b.some(_=>_.nodeValue===void 0))return[[...t,{...o,plafond:u,plafondValue:f,plancherValue:m,nodeValue:void 0,isActive:void 0,isAfterActive:p,missingVariables:He(b)}],!1];if(t[s-1]&&m&&f<=m)throw new F("EvaluationError",`Le plafond de la tranche n°${s+1} a une valeur inférieure à celui de la tranche précédente`,{dottedName:this.cache._meta.evaluationRuleStack[0]});const v={...o,plafond:u,plancherValue:m,plafondValue:f,isAfterActive:p,isActive:r.nodeValue>=m&&r.nodeValue<f};return[[...t,v],v.isActive]},[[],!1])[0]}function w_(e,r){return{explanation:{assiette:L(e.assiette,r),multiplicateur:e.multiplicateur?L(e.multiplicateur,r):tr(1),tranches:Qi(e.tranches,r)},nodeKind:"barème"}}function k_(e,r,n){return e.map(t=>{if(t.isAfterActive)return{...t,nodeValue:0};const a=n(t.taux),o=He([a,t]);return[r.nodeValue,a.nodeValue,t.plafondValue,t.plancherValue].some(s=>s===void 0)?{...t,taux:a,nodeValue:void 0,missingVariables:o}:{...t,taux:a,..."unit"in r&&{unit:r.unit},nodeValue:(Math.min(r.nodeValue,t.plafondValue)-t.plancherValue)*Yn(a.unit,Pr(""),a.nodeValue),missingVariables:o}})}var y_=function(e){const r=this.evaluateNode.bind(this),n=this.evaluateNode(e.explanation.assiette),t=this.evaluateNode(e.explanation.multiplicateur);if(t.nodeValue===0)throw new F("EvaluationError","Le multiplicateur ne peut pas être nul",{dottedName:this.cache._meta.evaluationRuleStack[0]});const a=k_(Zi.call(this,{parsedTranches:e.explanation.tranches,assiette:n,multiplicateur:t}),n,r),o=a.reduce((s,{nodeValue:u})=>u==null?void 0:s+u,0);return{...e,nodeValue:o,missingVariables:He([n,t,...a]),explanation:{assiette:n,multiplicateur:t,tranches:a},unit:n.unit}};$e("barème",y_);var x_=function(e){let r;const n=this.evaluateNode(e.explanation.si);let t=e.explanation.alors,a=e.explanation.sinon;if("unit"in n)throw new F("EvaluationError","La condition doit être de type booléen",{dottedName:this.cache._meta.evaluationRuleStack[0]});if(n.nodeValue===!0)t=this.evaluateNode(e.explanation.alors),t.isActive=!0,r=t;else if(n.nodeValue===!1)a=this.evaluateNode(e.explanation.sinon),r=a;else if(n.nodeValue===null)r=n;else if(n.nodeValue===void 0)a=this.evaluateNode(e.explanation.sinon),t=this.evaluateNode(e.explanation.alors),r={...n,missingVariables:He([a,t])};else throw new F("EvaluationError","La condition doit être de type booléen",{dottedName:this.cache._meta.evaluationRuleStack[0]});const o=r.unit??t.unit;return{nodeValue:r.nodeValue,missingVariables:Lr(Tl(n.missingVariables),r.missingVariables),...o!=null?{unit:o}:{},...e,explanation:{si:n,alors:t,sinon:a}}};function nc(e,r){return{explanation:{si:L(e.si,r),alors:L(e.alors,r),sinon:L(e.sinon,r)},nodeKind:"condition"}}nc.nom="condition";$e("condition",x_);function Yi(e,r){const n=Object.keys(e.contexte).map(a=>[L(a,r),L(e.contexte[a],r)]);return{explanation:{node:L(e.valeur,r),contexte:n,subEngineId:r.subEngineIncrementingNumber++},nodeKind:Yi.nom}}Yi.nom="contexte";var E_=function(e){if(this.cache._meta.currentEvaluationWithContext===e.explanation.node)return{...zr,...e};const r=Object.fromEntries(e.explanation.contexte.filter(([a,o])=>{const s=this.evaluateNode(a),u=this.evaluateNode(o);return s.nodeValue!==u.nodeValue||Qe(s.unit)!==Qe(u.unit)}).map(([a,o])=>[a.dottedName,o]));let n=this;Object.keys(r).length&&(n=this.shallowCopy().setSituation(r,{keepPreviousSituation:!0}),n.subEngineId=e.explanation.subEngineId,Object.values(r).forEach(a=>n.cache.nodes.set(a,this.evaluate(a))),this.subEngines[e.explanation.subEngineId]=n),n.cache._meta.currentEvaluationWithContext=e.explanation.node;const t=n.evaluateNode(e.explanation.node);return delete n.cache._meta.currentEvaluationWithContext,{...e,nodeValue:t.nodeValue,explanation:{...e.explanation,node:t},missingVariables:t.missingVariables,..."unit"in t&&{unit:t.unit}}};$e("contexte",E_);function tc(e){let[r,n,t]=e.split("/");return t||([r,n,t]=["01",r,n]),ac(+t,+n,+r)}var ga=e=>+e<10?`0${e}`:""+e;function ac(e,r,n){const t=new Date(+e,+r-1,+n);if(!+t||t.getDate()!==+n)throw new F("SyntaxError",`La date ${n}/${r}/${e} n'est pas valide`,{dottedName:""});return`${ga(n)}/${ga(r)}/${ga(e)}`}function Ya(e){const[r,n,t]=tc(e).split("/"),a=new Date(+t,+n-1,+r);return a.setMinutes(a.getMinutes()-a.getTimezoneOffset()),a}function j_(e){return ac(e.getFullYear(),e.getMonth()+1,e.getDate())}var M_=function(e){const r=this.evaluateNode(e.explanation.depuis),n=this.evaluateNode(e.explanation["jusqu'à"]);let t;if([r,n].some(({nodeValue:a})=>a===void 0))t=void 0;else{const[a,o]=[r.nodeValue,n.nodeValue].map(Ya);t=Math.max(0,Math.round((o.getTime()-a.getTime())/(1e3*60*60*24)))}return{...e,missingVariables:He([r,n]),nodeValue:t,explanation:{depuis:r,"jusqu'à":n}}},vs=tr(j_(new Date)),C_=(e,r)=>({explanation:{depuis:L(e.depuis??vs,r),"jusqu'à":L(e["jusqu'à"]??vs,r)},unit:Pr("jour"),nodeKind:"durée"});$e("durée",M_);function ic(e,r){return{explanation:L(e,r),nodeKind:"est non défini"}}ic.nom="est non défini";var A_=mr("est défini",{valeur:{}},{"=":[{"est non défini":"valeur"},"non"]}),I_=mr("est applicable",{valeur:{}},{"=":[{"est non applicable":"valeur"},"non"]}),S_=function(e){const r=this.evaluateNode(e.explanation);let n=!1;return r.nodeValue===void 0&&(n=!0),{...e,nodeValue:n,missingVariables:r.missingVariables,explanation:r}};$e("est non défini",S_);function oc(e,r){return{explanation:L(e,r),nodeKind:"est non applicable"}}oc.nom="est non applicable";var lt=e=>({nodeKind:"est non applicable",explanation:e}),P_=function(e){const r=e.explanation;if(this.context.nodesTypes.get(r)?.isNullable===!1&&r.nodeKind!=="rule"&&r.nodeKind!=="reference")return{...e,nodeValue:!1,missingVariables:{}};if(this.cache.nodes.has(r)&&this.cache.nodes.get(r)!==void 0)return{...e,nodeValue:this.cache.nodes.get(r)?.nodeValue===null,missingVariables:this.cache.nodes.get(r)?.missingVariables??{}};switch(r.nodeKind){case"rule":const{ruleDisabledByItsParent:t,parentMissingVariables:a}=ec(this,r);if(t)return{...e,nodeValue:!0,missingVariables:a};const o=this.evaluateNode(lt(r.explanation.valeur)),s=Lr(a,o.missingVariables);return o.nodeValue===!1&&this.context.nodesTypes.get(this.context.parsedRules[`${r.dottedName} . $SITUATION`])?.isNullable&&!Object.keys(o.missingVariables).length&&(s[r.dottedName]=1),{...e,nodeValue:o.nodeValue,missingVariables:s};case"reference":return{...this.evaluateNode(lt(this.context.parsedRules[r.dottedName])),...e};case"condition":return{...this.evaluateNode({...r,explanation:{si:r.explanation.si,alors:lt(r.explanation.alors),sinon:lt(r.explanation.sinon)}}),...e}}const n=this.evaluateNode(r);return{...e,nodeValue:n.nodeValue===void 0?void 0:n.nodeValue===null,missingVariables:n.missingVariables}};$e("est non applicable",P_);function O_(e,r){return{explanation:{assiette:L(e.assiette,r),multiplicateur:e.multiplicateur?L(e.multiplicateur,r):tr(1),tranches:Qi(e.tranches,r)},nodeKind:"grille"}}var q_=function(e){const r=this.evaluateNode.bind(this),n=this.evaluateNode(e.explanation.assiette),t=this.evaluateNode(e.explanation.multiplicateur);if(t.nodeValue===0)throw new F("EvaluationError","Le multiplicateur ne peut pas être nul",{dottedName:this.cache._meta.evaluationRuleStack[0]});const a=Zi.call(this,{parsedTranches:e.explanation.tranches,assiette:n,multiplicateur:t}).map(c=>{if(c.isActive===!1)return c;const f=r(c.montant);return{...c,montant:f,nodeValue:f.nodeValue,unit:f.unit,missingVariables:He([f,c])}});let o;const s=a.find(c=>c.isActive);s?o=[s]:a[a.length-1].isAfterActive===!1?o=[{nodeValue:!1}]:o=a.filter(c=>c.isActive===void 0);const u=o[0]?o[0].isActive===void 0?void 0:o[0].nodeValue:!1;return{...e,nodeValue:u,missingVariables:He([n,t,...o]),explanation:{...e.explanation,assiette:n,multiplicateur:t,tranches:a},unit:o[0]?.unit??void 0}};$e("grille",q_);function sc(e,r,n,t=0,a=100,o=0){let s=r,u=n,c=s,f=e(s),m=e(u),p=f,b,v,_,y,E,S;for(;a-- >0;){if(_=u-s,Math.abs(p)<Math.abs(m)&&(s=u,u=c,c=s,f=m,m=p,p=f),b=1e-15*Math.abs(u)+t/2,v=(c-u)/2,Math.abs(v)<=b||m===0)return u;if(Math.abs(_)>=b&&Math.abs(f)>Math.abs(m)){let P,H;const ne=c-u;s===c?(P=m/f,y=ne*P,E=1-P):(E=f/p,P=m/p,H=m/f,y=H*(ne*E*(E-P)-(u-s)*(P-1)),E=(E-1)*(P-1)*(H-1)),y>0?E=-E:y=-y,y<.75*ne*E-Math.abs(b*E)/2&&y<Math.abs(_*E/2)&&(v=y/E)}if(Math.abs(v)<b&&(v=v>0?b:-b),s=u,f=m,u+=v,m=e(u),(m>0&&p>0||m<0&&p<0)&&(c=s,p=f),Math.abs(m)<t)return u;Math.abs(m)<o&&(S=u)}return S}var V_=function(e){const r=this.shallowCopy();if(this.cache._meta.evaluationRuleStack.slice(1).includes(e.explanation.ruleToInverse))return{...Ut,...e};r.cache._meta.parentRuleStack=[...this.cache._meta.parentRuleStack],r.cache._meta.evaluationRuleStack=[...this.cache._meta.evaluationRuleStack];const n=e.explanation.inversionCandidates.find(S=>{if(this.cache._meta.evaluationRuleStack.includes(S.dottedName))return!1;const P=r.evaluateNode(r.context.parsedRules[`${S.dottedName} . $SITUATION`]);return typeof P.nodeValue=="number"&&!(S.dottedName in P.missingVariables)});if(n===void 0)return{...e,nodeValue:void 0,missingVariables:{...Object.fromEntries(e.explanation.inversionCandidates.map(S=>[S.dottedName,1])),[e.explanation.ruleToInverse]:1}};const t=r.evaluateNode(n);let a=0;r.setSituation({[n.dottedName]:Ut},{keepPreviousSituation:!0}),r.cache.traversedVariablesStack=this.cache.traversedVariablesStack?[]:void 0;let o;const s=S=>(a++,r.setSituation({[e.explanation.ruleToInverse]:{nodeValue:S,nodeKind:"constant",type:"number",unit:t.unit}},{keepPreviousSituation:!0}),r.cache.traversedVariablesStack=this.cache.traversedVariablesStack?[]:void 0,o=r.evaluateNode(n),o),u=t.nodeValue;let c;const f=u,p=s(f).nodeValue,b=p>u?.9:1.2,v=p!==void 0?f*u*b/p:2e3,y=s(v).nodeValue,E=this.context.inversionMaxIterations??10;if(p!==void 0||y!==void 0){const S=ke=>(ke===f?p:ke===v?y:s(ke).nodeValue)-u,ne=y!==void 0&&y<u&&(y>p||p>u)?v:p!==void 0&&p<u&&(p>y||y>u)?f:-1e6,Ie=y!==void 0&&y>u&&(y<p||p<u)?v:p!==void 0&&p>u&&(p<y||y<u)?f:1e8;c=sc(S,ne,Ie,.1,E,1)}if(c==null&&(this.cache.inversionFail=!0),this.cache.traversedVariablesStack){const S=this.cache.traversedVariablesStack[0];S&&(o.traversedVariables??[]).forEach(P=>S.add(P))}return{...e,nodeValue:c,unit:t.unit,explanation:{...e.explanation,inversionGoal:n,numberOfIteration:a},missingVariables:o.missingVariables}},R_=(e,r)=>{let n=typeof e=="object"&&"avec"in e?e.avec:e;if(e===null)throw new F("SyntaxError","Il manque les règles avec laquelle effectuer le calcul d'inversion dans le mécanisme `inversion numérique`",{dottedName:r.dottedName});return Array.isArray(n)||(n=[n]),{explanation:{ruleToInverse:r.dottedName,inversionCandidates:n.map(t=>({...L(t,r)}))},nodeKind:"inversion"}};$e("inversion",V_);var N_=Jr("le maximum de",{valeur:{type:"liste"}},({valeur:e})=>e.reduce((r,n)=>({condition:{si:{"est non applicable":"$INTERNAL valeur"},alors:"$INTERNAL acc",sinon:{condition:{si:{ou:[{"est non applicable":"$INTERNAL acc"},{">":["$INTERNAL valeur","$INTERNAL acc"]}]},alors:"$INTERNAL valeur",sinon:"$INTERNAL acc"}}},avec:{"[privé] $INTERNAL valeur":{valeur:n},"[privé] $INTERNAL acc":{valeur:r}}}),zr)),T_=Jr("le minimum de",{valeur:{type:"liste"}},({valeur:e})=>e.reduce((r,n)=>({condition:{si:{"est non applicable":"$INTERNAL valeur"},alors:"$INTERNAL acc",sinon:{condition:{si:{ou:[{"est non applicable":"$INTERNAL acc"},{"<":["$INTERNAL valeur","$INTERNAL acc"]}]},alors:"$INTERNAL valeur",sinon:"$INTERNAL acc"}}},avec:{"[privé] $INTERNAL valeur":{valeur:n},"[privé] $INTERNAL acc":{valeur:r}}}),zr));function Xa(e){return e.reverse().reduce((r,n)=>({"+":[n,r]}),zr)}var D_=Jr("somme",{valeur:{type:"liste"}},({valeur:e})=>Xa([...e])),B_=Jr("moyenne",{valeur:{type:"liste"}},({valeur:e})=>{const r=[...e];return{"/":[Xa(r),Xa(r.map(L_))]}});function L_(e){return{"applicable si":{"est applicable":e},valeur:1}}var F_=mr("non applicable si",{"non applicable si":{},valeur:{}},{condition:{si:"non applicable si = non",alors:"valeur",sinon:zr}}),U_=(e,r)=>(Array.isArray(e)&&(e={possibilités:e}),{...e,explanation:e.possibilités.map(n=>L(n,r)),context:r.dottedName,nodeKind:"une possibilité"});$e("une possibilité",e=>({...e,missingVariables:{[e.context]:1},nodeValue:void 0}));var uc={"*":[(e,r)=>e*r,"×"],"/":[(e,r)=>e/r,"∕"],"+":[(e,r)=>e+r],"-":[(e,r)=>e-r,"−"],"<":[(e,r)=>e<r],"<=":[(e,r)=>e<=r,"≤"],">":[(e,r)=>e>r],">=":[(e,r)=>e>=r,"≥"],"=":[(e,r)=>(e??!1)===(r??!1)],"!=":[(e,r)=>(e??!1)!==(r??!1),"≠"],et:[(e,r)=>(e??!1)&&(r??!1)],ou:[(e,r)=>(e??!1)||(r??!1)]},H_=(e,r)=>(n,t)=>{const a=n.map(o=>L(o,t));return{...n,nodeKind:"operation",operationKind:e,operator:r||e,explanation:a}},z_=function(e){let r=this.evaluateNode(e.explanation[0]),n={...e,missingVariables:{}};if(r.nodeValue===null&&["<",">","<=",">=","/","*","-","et"].includes(e.operationKind)||r.nodeValue===0&&["/","*"].includes(e.operationKind)||r.nodeValue===!1&&e.operationKind==="et"||r.nodeValue===!0&&e.operationKind==="ou")return{...n,nodeValue:e.operationKind==="et"?!1:r.nodeValue,missingVariables:r.missingVariables};let t=this.evaluateNode(e.explanation[1]);if(n.explanation=[r,t],e.operationKind==="/"&&t.nodeValue===0)throw new F("EvaluationError","Division by zero",{dottedName:this.cache._meta.evaluationRuleStack[0]});if(t.nodeValue===null&&["<",">","<=",">=","/","*","et"].includes(e.operationKind)||t.nodeValue===0&&["*"].includes(e.operationKind)||t.nodeValue===!1&&e.operationKind==="et"||t.nodeValue===!0&&e.operationKind==="ou")return{...n,nodeValue:e.operationKind==="et"?!1:t.nodeValue,missingVariables:t.missingVariables};n.missingVariables=He([r,t]),(r.nodeValue===void 0||t.nodeValue===void 0)&&(n={...n,nodeValue:void 0});const a=["+","-"].includes(e.operationKind)&&Qe(t.unit)==="%"&&Qe(r.unit)!=="%";if(!("nodeValue"in n)&&!["/","*"].includes(e.operationKind)&&!a)try{r.unit&&"unit"in t?t=Rr(r.unit,t):t.unit&&(r=Rr(t.unit,r))}catch(c){aa(this.context.logger,`Dans l'expression '${e.operationKind}', la partie gauche (unité: ${Qe(r.unit)}) n'est pas compatible avec la partie droite (unité: ${Qe(t.unit)})`,{dottedName:this.cache._meta.evaluationRuleStack[0]},c)}const o=uc[e.operationKind][0],s=r.nodeValue,u=t.nodeValue;if(n.nodeValue="nodeValue"in n?n.nodeValue:["<",">","<=",">=","*","/"].includes(e.operationKind)&&t.nodeValue===null?null:[s,u].every(c=>typeof c=="string"&&c.match?.(/^[\d]{2}\/[\d]{2}\/[\d]{4}$/))?o(Ya(s).getTime(),Ya(u).getTime()):o(s,u),e.operationKind==="*"&&$r("*",[r.unit,t.unit])?.numerators.includes("%")){let c=$r("*",[r.unit,t.unit]);const f=n.nodeValue;return{...n,nodeValue:typeof f=="number"?f/100:f,unit:$r("*",[c,{numerators:[],denominators:["%"]}])}}if(a){let c=$r("*",[r.unit,t.unit]);return{...n,nodeValue:typeof r.nodeValue=="number"&&typeof t.nodeValue=="number"?r.nodeValue*(1+t.nodeValue/100*(e.operationKind==="-"?-1:1)):n.nodeValue,unit:$r("*",[c,{numerators:[],denominators:["%"]}])}}return e.operationKind==="*"||e.operationKind==="/"||e.operationKind==="-"||e.operationKind==="+"?{...n,unit:$r(e.operationKind,[r.unit,t.unit])}:n};$e("operation",z_);var J_=Object.fromEntries(Object.entries(uc).map(([e,[r,n]])=>[e,H_(e,n)])),W_=J_,K_=mr("par défaut",{"par défaut":{},valeur:{}},{condition:{si:{"est non défini":"valeur"},alors:"par défaut",sinon:"valeur"}}),G_=mr("plafond",{plafond:{},valeur:{}},{condition:{si:{et:["plafond != non","valeur > plafond"]},alors:"plafond",sinon:"valeur"}}),Q_=mr("plancher",{plancher:{},valeur:{}},{condition:{si:{et:["plancher != non","valeur < plancher"]},alors:"plancher",sinon:"valeur"}});function Z_(e){return e.reduce((r,n)=>({"*":[n,r]}),tr(1))}var bs=Jr("produit",{valeur:{type:"liste"}},({valeur:e})=>({valeur:Z_([...e]),"simplifier l'unité":"oui"})),Y_=function(e){if(this.cache._meta.evaluationRuleStack.slice(1).includes(e.explanation.ruleToSolve))return{...Ut,...e};let r=0;const n=this.shallowCopy();n.cache._meta.parentRuleStack=[...this.cache._meta.parentRuleStack],n.cache._meta.evaluationRuleStack=[...this.cache._meta.evaluationRuleStack];const t=this.context.inversionMaxIterations??25,a=p=>(r++,n.setSituation({[e.explanation.ruleToSolve]:{...Ut,nodeValue:p}},{keepPreviousSituation:!0}),n.evaluateNode(e.explanation.valeur)),o=Symbol("inversion failed");let s=o;const u=1;let c=a(u);const f=c.nodeValue,m=c.unit;return f!==void 0&&(s=sc(_=>_===u?f-u:(c=a(_),c.nodeValue-_),-1e6,1e8,.5,t,2)),s===o&&(s=void 0,this.cache.inversionFail=!0),s!==void 0&&(c=a(s)),{...e,unit:m,nodeValue:s,explanation:{...e.explanation,valeur:c,numberOfIterations:r},missingVariables:c.missingVariables}};function lc(e,r){return{explanation:{ruleToSolve:r.dottedName,valeur:L(e.valeur,r)},nodeKind:"résoudre référence circulaire"}}lc.nom="résoudre la référence circulaire";$e("résoudre référence circulaire",Y_);function cc(e,r){return{explanation:L(e.valeur,r),nodeKind:"simplifier unité"}}cc.nom="simplifier l'unité";$e("simplifier unité",function(r){const n=this.evaluateNode(r.explanation),t=n.nodeValue,a={...n,...r,explanation:n};if(t==null)return a;if(!n.unit)return{...a,unit:n.unit};const o=Jl(n.unit);return{...a,nodeValue:typeof t=="number"?Yn(n.unit,o,t):t,unit:o}});var X_=mr("dans la situation",{valeur:{},"dans la situation":{}},{condition:{si:{"est non défini":"dans la situation"},alors:"valeur",sinon:"dans la situation"}});function ew(e,r){return{explanation:{assiette:L(e.assiette,r),multiplicateur:e.multiplicateur?L(e.multiplicateur,r):tr(1),tranches:Qi(e.tranches,r)},nodeKind:"taux progressif"}}var rw=function(e){const r=this.evaluateNode.bind(this),n=this.evaluateNode(e.explanation.assiette),t=this.evaluateNode(e.explanation.multiplicateur);if(t.nodeValue===0)throw new F("EvaluationError","Division by zero",{dottedName:""});const a=Zi.call(this,{parsedTranches:e.explanation.tranches,assiette:n,multiplicateur:t}),o={...e,explanation:{tranches:a,assiette:n,multiplicateur:t},unit:Pr("%")},s=a[a.length-1];if(a.every(({isActive:P})=>P===!1)||s.isActive&&s.plafond.nodeValue===1/0){const P=Rr(Pr("%"),r(s.taux)),{nodeValue:H,missingVariables:ne}=P;return s.taux=P,s.nodeValue=H,s.missingVariables=ne,{...o,nodeValue:H,missingVariables:ne}}if(a.every(({isActive:P})=>P!==!0)||typeof n.nodeValue!="number")return{...o,nodeValue:void 0,missingVariables:He(a)};const u=a.findIndex(({isActive:P})=>P===!0),c=a[u];c.taux=Rr(Pr("%"),r(c.taux));const f=a[u-1];f&&(f.taux=Rr(Pr("%"),r(f.taux)),f.isActive=!0);const m=f?f.taux:c.taux,p=[m,c.taux];if(p.some(P=>P.nodeValue===void 0))return c.nodeValue=void 0,{...o,nodeValue:void 0,missingVariables:He(p)};const b=m.nodeValue,v=c.taux.nodeValue,_=c.plancherValue,y=c.plafondValue,E=(v-b)/(y-_),S=b+(n.nodeValue-_)*E;return c.nodeValue=S,{...o,nodeValue:S,missingVariables:{}}};$e("taux progressif",rw);var Xi="texte";function ei(e,r){const n=[];let t=0;for(const{0:a,index:o}of e.matchAll(/{{(.|\n)*?}}/g)){const s=a.slice(2,-2).trim(),u=L(s,r);n.push(e.substring(t,o),u),t=(o??0)+a.length}return n.push(e.slice(t)),{nodeKind:Xi,explanation:n}}ei.nom=Xi;$e(Xi,function(r){const n=r.explanation.map(t=>typeof t=="string"?t:this.evaluateNode(t));return{...r,explanation:n,missingVariables:He(r.explanation.filter(t=>typeof t!="string")),nodeValue:n.map(t=>typeof t=="string"?t:t_(t)).join("")}});var nw=Jr("toutes ces conditions",{valeur:{type:"liste"}},({valeur:e})=>e.reduce((r,n)=>({et:[r,n]}),"oui")),tw=Jr("une de ces conditions",{valeur:{type:"liste"}},({valeur:e})=>e.reduce((r,n)=>({ou:[r,n]}),"non"));function ua(e,r){const n=L(e.valeur,r),t=Pr(e.unité,r.getUnitKey);return{explanation:n,unit:t,nodeKind:ua.nom}}ua.nom="unité";$e(ua.nom,function(r){const n=this.evaluateNode(r.explanation);let t=n.nodeValue;if(t!==null&&"unit"in r)try{t=Yn(n.unit,r.unit,n.nodeValue)}catch(a){aa(this.context.logger,"Erreur lors de la conversion d'unité explicite",{dottedName:this.cache._meta.evaluationRuleStack[0]},a)}return{...r,nodeValue:t,explanation:n,missingVariables:n.missingVariables}});function la(e,r){return{missingVariable:e["variable manquante"],nodeKind:la.nom,explanation:L(e.valeur,r)}}la.nom="variable manquante";$e(la.nom,function(r){const n=this.evaluateNode(r.explanation),t=Object.values(n.missingVariables).reduce((a,o)=>a>o?a:o,0);return{...r,nodeValue:n.nodeValue,unit:n.unit,explanation:n,missingVariables:Lr(n.missingVariables,{[r.missingVariable]:t+1})}});function aw(e,r){return{explanation:e.map(({si:t,alors:a,sinon:o})=>o!==void 0?{consequence:L(o,r),condition:tr(!0)}:{consequence:L(a,r),condition:L(t,r)}),nodeKind:"variations"}}var iw=function(e){const[r,n,t]=e.explanation.reduce(([a,o,s,u],{condition:c,consequence:f},m)=>{if(u===!0)return[a,[...o,{condition:c,consequence:f}],s,u];const p=this.evaluateNode(c),b=u===void 0?u:!u&&(p.nodeValue===void 0?void 0:p.nodeValue!==!1&&p.nodeValue!==null);if(b===!1||b===null)return[a,[...o,{condition:p,consequence:f}],s,u];let v;if(p.nodeValue!==!1&&p.nodeValue!==null&&(v=this.evaluateNode(f),s))try{v=Rr(s,v)}catch(_){aa(this.context.logger,`L'unité de la branche n° ${m+1} du mécanisme 'variations' n'est pas compatible avec celle d'une branche précédente`,{dottedName:this.cache._meta.evaluationRuleStack[0]},_)}return[b&&v?.nodeValue,[...o,{condition:p,consequence:v??f}],s||v?.unit,u||b]},[null,[],void 0,!1]);return{...e,nodeValue:r,...t!==void 0&&{unit:t},explanation:n,missingVariables:n.reduce((a,{condition:o,consequence:s})=>Lr(a,Lr(Tl(o.missingVariables),"nodeValue"in o&&o.nodeValue!==!1&&o.nodeValue!==null?s.missingVariables:{})),{})}};$e("variations",iw);var ow=Rl(w0(),1),ct=([e,,r,,n])=>({[r.value.toLowerCase()]:[e,n]}),sw=([e,,r])=>({[e]:[Zr([{value:"0"}]),r]}),hs=e=>({variable:e.value}),gs=([{value:e}])=>{console.log(e)},Zr=([{value:e}])=>({constant:{type:"number",nodeValue:parseFloat(e)}}),uw=e=>({...Zr(e),unité:e[2].value}),_s=([{value:e}])=>({constant:{type:"date",nodeValue:tc(e)}}),_a=([{value:e}])=>({constant:{type:"boolean",nodeValue:e==="oui"}}),ws=([{value:e}])=>({constant:{type:"string",nodeValue:e.slice(1,-1)}}),lw=Rl(k0(),1);function ue(e){return e[0]}var cw="(?:(?:0?[1-9]|[12][0-9]|3[01])\\/)?(?:0?[1-9]|1[012])\\/\\d{4}",mw="[a-zA-ZÀ-ſ€$%°]",pw="[a-zA-ZÀ-ſ0-9',]",ri=`${mw}(?:[-']?${pw}+)*`,fw="-?(?:[1-9][0-9]+|[0-9])(?:\\.[0-9]+)?",X=lw.default.compile({"(":"(",")":")","[":"[","]":"]",comparison:[">","<",">=","<=","=","!="],date:new RegExp(cw),boolean:["oui","non"],number:new RegExp(fw),word:new RegExp(ri),string:[/'.*'/,/".*"/],parentSelector:"^",JSONObject:/{.*}/,additionSubstraction:/[\+-]/,multiplicationDivision:["*","/"],dot:" . ",".":".",space:{match:/[\s]+/,lineBreaks:!0}}),Gr=e=>({value:e.map(r=>r&&r.value).join("")}),kn=e=>Gr(e.flat()),$w=X,dw=[{name:"main",symbols:["Comparison"],postprocess:ue},{name:"main",symbols:["NumericValue"],postprocess:ue},{name:"main",symbols:["Date"],postprocess:ue},{name:"main",symbols:["NonNumericTerminal"],postprocess:ue},{name:"main",symbols:["JSONObject"],postprocess:ue},{name:"NumericValue",symbols:["AdditionSubstraction"],postprocess:ue},{name:"NumericValue",symbols:["Negation"],postprocess:ue},{name:"NumericTerminal",symbols:["Variable"],postprocess:ue},{name:"NumericTerminal",symbols:["number"],postprocess:ue},{name:"Negation",symbols:[{literal:"-"},X.has("space")?{type:"space"}:space,"Parentheses"],postprocess:sw},{name:"Parentheses",symbols:[{literal:"("},X.has("space")?{type:"space"}:space,"NumericValue",X.has("space")?{type:"space"}:space,{literal:")"}],postprocess:([,,e])=>e},{name:"Parentheses",symbols:[{literal:"("},"NumericValue",{literal:")"}],postprocess:([,e])=>e},{name:"Parentheses",symbols:["NumericTerminal"],postprocess:ue},{name:"Date",symbols:["Variable"],postprocess:ue},{name:"Date",symbols:[X.has("date")?{type:"date"}:_s],postprocess:_s},{name:"Comparison",symbols:["Comparable",X.has("space")?{type:"space"}:space,X.has("comparison")?{type:"comparison"}:comparison,X.has("space")?{type:"space"}:space,"Comparable"],postprocess:ct},{name:"Comparison",symbols:["Date",X.has("space")?{type:"space"}:space,X.has("comparison")?{type:"comparison"}:comparison,X.has("space")?{type:"space"}:space,"Date"],postprocess:ct},{name:"Comparable$subexpression$1",symbols:["AdditionSubstraction"]},{name:"Comparable$subexpression$1",symbols:["NonNumericTerminal"]},{name:"Comparable",symbols:["Comparable$subexpression$1"],postprocess:([[e]])=>e},{name:"NonNumericTerminal",symbols:[X.has("boolean")?{type:"boolean"}:_a],postprocess:_a},{name:"NonNumericTerminal",symbols:[X.has("string")?{type:"string"}:ws],postprocess:ws},{name:"Variable",symbols:["VariableWithoutParentSelector"],postprocess:([e])=>hs(e)},{name:"Variable$ebnf$1",symbols:[]},{name:"Variable$ebnf$1$subexpression$1",symbols:[X.has("parentSelector")?{type:"parentSelector"}:parentSelector,X.has("dot")?{type:"dot"}:dot],postprocess:Gr},{name:"Variable$ebnf$1",symbols:["Variable$ebnf$1","Variable$ebnf$1$subexpression$1"],postprocess:function(r){return r[0].concat([r[1]])}},{name:"Variable",symbols:["Variable$ebnf$1","VariableWithoutParentSelector"],postprocess:e=>hs(kn(e))},{name:"VariableWithoutParentSelector$ebnf$1",symbols:[]},{name:"VariableWithoutParentSelector$ebnf$1$subexpression$1",symbols:[X.has("dot")?{type:"dot"}:dot,"Words"],postprocess:Gr},{name:"VariableWithoutParentSelector$ebnf$1",symbols:["VariableWithoutParentSelector$ebnf$1","VariableWithoutParentSelector$ebnf$1$subexpression$1"],postprocess:function(r){return r[0].concat([r[1]])}},{name:"VariableWithoutParentSelector",symbols:["Words","VariableWithoutParentSelector$ebnf$1"],postprocess:e=>kn(e)},{name:"Words$ebnf$1$subexpression$1$ebnf$1",symbols:[X.has("space")?{type:"space"}:space],postprocess:ue},{name:"Words$ebnf$1$subexpression$1$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"Words$ebnf$1$subexpression$1",symbols:["Words$ebnf$1$subexpression$1$ebnf$1","WordOrNumber"],postprocess:Gr},{name:"Words$ebnf$1",symbols:["Words$ebnf$1$subexpression$1"]},{name:"Words$ebnf$1$subexpression$2$ebnf$1",symbols:[X.has("space")?{type:"space"}:space],postprocess:ue},{name:"Words$ebnf$1$subexpression$2$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"Words$ebnf$1$subexpression$2",symbols:["Words$ebnf$1$subexpression$2$ebnf$1","WordOrNumber"],postprocess:Gr},{name:"Words$ebnf$1",symbols:["Words$ebnf$1","Words$ebnf$1$subexpression$2"],postprocess:function(r){return r[0].concat([r[1]])}},{name:"Words",symbols:["WordOrKeyword","Words$ebnf$1"],postprocess:kn},{name:"Words",symbols:[X.has("word")?{type:"word"}:ri],postprocess:ue},{name:"WordOrKeyword",symbols:[X.has("word")?{type:"word"}:ri],postprocess:ue},{name:"WordOrKeyword",symbols:[X.has("boolean")?{type:"boolean"}:_a],postprocess:ue},{name:"WordOrNumber",symbols:["WordOrKeyword"],postprocess:ue},{name:"WordOrNumber",symbols:[X.has("number")?{type:"number"}:Zr],postprocess:ue},{name:"Unit$ebnf$1",symbols:[]},{name:"Unit$ebnf$1",symbols:["Unit$ebnf$1","UnitNumerator"],postprocess:function(r){return r[0].concat([r[1]])}},{name:"Unit$ebnf$2",symbols:[]},{name:"Unit$ebnf$2",symbols:["Unit$ebnf$2","UnitDenominator"],postprocess:function(r){return r[0].concat([r[1]])}},{name:"Unit",symbols:["Unit$ebnf$1","Unit$ebnf$2"],postprocess:kn},{name:"UnitNumerator",symbols:["Words"],postprocess:ue},{name:"UnitNumerator",symbols:[{literal:"."},"UnitNumerator"],postprocess:Gr},{name:"UnitDenominator$ebnf$1",symbols:[]},{name:"UnitDenominator$ebnf$1$subexpression$1",symbols:[X.has("space")?{type:"space"}:space]},{name:"UnitDenominator$ebnf$1",symbols:["UnitDenominator$ebnf$1","UnitDenominator$ebnf$1$subexpression$1"],postprocess:function(r){return r[0].concat([r[1]])}},{name:"UnitDenominator$ebnf$2",symbols:["UnitNumerator"]},{name:"UnitDenominator$ebnf$2",symbols:["UnitDenominator$ebnf$2","UnitNumerator"],postprocess:function(r){return r[0].concat([r[1]])}},{name:"UnitDenominator",symbols:["UnitDenominator$ebnf$1",{literal:"/"},"UnitDenominator$ebnf$2"],postprocess:kn},{name:"AdditionSubstraction",symbols:["AdditionSubstraction",X.has("space")?{type:"space"}:space,X.has("additionSubstraction")?{type:"additionSubstraction"}:additionSubstraction,X.has("space")?{type:"space"}:space,"MultiplicationDivision"],postprocess:ct},{name:"AdditionSubstraction",symbols:["MultiplicationDivision"],postprocess:ue},{name:"MultiplicationDivision",symbols:["MultiplicationDivision",X.has("space")?{type:"space"}:space,X.has("multiplicationDivision")?{type:"multiplicationDivision"}:multiplicationDivision,X.has("space")?{type:"space"}:space,"Parentheses"],postprocess:ct},{name:"MultiplicationDivision",symbols:["Parentheses"],postprocess:ue},{name:"number",symbols:[X.has("number")?{type:"number"}:Zr],postprocess:Zr},{name:"number$ebnf$1$subexpression$1",symbols:[X.has("space")?{type:"space"}:space]},{name:"number$ebnf$1",symbols:["number$ebnf$1$subexpression$1"],postprocess:ue},{name:"number$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"number",symbols:[X.has("number")?{type:"number"}:Zr,"number$ebnf$1","Unit"],postprocess:uw},{name:"JSONObject",symbols:[X.has("JSONObject")?{type:"JSONObject"}:gs],postprocess:gs}],vw="main",bw={Lexer:$w,ParserRules:dw,ParserStart:vw},{Grammar:hw,Parser:gw}=ow.default,_w=hw.fromCompiled(bw),ni=new gw(_w),ww=ni.save();function kw(e,r){const n=(e+"").replace(/\s*\n\s*/g," ").trim();try{ni.restore(ww);const[t]=ni.feed(n).results;if(t==null)throw new F("InternalError",`
Un problème est survenu lors du parsing de l'expression \`${n}\` :

	le parseur Nearley n'a pas réussi à parser l'expression.
`,{dottedName:r});return t}catch(t){throw t instanceof F?t:new F("SyntaxError",`\`${n}\` n'est pas une expression valide`,{dottedName:r},t)}}function yw(e,r){if(!r.dottedName)throw new F("InternalError","Une référence ne peut pas exister en dehors d'une règle (`context.dottedName` est vide)",{dottedName:e});if(!e)throw new F("SyntaxError","Une référence ne peut pas être vide",{dottedName:r.dottedName});return{nodeKind:"reference",name:e,contextDottedName:r.dottedName}}$e("reference",function(r){if(!r.dottedName)throw new ta(r);const n=this.evaluateNode(this.context.parsedRules[r.dottedName]);return delete n.sourceMap,{...n,...r}});function L(e,r){if(e==null)throw new F("SyntaxError",`
	Une des valeurs de la formule est vide.
	Vérifiez que tous les champs à droite des deux points sont remplis`,{dottedName:r.dottedName});if(typeof e=="boolean")throw new F("SyntaxError",`
Les valeurs booléennes true / false ne sont acceptées.
Utilisez leur contrepartie française : 'oui' / 'non'`,{dottedName:r.dottedName});const n=typeof e=="object"?e:kw(e,r.dottedName);return"nodeKind"in n?n:{...xw(n,r),rawNode:e}}function ks(e,r){if(Array.isArray(e))throw new F("SyntaxError",`
Il manque le nom du mécanisme pour le tableau : [${e.map(s=>`'${s}'`).join(", ")}]
Les mécanisme possibles sont : 'somme', 'le maximum de', 'le minimum de', 'toutes ces conditions', 'une de ces conditions'.
		`,{dottedName:r.dottedName});const n=Object.keys(e);if(n.length>1)throw new F("SyntaxError",`
Les mécanismes suivants se situent au même niveau : ${n.map(s=>`'${s}'`).join(", ")}
Cela vient probablement d'une erreur dans l'indentation
	`,{dottedName:r.dottedName});if(n.length===0)return{nodeKind:"constant",nodeValue:void 0};const t=n[0],a=e[t],o=pc[t];if(!o)throw new F("SyntaxError",`Le mécanisme "${t}" est inconnu.

Vérifiez qu'il n'y ait pas d'erreur dans l'orthographe du nom.`,{dottedName:r.dottedName});try{return o(a,r)}catch(s){throw s instanceof F?s:new F("SyntaxError",t?`➡️ Dans le mécanisme ${t}
${s.message}`:s.message,{dottedName:r.dottedName})}}var mc=[Yi,la,rc,J0,F_,oa,ua,cc,Q_,G_,K_,X_,lc,z0];function xw(e,r){const n=mc.find(o=>o.nom in e);if(!n)return ks(e,r);const{[n.nom]:t,...a}=e;return ks({[n.nom]:{valeur:a,[n.nom]:t}},r)}var pc={...W_,...mc.reduce((e,r)=>({[r.nom]:r,...e}),{}),"inversion numérique":R_,"le maximum de":N_,"le minimum de":T_,"taux progressif":ew,"toutes ces conditions":nw,"est non défini":ic,"est non applicable":oc,"est applicable":I_,"est défini":A_,"une de ces conditions":tw,"une possibilité":U_,condition:nc,barème:w_,durée:C_,grille:O_,multiplication:bs,produit:bs,somme:D_,moyenne:B_,[ei.nom]:ei,valeur:L,variable:yw,variations:aw,constant:e=>({type:e.type,fullPrecision:!0,isNullable:e.nodeValue==null,missingVariables:{},nodeValue:e.nodeValue,nodeKind:"constant"})},Ew=Object.keys(pc),jw=0,mt={};function fc(e,r){return e?(Array.isArray(e)?e:[e]).map(n=>{typeof n=="string"&&(n={"références à":n});const t=L(n["références à"],r),[a,o]=[n.dans??[],n["sauf dans"]??[]].map(s=>Array.isArray(s)?s:[s]).map(s=>s.map(u=>L(u,r)));if(n.priorité!=null&&(typeof n.priorité!="number"||n.priorité<0))throw new F("SyntaxError","La priorité du remplacement doit être un nombre positif",r);return{nodeKind:"replacementRule",rawNode:n,priority:n.priorité,definitionRule:L(r.dottedName,r),replacedReference:t,replaceByNonApplicable:!1,whiteListedNames:a,blackListedNames:o,remplacementRuleId:jw++}}):[]}function Mw(e,r){const n=fc(e,r);return n.forEach(t=>t.replaceByNonApplicable=!0),n}function Cw(e){const r={};for(const n in e){const t=e[n];for(const a of t.replacements){if(!a.replacedReference.dottedName)throw new ta(a);const o=a.replacedReference.dottedName;r[o]=[...r[o]??[],a]}}return r}function Aw({newRules:e,previousReplacements:r,parsedRules:n,referencesMaps:t}){const a=Cw(e),o=new Set([]);for(const m in a){const p=t.rulesThatUse.get(m)??[];for(const b of p)o.add(b)}const s=new Set(Object.keys(e).filter(m=>[...t.referencesIn.get(m)??new Set].some(p=>(r[p]??[]).length))),u=x0(r,a);if(!s.size&&!o.size)return[n,u];const c=ys(r,t),f=ys(a,t);return s.forEach(m=>{n[m]=c(n[m])}),o.forEach(m=>{n[m]=f(n[m])}),[n,u]}function ys(e,r){return Ft((n,t)=>{if(n.nodeKind==="replacementRule"||n.nodeKind==="inversion"||n.nodeKind==="une possibilité")return!1;if(n.nodeKind==="contexte")return{...n,explanation:{...n.explanation,node:t(n.explanation.node),contexte:n.explanation.contexte.map(([a,o])=>[a,t(o)])}};if(n.nodeKind==="reference"){if(!n.dottedName)throw new ta(n);const a=Iw(n,e[n.dottedName]??[]);return Nl(o=>(Gi(o,r,n.contextDottedName),"continue"))(a),a}})}function Iw(e,r){const n=r.filter(({definitionRule:o})=>o.dottedName!==e.contextDottedName).filter(({whiteListedNames:o})=>!o.length||o.some(s=>e.contextDottedName.startsWith(s.dottedName))).filter(({blackListedNames:o})=>!o.length||o.every(s=>!e.contextDottedName.startsWith(s.dottedName))).reverse().sort((o,s)=>{const u=(s.priority??0)-(o.priority??0);return u!==0?u:s.definitionRule.dottedName.localeCompare(o.definitionRule.dottedName)});if(!n.length)return e;const t=n.map(o=>o.remplacementRuleId).join("-");if(mt[t])return mt[t];const a={nodeKind:"variations",explanation:[...n.map(({definitionRule:o,replaceByNonApplicable:s})=>s?{condition:o,consequence:zr}:{condition:Sw(o),consequence:o}),{condition:$c,consequence:e}]};return a.sourceMap={mecanismName:"replacement",args:{applicableReplacements:n,originalNode:e}},mt[t]=a,mt[t]}function Sw(e){return{nodeKind:"condition",explanation:{si:{nodeKind:"est non applicable",explanation:e},alors:Pw,sinon:$c}}}var $c=tr(!0),Pw=tr(!1);function Un(e){return{dottedName:"",logger:console,getUnitKey:r=>r,parsedRules:{},referencesMaps:{referencesIn:new Map,rulesThatUse:new Map},nodesTypes:new WeakMap,rulesReplacements:{},allowOrphanRules:!1,subEngineIncrementingNumber:1,...e}}function wa(e){return{...e,parsedRules:{...e.parsedRules},referencesMaps:{referencesIn:new Map(e.referencesMaps.referencesIn),rulesThatUse:new Map(e.referencesMaps.rulesThatUse)}}}function ht(e,r=Un({})){if(typeof e=="string")throw new F("EngineError","Publicodes does not parse yaml rule sets itself anymore. Please provide a parsed js object. E.g. the `eemeli/yaml` package.",{});let n=_r(e);const t=Un(r);let a=t.parsedRules;t.parsedRules={},Xl(n,t);let o={};for(const m in a)o[m]=a[m];for(const m in t.parsedRules)o[m]=t.parsedRules[m];let[s,u]=Ow(o,t.parsedRules,t.referencesMaps,t.allowOrphanRules),c;[o,c]=Aw({parsedRules:o,newRules:s,referencesMaps:u,previousReplacements:t.rulesReplacements});const f=U0(Object.keys(s),o,t.nodesTypes);return{parsedRules:o,nodesTypes:f,referencesMaps:u,rulesReplacements:c}}function Ow(e,r,n,t){const a=Ft(u=>Za(u,e)),o=Ft(u=>{const c=Za(u,e);return c&&Gi(c,n),c});return[E0(u=>{if(u.nodeKind==="replacementRule")return a(u);if(u.nodeKind==="rule"){const c=u.explanation.parents.find(f=>!(f.dottedName in e));if(!t&&c)throw new F("SyntaxError",`La règle parente "${c.dottedName}" n'existe pas`,{dottedName:u.dottedName})}return o(u)},r),n]}function qw(e,r,n,t,a){if(e!==void 0){if(n!==void 0){n.traversedVariables?.forEach(o=>e[0]?.add(o));return}a&&e.unshift(new Set),r.nodeKind==="reference"&&r.dottedName&&r.dottedName in t&&e[0].add(r.dottedName)}}function Vw(e,r){return!!e&&(e.length===0||r.nodeKind==="rule")}function Rw(e,r,n){e!==void 0&&n&&(r.traversedVariables=Array.from(e.shift()??[]),e.length>0&&r.traversedVariables.forEach(t=>{e[0].add(t)}))}var pt=()=>({_meta:{evaluationRuleStack:[],parentRuleStack:[]},traversedVariablesStack:void 0,nodes:new Map}),Nw=class dc{constructor(r={},n={}){ae(this,"baseContext");ae(this,"context");ae(this,"publicParsedRules");ae(this,"cache",pt());ae(this,"subEngines",[]);ae(this,"subEngineId");ae(this,"checkExperimentalRule",Nl(r=>(r.nodeKind==="reference"&&Qa(this.context.parsedRules,r.dottedName)&&ts(this.baseContext.logger,r.dottedName),"continue")));const t={dottedName:"",...n};this.baseContext=Un({...t,...ht(r,t)}),this.context=this.baseContext,this.publicParsedRules={};for(const a in this.baseContext.parsedRules){const o=this.baseContext.parsedRules[a];!o.private&&sa(this.baseContext.parsedRules,"",a)&&(this.publicParsedRules[a]=o)}}resetCache(){this.cache=pt()}setSituation(r={},n={}){this.resetCache();const t=n.keepPreviousSituation??!1;Object.keys(r).forEach(s=>{if(!(s in this.baseContext.parsedRules))throw new F("EvaluationError",`Erreur lors de la mise à jour de la situation : ${s} n'existe pas dans la base de règle.`,{dottedName:s});if(this.baseContext.parsedRules[s].private)throw new F("EvaluationError",`Erreur lors de la mise à jour de la situation : ${s} est une règle privée (il n'est pas possible de modifier une règle privée).`,{dottedName:s})});const a=Object.fromEntries(Object.entries(r).map(([s,u])=>[`[privé] ${s} . $SITUATION`,u&&typeof u=="object"&&"nodeKind"in u?{valeur:u}:u])),o=wa(this.baseContext);try{this.context={...this.baseContext,...ht(a,t?this.context:this.baseContext)}}catch(s){throw this.baseContext=o,s}return this.baseContext=o,Object.keys(r).forEach(s=>{Qa(this.context.parsedRules,s)&&ts(this.baseContext.logger,s),this.checkExperimentalRule(this.context.parsedRules[`${s} . $SITUATION`])}),this}inversionFail(){return!!this.cache.inversionFail}getRule(r){if(!(r in this.baseContext.parsedRules))throw new F("UnknownRule",`La règle '${r}' n'existe pas`,{dottedName:r});if(!(r in this.publicParsedRules))throw new F("PrivateRule",`La règle ${r} est une règle privée.`,{dottedName:r});return this.publicParsedRules[r]}getParsedRules(){return this.publicParsedRules}evaluate(r){const n=this.cache.nodes.get(r);if(n)return n;this.context=Object.assign(this.context,ht({"[privé] $EVALUATION":r&&typeof r=="object"&&"nodeKind"in r?{valeur:r}:r},this.context)),this.checkExperimentalRule(this.context.parsedRules.$EVALUATION),this.cache._meta=pt()._meta;const t=this.evaluateNode(this.context.parsedRules.$EVALUATION.explanation.valeur);return this.cache.nodes.set(r,t),t}evaluateNode(r){const n=this.cache.nodes.get(r);let t=!1;if(this.cache.traversedVariablesStack&&(t=Vw(this.cache.traversedVariablesStack,r),qw(this.cache.traversedVariablesStack,r,n,this.publicParsedRules,t)),n!==void 0)return n;if(!On[r.nodeKind])throw new F("EvaluationError",`Unknown "nodeKind": ${r.nodeKind}`,{dottedName:""});const a=On[r.nodeKind].call(this,r);return this.cache.traversedVariablesStack&&Rw(this.cache.traversedVariablesStack,a,t),this.cache.nodes.set(r,a),a}shallowCopy(){const r=new dc;return r.baseContext=wa(this.baseContext),r.context=wa(this.context),r.publicParsedRules=this.publicParsedRules,r.cache={...pt(),nodes:new Map(this.cache.nodes)},r}};class Tw extends Nw{constructor(n,t){super(n);ae(this,"elmApp");ae(this,"situation");this.elmApp=t,this.situation={}}getSituation(){return this.situation}setSituation(n,t){const a=super.setSituation(n,t);return this.situation=n,this.elmApp.ports.situationUpdated.send(null),a}evaluateAll(n){const t=n.map(a=>{const o=super.evaluate(a);return[a,{nodeValue:o.nodeValue??null,isNullable:o.nodeValue===null,missingVariables:Object.keys(o.missingVariables)}]});return this.elmApp.ports.evaluatedRules.send(t),t}}const Dw={titre:"Alimentation",icônes:"🍽️",formule:{somme:["repas","petits déjeuners","boissons","ecocups","déchets","artistes"]},unité:"kgCO2e",description:`C'est l'un des postes d'émissions les plus importants : l'impact des repas carnés est particulièrement important, 
privilégiez une **proposition végétarienne** pour vos repas.
Cette catégorie inclut également l'impact des **déchets** générés par la restauration du festival.
`,note:`A ajouter dans une V2 ?
  - Part de nourriture bio sur l'ensemble des repas
  - Part de nourriture de saison sur l'ensemble des repas
  - Part de nourriture locale sur l'ensemble des repas
  - Prise en compte du gaspillage ?
`},Bw={titre:"Communication",icônes:"📢",description:`Ce poste d'émission inclut l'impact de liée à la communication du festival, incluant le textile, le merchandising, les supports numériques et les impressions.
Pour le moment, seuls les impacts du **textile pour les équipes** et le **merchandising** sont pris en compte.
`,formule:{somme:["merchandising","textile bénévoles","numérique","impressions"]},unité:"kgCO2e"},Lw={titre:"Informations",icônes:"ℹ️",description:`Pour calculer l'empreinte carbone de votre festival, nous avons besoin de quelques informations sur celui-ci.
Renseignez la **durée** de l'évènement, le total des **entrées** journalières, le nombre d'**organisateurs et bénévoles**, le nombre de **scènes**.

*Essayez également d'estimer le nombre d'**artistes (équipe incluse)** par mode de transport.*
`},Fw={titre:"Infrastructures",icônes:"🏗️",description:`Ce poste d'émission inclut l'impact des **bâtiments** et de la **scénographie** du festival. 
Pour le moment, il est possible de paramétrer seulement les **dépenses** liées à la location du matériel.
`,formule:{somme:["bâtiments","scénographie","toilettes"]},unité:"kgCO2e"},Uw={titre:"Résultats"},Hw={titre:"Transport",icônes:"🚗",formule:{somme:["public","artistes"]},description:`Le transport des festivaliers et des artistes est **LE** poste important du bilan carbone d'un festival. 
Estimez les distances parcourues par les festivaliers et les artistes pour venir au festival et les modes de transport utilisés.

*L'**avion** est de loin le mode de transport le plus émetteur de CO2e, mais la **voiture** n'est pas en reste. Encouragez le train ou le covoiturage pour vos déplacements.*
`,unité:"kgCO2e"},zw=null,Jw=null,eo={alimentation:Dw,"alimentation . artistes":{titre:"Alimentation des artistes",formule:{somme:["repas","petits déjeuners","eau en bouteille"]},note:`Par défaut, on considère que les artistes consomment un repas sur place, un petit déjeuner s'ils sont hébergés.
`},"alimentation . artistes . repas":{valeur:"alimentation . repas",contexte:{"informations . nombre de repas total":"informations . nombre artistes * 1 repas","alimentation . repas . proposition":"alimentation . artistes . repas . type"}},"alimentation . artistes . repas . type":{titre:"Régime alimentaire des artistes",question:"Quelle type de régime alimentaire prévoyez-vous pour les artistes ?",formule:{"une possibilité":{"choix obligatoire":"oui",possibilités:["végétalien","végétarien","mixte végé viande","viande uniquement"]}},"par défaut":"'mixte végé viande'"},"alimentation . artistes . repas . type . végétalien":{titre:"Uniquement végan"},"alimentation . artistes . repas . type . végétarien":{titre:"Uniquement végétarien"},"alimentation . artistes . repas . type . mixte végé viande":{titre:"Mixte végétarien / viande"},"alimentation . artistes . repas . type . viande uniquement":{titre:"Uniquement carné"},"alimentation . artistes . petits déjeuners":{"applicable si":"hébergement . artistes présent",valeur:"alimentation . petits déjeuners",contexte:{"alimentation . petits déjeuners . nombre":"informations . nombre artistes * 1 repas"}},"alimentation . artistes . eau en bouteille":{"applicable si":"eau en bouteille présent",formule:"quantité * nosgestesclimat . alimentation . boisson . eau en bouteille . empreinte",note:`On fait l'hypothèse que les artistes consomment de l'eau en bouteille.
Si eau en bouteille: 0.27 kgCO2e/l
`},"alimentation . artistes . eau en bouteille présent":{titre:"Eau en bouteille pour les artistes",question:"Allez-vous prévoir de l'eau en bouteille pour les artistes ?","par défaut":"oui"},"alimentation . artistes . eau en bouteille . quantité":{formule:"0.5 l * informations . nombre artistes"},"nosgestesclimat . alimentation . boisson . tasse de café":{titre:"Empreinte d'une tasse de café",formule:"empreinte café moulu * quantité café par tasse",unité:"kgCO2e/tasse",description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . boisson . tasse de café . empreinte café moulu":{formule:10.09,unité:"kgCO2e/kg",note:"Facteur d'émission issu d'[Agibalyse, café moulu](https://agribalyse.ademe.fr/app/aliments/18003#Caf%C3%A9,_moulu).",description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . boisson . tasse de café . quantité café par tasse":{formule:.012,unité:"kg/tasse",note:"on fait l'hypothèse qu'une tasse de café contient en moyenne 12 grammes de café moulu.",description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . boisson . tasse de thé":{titre:"Empreinte d'une tasse de thé",formule:"empreinte thé infusé sans consommation * quantité thé par tasse",unité:"kgCO2e/tasse",description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . boisson . tasse de thé . empreinte thé infusé sans consommation":{formule:"empreinte thé infusé * (1 - part consommation empreinte thé infusé)",unité:"kgCO2e/kg",note:`Pour l'empreinte d'une tasse de café ou chocolat chaud, la part liée à la consommation (chauffage de l'eau notamment) n'est pas prise en compte dans le facteur d'émission
ce qui n'est pas le cas du facteur d'émission du thé issu d'Agribalyse. Si la boisson est bue à domicile, la consommation est déjà incluse dans la facture électrique du logement.
En revanche, si elle est prise dans un café, l'empreinte de la consommation doit être ajoutée.
Nous faisons le choix de ne pas inclure la consommation dans les boissons chaudes
(la part liée à la consommation étant négligeable pour le café et chocolat chaud devant les grains de café ou le cacao)
`,description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . boisson . tasse de thé . quantité thé par tasse":{formule:.25,unité:"kg/tasse",note:"On fait l'hypothèse qu'une tasse de thé fait en moyenne 250 grammes.",description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . boisson . tasse de thé . empreinte thé infusé":{formule:.04,unité:"kgCO2e/kg",note:"Facteur d'émission issu d'[Agibalyse, thé infusé non sucré](https://agribalyse.ademe.fr/app/aliments/18020#Th%C3%A9_infus%C3%A9,_non_sucr%C3%A9).",description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . boisson . tasse de thé . part consommation empreinte thé infusé":{formule:"25%",note:`Selon la décomposition issu d'[Agibalyse, thé infusé non sucré](https://agribalyse.ademe.fr/app/aliments/18020#Th%C3%A9_infus%C3%A9,_non_sucr%C3%A9),
la part de consommation dans le facteur d'émission du thé représente 25%.
`,description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . boisson . sucrées . facteur":{formule:{moyenne:["facteur sodas","facteur jus de fruits"]},note:"Cette valeur est bien sûr très approximative.",description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . boisson . sucrées . facteur sodas":{formule:.51,unité:"kgCO2e/l",note:"Facteur d'émission issu d'[Agribalyse, Cola, sucré](https://agribalyse.ademe.fr/app/aliments/18037#Cola,_sucr%C3%A9,_avec_%C3%A9dulcorants), 0.51 kgCO2e/kg. On considère que la masse volumique est de 1kg/l.",description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . boisson . sucrées . facteur jus de fruits":{formule:.91,unité:"kgCO2e/l",note:"Facteur d'émission issu d'[Agribalyse, Jus multifruit, pur jus, standard](https://agribalyse.ademe.fr/app/aliments/2069#Jus_multifruit,_%C3%A0_base_de_concentr%C3%A9,_standard), 0.91 kgCO2e/kg. On considère que la masse volumique est de 1kg/l.",description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . boisson . alcool . facteur":{formule:{moyenne:["facteur bière","facteur vin","facteur cocktail"]},note:"Le vin n'a pas la même empreinte que la bière au litre, c'est une grosse simplification.",description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . boisson . alcool . facteur bière":{formule:1.12,unité:"kgCO2e/l",note:"Facteur d'émission issu d'[Agribalyse, bière coeur de marché](https://agribalyse.ademe.fr/app/aliments/5001#Bi%C3%A8re_%22coeur_de_march%C3%A9%22_(4-5%C2%B0_alcool)), 1.12 kgCO2e/kg. On considère que la masse volumique de la bière est de 1kg/l.",description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . boisson . alcool . facteur vin":{formule:1.22,unité:"kgCO2e/l",note:"Facteur d'émission issu d'[Agribalyse, vin blanc sec](https://agribalyse.ademe.fr/app/aliments/5215#Vin_blanc_sec), 1.22 kgCO2e/kg. On considère que la masse volumique du vin est de 1kg/l.",description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . boisson . alcool . facteur cocktail":{formule:.91,unité:"kgCO2e/l",note:"Facteur d'émission issu d'[Agribalyse, cocktail base rhum](https://agribalyse.ademe.fr/app/aliments/1012#Cocktail_%C3%A0_base_de_rhum), 0.91 kgCO2e/kg. On considère que la masse volumique d'un cocktail est de 1kg/l.",description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . boisson . eau en bouteille . empreinte":{formule:.27,unité:"kgCO2e/l",note:"Facteur d'émission issu d'[Agibalyse, eau embouteillée de source](https://agribalyse.ademe.fr/app/aliments/18430#Eau_embouteillée_de_source).",description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"alimentation . boissons":{titre:"Boissons",formule:{somme:["froide","chaude"]}},"alimentation . boissons . froide":{formule:{somme:["eau","eau en bouteille bénévoles","soft","alcool"]},note:"On fait l'hypothèse que les boissons ne sont pas servies en bouteilles individuelles."},"alimentation . boissons . froide . eau":{formule:"quantité * empreinte",note:"On fait l'hypothèse de fontaine à eau."},"alimentation . boissons . froide . eau . quantité":{formule:"quantité par jour * informations . nombre de jours"},"alimentation . boissons . froide . eau . quantité par jour":{formule:"0.5 l * informations . nombre de personnes par jour"},"alimentation . boissons . froide . eau . empreinte":{formule:62e-5,unité:"kgCO2e/l",note:`Facteur d'émission issu de la base empreinte "Eau potable, mix de provenances".
Si eau en bouteille: 0.27 kgCO2e/l
`},"alimentation . boissons . froide . eau en bouteille bénévoles":{"applicable si":"eau en bouteille bénévoles présent",formule:"quantité * nosgestesclimat . alimentation . boisson . eau en bouteille . empreinte"},"alimentation . boissons . froide . eau en bouteille bénévoles présent":{titre:"Eau en bouteille pour les équipes",question:"Allez-vous prévoir de l'eau en bouteille pour les équipes ?","par défaut":"oui"},"alimentation . boissons . froide . eau en bouteille bénévoles . quantité":{formule:"quantité par jour * informations . nombre de jours"},"alimentation . boissons . froide . eau en bouteille bénévoles . quantité par jour":{formule:"0.5 l/jour * informations . nombre de bénévoles"},"alimentation . boissons . froide . soft":{formule:"quantité * nosgestesclimat . alimentation . boisson . sucrées . facteur",note:`A priori, le facteur d'émission d'agribalyse considère bien une part d'emballage qui correspond à la bouteille. 
On suppose que ce sont des grands formats.
`},"alimentation . boissons . froide . soft . quantité":{formule:"quantité par jour * informations . nombre de jours"},"alimentation . boissons . froide . soft . quantité par jour":{formule:"quantité par jour et par personne * informations . nombre de personnes par jour"},"alimentation . boissons . froide . soft . quantité par jour et par personne":{titre:'Quantité de boissons "soft" par personne et par jour',question:'Quelle quantité de boissons "soft" est consommée par personne et par jour ?',plancher:0,"par défaut":.5,unité:"l"},"alimentation . boissons . froide . alcool":{formule:"quantité * nosgestesclimat . alimentation . boisson . alcool . facteur",note:`On considère ici une moyenne de plusieurs types d'alcool dont le facteur d'émission est néanmoins très proche.
On pourrait imaginer séparer la bière du reste ouo considérer seulement la bière.
`},"alimentation . boissons . froide . alcool . quantité":{formule:"quantité par jour * informations . nombre de jours"},"alimentation . boissons . froide . alcool . quantité par jour":{formule:"quantité par jour et par personne * informations . nombre de personnes par jour"},"alimentation . boissons . froide . alcool . quantité par jour et par personne":{titre:"Quantité d'alcool par personne et par jour",question:"Quelle quantité d'alcool est consommée par personne et par jour ?",plancher:0,"par défaut":.5,unité:"l"},"alimentation . boissons . chaude":{formule:{somme:["café","thé"]}},"alimentation . boissons . chaude . café":{formule:"nombre * nosgestesclimat . alimentation . boisson . tasse de café"},"alimentation . boissons . chaude . café . nombre":{formule:"nombre par jour * informations . nombre de jours"},"alimentation . boissons . chaude . café . nombre par jour":{formule:"quantité par jour et par personne * informations . nombre de personnes par jour",note:"On fait l'hypothèse qu'en moyenne, la consommation sera de 1 café par personne et par jour."},"alimentation . boissons . chaude . café . quantité par jour et par personne":{titre:"Tasses de café par personne et par jour",question:"Quelle quantité de café est consommée par personne et par jour ?",plancher:0,"par défaut":1,unité:"tasse"},"alimentation . boissons . chaude . thé":{formule:"nombre * nosgestesclimat . alimentation . boisson . tasse de thé"},"alimentation . boissons . chaude . thé . nombre":{formule:"nombre par jour * informations . nombre de jours"},"alimentation . boissons . chaude . thé . nombre par jour":{formule:"quantité par jour et par personne * informations . nombre de personnes par jour",note:"On fait l'hypothèse qu'en moyenne, la consommation sera de 1 thé pour 10 personnes par jour."},"alimentation . boissons . chaude . thé . quantité par jour et par personne":{titre:"Tasses de thé par personne et par jour",question:"Quelle quantité de thé est consommée par personne et par jour ?",plancher:0,"par défaut":"10% * 1 tasse",unité:"tasse"},"alimentation . déchets":{formule:{somme:["gobelets * surplus","couverts * surplus","assiettes * surplus"]},unité:"kgCO2e",note:`Derrière la production des déchets, se cache ici une production et non seulement la comptabilité de l'empreinte de la fin de vie des déchets 
finalement assez dérisoire. On a donc ici ce que contiendront les poubelles et qui sont des éléments directement issus du festival
(vaisselle en cartons, papier).
`},"alimentation . déchets . surplus":{formule:"110%",note:`L'objectif ici est d'avoir une idée de l'impact du reste des déchets du festival en aplicant un facteur correctif (défini arbitrairement)
qui a l'avantage de tenir compte des pratiques du festival.
`},"alimentation . déchets . recyclage":{titre:"Mise en place du tri sélectif",question:"Allez-vous mettre en place un tri sélectif et un recyclage des déchets ?","par défaut":"non"},"alimentation . déchets . gobelets":{"non applicable si":"ecocups présent",formule:"2 gobelet * informations . nombre de jours * informations . nombre de personnes par jour * empreinte",unité:"kgCO2e",note:"On considère 2 gobelets par personne par jour."},"alimentation . déchets . gobelets . empreinte":{formule:{variations:[{si:'gobelets . type = "plastique"',alors:"type . plastique . poids * empreinte plastique par kg"},{si:'gobelets . type = "carton"',alors:"type . carton . poids * empreinte carton par kg"}]},unité:"kgCO2e/gobelet"},"alimentation . déchets . gobelets . type":{titre:"Type de gobelets",question:"Quel type de gobelets allez-vous utiliser ?",formule:{"une possibilité":{"choix obligatoire":"oui",possibilités:["plastique","carton"]}},"par défaut":"'plastique'"},"alimentation . déchets . gobelets . type . plastique":{titre:"Plastique jetable"},"alimentation . déchets . gobelets . type . plastique . poids":{formule:.01,unité:"kg/gobelet"},"alimentation . déchets . gobelets . type . carton":null,"alimentation . déchets . gobelets . type . carton . poids":{formule:.01,unité:"kg/gobelet",note:"On considère 10g par gobelet."},"alimentation . déchets . couverts":{formule:"2 couvert/repas * informations . nombre de jours * informations . nombre de repas par jour * empreinte",unité:"kgCO2e"},"alimentation . déchets . couverts . empreinte":{formule:{variations:[{si:'couverts . type = "plastique"',alors:"type . plastique . poids * empreinte plastique par kg"},{si:'couverts . type = "bois"',alors:"type . bois . poids * empreinte bois par kg"}]},unité:"kgCO2e/couvert"},"alimentation . déchets . couverts . type":{titre:"Type de couverts",question:"Quel type de couverts allez-vous utiliser ?",formule:{"une possibilité":{"choix obligatoire":"oui",possibilités:["plastique","bois"]}},"par défaut":"'plastique'"},"alimentation . déchets . couverts . type . plastique":{titre:"Plastique jetable"},"alimentation . déchets . couverts . type . plastique . poids":{formule:.002,unité:"kg/couvert"},"alimentation . déchets . couverts . type . bois":null,"alimentation . déchets . couverts . type . bois . poids":{formule:.002,unité:"kg/couvert",note:"On considère 2g par couvert."},"alimentation . déchets . assiettes":{formule:"1 assiette/repas * informations . nombre de jours * informations . nombre de repas par jour * empreinte",unité:"kgCO2e"},"alimentation . déchets . assiettes . empreinte":{formule:{variations:[{si:'assiettes . type = "plastique"',alors:"type . plastique . poids * empreinte plastique par kg"},{si:'assiettes . type = "carton"',alors:"type . carton . poids * empreinte carton par kg"}]},unité:"kgCO2e/assiette"},"alimentation . déchets . assiettes . type":{titre:"Type d'assiettes",question:"Quel type de gobelets allez-vous utiliser ?",formule:{"une possibilité":{"choix obligatoire":"oui",possibilités:["plastique","carton"]}},"par défaut":"'plastique'"},"alimentation . déchets . assiettes . type . plastique":{titre:"Plastique jetable"},"alimentation . déchets . assiettes . type . plastique . poids":{formule:.005,unité:"kg/assiette"},"alimentation . déchets . assiettes . type . carton":null,"alimentation . déchets . assiettes . type . carton . poids":{formule:.005,unité:"kg/assiette",note:"On considère 10g par assiette."},"alimentation . déchets . empreinte plastique par kg":{formule:"fabrication + fin de vie",unité:"kgCO2e/kg",note:`On considère du platisque polypropylène (PP) neuf et l'impact fin de vie.
`},"alimentation . déchets . empreinte plastique par kg . fabrication":{formule:2,unité:"kgCO2e/kg",note:`On considère du platisque polypropylène (PP) neuf.
FE issus de la base empreinte (PP - polypropylène)
`},"alimentation . déchets . empreinte plastique par kg . fin de vie":{formule:{variations:[{si:"recyclage",alors:"fin de vie recyclage"},{sinon:"fin de vie non recyclé"}]},unité:"kgCO2e/kg"},"alimentation . déchets . empreinte plastique par kg . fin de vie recyclage":{formule:.434,unité:"kgCO2e/kg",note:`FE issus de la base empreinte (Emballages/Plastique rigide PP bouteilles/Recyclage - Impacts)
`},"alimentation . déchets . empreinte plastique par kg . fin de vie non recyclé":{formule:2.77,unité:"kgCO2e/kg",note:`FE issus de la base empreinte (Emballages/Plastique pétrosourcé PP/Incinération - Impacts)
`},"alimentation . déchets . empreinte carton par kg":{formule:"fabrication + fin de vie",unité:"kgCO2e/kg",note:`On considère que le carton est recyclé (hypothèse conservatrice, contrairement à ce qu'on peut penser, 
le carton recyclé est plus impactant que le carton neuf).
`},"alimentation . déchets . empreinte carton par kg . fabrication":{formule:.67,unité:"kgCO2e/kg",note:`On considère que le carton est recyclé (hypothèse conservatrice, contrairement à ce qu'on peut penser, 
le carton recyclé est plus impactant que le carton neuf).

FE issus de la base empreinte (Carton/recyclé)
`},"alimentation . déchets . empreinte carton par kg . fin de vie":{formule:{variations:[{si:"recyclage",alors:"fin de vie recyclage"},{sinon:"fin de vie non recyclé"}]},unité:"kgCO2e/kg"},"alimentation . déchets . empreinte carton par kg . fin de vie recyclage":{formule:.992,unité:"kgCO2e/kg",note:`FE issus de la base empreinte (Emballages/Carton/Recyclage - Impacts)
`},"alimentation . déchets . empreinte carton par kg . fin de vie non recyclé":{formule:.12,unité:"kgCO2e/kg",note:`FE issus de la base empreinte (Emballages/Carton/Incinération - Impacts)
`},"alimentation . déchets . empreinte bois par kg":{formule:"fabrication + fin de vie",unité:"kgCO2e/kg",note:`On considère que le carton est recyclé (hypothèse conservatrice, contrairement à ce qu'on peut penser, 
le carton recyclé est plus impactant que le carton neuf).
`},"alimentation . déchets . empreinte bois par kg . fabrication":{formule:.67,unité:"kgCO2e/kg",note:`FE issus de la base empreinte (Carton/recyclé)
`},"alimentation . déchets . empreinte bois par kg . fin de vie":{formule:{variations:[{si:"recyclage",alors:"fin de vie recyclage"},{sinon:"fin de vie non recyclé"}]},unité:"kgCO2e/kg"},"alimentation . déchets . empreinte bois par kg . fin de vie recyclage":{formule:.992,unité:"kgCO2e/kg",note:`FE issus de la base empreinte (Emballages/Carton/Recyclage - Impacts)
`},"alimentation . déchets . empreinte bois par kg . fin de vie non recyclé":{formule:.12,unité:"kgCO2e/kg",note:`FE issus de la base empreinte (Emballages/Carton/Incinération - Impacts)
`},"alimentation . ecocups":{"applicable si":"ecocups présent",formule:"1 ecocup.jour * informations . nombre de personnes par jour * empreinte / amortissement",unité:"kgCO2e"},"alimentation . ecocups présent":{titre:"Utilisation d'ecocups",question:"Allez-vous utiliser des ecocups pour l'événement ?","par défaut":"oui"},"alimentation . ecocups . réutilisation":{titre:"Réutilisation des ecocups",question:"Est-il prévu de réutiliser les ecocups pour une autre édition ?","par défaut":"non"},"alimentation . ecocups . amortissement":{formule:{variations:[{si:"ecocups . réutilisation",alors:3},{sinon:1}]},note:"On considère que les ecocups servirons sur 3 éditions."},"alimentation . ecocups . empreinte":{formule:"poids * déchets . empreinte plastique par kg",unité:"kgCO2e/ecocup"},"alimentation . ecocups . poids":{formule:.03,unité:"kg/ecocup"},"nosgestesclimat . alimentation . petit déjeuner . continental":{titre:"Continental",formule:.289,unité:"kgCO2e/repas",description:`
> ℹ️ Cette règle provient du modèle \`@incubateur-ademe/nosgestesclimat\`.


Petit déjeuner avec pain, viennoiserie, beurre, confiture et un fruit.

Voici le menu type utilisé pour notre calcul.

| Ingrédients     | Qte (g) | Kcal  | Protéines (g) | Lipides (g) | gCO2e /g | gCO2e |
| --------------- | ------- | ----- | ------------- | ----------- | -------- | ----- |
| Pain            | 50      | 132,5 | 4,5           | 1,6         | 0,67     | 33,5  |
| Vienoiserie     | 50      | 203   | 4             | 10,5        | 1,7      | 85    |
| Beurre demi-sel | 10      | 71,7  | 0,09          | 8,1         | 7,82     | 78,2  |
| Confiture       | 20      | 27,8  | 0,04          | 0,01        | 1,42     | 28,4  |
| Orange          | 100     | 47    | 0,9           | 0,1         | 0,64     | 64    |
| Total           | 230     | 482   | 9,53          | 20,31       |          | 289,1 |
`},"alimentation . petits déjeuners":{titre:"Petits déjeuners","applicable si":"petits déjeuners présent",formule:"nombre * nosgestesclimat . alimentation . petit déjeuner . continental",note:"On considère le petits déjeuner continental de Nos Gestes Climat"},"alimentation . petits déjeuners présent":{titre:"Petits déjeuners sur l'événement",question:"Proposez-vous des petits déjeuners sur place ?","par défaut":"oui"},"alimentation . petits déjeuners . nombre":{formule:"nombre par jour * informations . nombre de jours"},"alimentation . petits déjeuners . nombre par jour":{formule:"1 repas * informations . nombre de personnes par jour"},"nosgestesclimat . alimentation . plats . végétalien . empreinte":{titre:"Empreinte d'un repas végétalien",formule:.785,unité:"kgCO2e/repas",note:`Pour l'instant, en l'absence de repas type végétalien dans la [base carbone](https://www.bilans-ges.ademe.fr/documentation/UPLOAD_DOC_FR/index.htm?repas.htm),
nous prenons l'empreinte du repas végétarien, dans lequel nous substituons les 2 œufs par du tofu et des noix dans l'entrée qui devient alors une salade,
en gardant approximativement les mêmes quantités de calories et de protéines.

> Note : on peut se demander pourquoi la recette fait mention d'une omelette aux oignons sans inclure les oignons. Négligeables ? Nous les avons ajoutés.

Notons finalement que le tofu considéré ici pourrait être remplacé par du soja français et une fabrication du tofu française décarbonée, notamment pour éviter la déforestation et réduire encore plus les émissions, donnant lieu à un régime végétalien local. Voir [ce papier](https://www.nature.com/articles/s43016-020-0106-x) à ce propos du soja et de la déforestation.

🧮 Le calcul détaillé est [disponible ici](https://docs.google.com/spreadsheets/d/1SVYvBaaYDOUDcg5jX0eZFEColnWWIL8PCLMGrPR000o/edit#gid=1694091424) sous forme de tableur.
`,description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . plats . végétarien . empreinte":{titre:"Empreinte d'un repas végétarien",formule:1.115,unité:"kgCO2e/repas",note:`C'est le "Repas végétarien 1" [ici](https://www.bilans-ges.ademe.fr/documentation/UPLOAD_DOC_FR/index.htm?repas.htm), [actualisé avec les facteurs d'émission Agribalyse](https://docs.google.com/spreadsheets/d/1SVYvBaaYDOUDcg5jX0eZFEColnWWIL8PCLMGrPR000o/edit#gid=1694091424).

> Note : on peut se demander pourquoi la recette fait mention d'une omelette aux oignons sans inclure les oignons. Négligeables ? Nous les avons ajouté.

🧮 Le calcul détaillé est [disponible ici](https://docs.google.com/spreadsheets/d/1SVYvBaaYDOUDcg5jX0eZFEColnWWIL8PCLMGrPR000o/edit#gid=1694091424) sous forme de tableur.
`,description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . plats . viande 1 . empreinte":{titre:"Empreinte d'un repas de type viande 1 (poulet, porc, fromage)",formule:2.098,unité:"kgCO2e/repas",note:`C'est le "Repas classique 1 (avec poulet)" [ici](https://www.bilans-ges.ademe.fr/documentation/UPLOAD_DOC_FR/index.htm?repas.htm), actualisé avec les facteurs d'émission Agribalyse.

Le facteur d'émission associé à l'ingrédient principal (ici le la pièce de volaille ou porc) correspond à une moyenne de facteurs d'émissions associés au porc (pièce de viande et charcuterie), poulet, dinde, canard d'Agribalyse.
Cette moyenne est pondérée selon les consommations réelles des Français par type de viande animale.

🧮 Le calcul détaillé est [disponible ici](https://docs.google.com/spreadsheets/d/1SVYvBaaYDOUDcg5jX0eZFEColnWWIL8PCLMGrPR000o/edit#gid=1200865486) sous forme de tableur.
`,description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . alimentation . plats . viande 2 . empreinte":{titre:"Empreinte d'un repas de type viande 2 (bœuf, veau, agneau)",formule:5.51,unité:"kgCO2e/repas",note:`C'est le "Repas classique 2 (avec bœuf)" [ici](https://www.bilans-ges.ademe.fr/documentation/UPLOAD_DOC_FR/index.htm?repas.htm), actualisé avec les facteurs d'émission Agribalyse.

Le facteur d'émission associé à l'ingrédient principal (ici le la pièce de viande rouge) correspond à une moyenne de facteurs d'émissions associés au bœuf, agneau, veau d'Agribalyse.
Cette moyenne est pondérée selon les consommations réelles des Français par type de viande animale.

🧮 Le calcul détaillé est [disponible ici](https://docs.google.com/spreadsheets/d/1SVYvBaaYDOUDcg5jX0eZFEColnWWIL8PCLMGrPR000o/edit#gid=1200865486) sous forme de tableur.
`,description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"alimentation . repas":{titre:"Repas",formule:{somme:["végétalien","végétarien","viande 1","viande 2"]}},"alimentation . repas . végétalien":{formule:"nombre * nosgestesclimat . alimentation . plats . végétalien . empreinte"},"alimentation . repas . végétalien . nombre":{formule:"proportion * informations . nombre de repas total"},"alimentation . repas . végétalien . proportion":{formule:{variations:[{si:"proposition = 'végétalien'",alors:"100%"},{sinon:"0%"}]}},"alimentation . repas . végétarien":{formule:"nombre * nosgestesclimat . alimentation . plats . végétarien . empreinte"},"alimentation . repas . végétarien . nombre":{formule:"proportion * informations . nombre de repas total"},"alimentation . repas . végétarien . proportion":{formule:{variations:[{si:"proposition = 'végétarien'",alors:"100%"},{si:"proposition = 'mixte végé viande'",alors:"proposition . mixte végé viande . proportion végétarien"},{sinon:"0%"}]}},"alimentation . repas . viande 1":{formule:"nombre * nosgestesclimat . alimentation . plats . viande 1 . empreinte"},"alimentation . repas . viande 1 . nombre":{formule:"proportion * informations . nombre de repas total"},"alimentation . repas . viande 1 . proportion":{formule:{variations:[{si:"proposition = 'viande uniquement'",alors:"proposition . choix viande . proportion viande 1"},{si:"proposition = 'mixte végé viande'",alors:"proposition . choix viande . proportion viande 1 * proposition . mixte végé viande . proportion viande"},{sinon:"0%"}]}},"alimentation . repas . viande 2":{formule:"nombre * nosgestesclimat . alimentation . plats . viande 2 . empreinte"},"alimentation . repas . viande 2 . nombre":{formule:"proportion * informations . nombre de repas total"},"alimentation . repas . viande 2 . proportion":{formule:{variations:[{si:"proposition = 'viande uniquement'",alors:"proposition . choix viande . proportion viande 2"},{si:"proposition = 'mixte végé viande'",alors:"proposition . choix viande . proportion viande 2 * proposition . mixte végé viande . proportion viande"},{sinon:"0%"}]}},"alimentation . repas . proposition":{titre:"Régime des repas proposés",question:"Quelle type de régime alimentaire prévoyez-vous ?",formule:{"une possibilité":{"choix obligatoire":"oui",possibilités:["végétalien","végétarien","mixte végé viande","viande uniquement"]}},"par défaut":"'mixte végé viande'"},"alimentation . repas . proposition . végétalien":{titre:"Uniquement végan"},"alimentation . repas . proposition . végétarien":{titre:"Uniquement végétarien"},"alimentation . repas . proposition . mixte végé viande":{titre:"Mixte végétarien / viande"},"alimentation . repas . proposition . viande uniquement":{titre:"Uniquement carné"},"alimentation . repas . proposition . mixte végé viande . proportion végétarien":{"applicable si":"proposition = 'mixte végé viande'",titre:"Proportion de repas végétariens",question:"Comment allez-vous répartir les régimes proposés ?",plancher:0,plafond:100,"par défaut":"50%",unité:"%"},"alimentation . repas . proposition . mixte végé viande . proportion viande":{"applicable si":"proposition = 'mixte végé viande'",formule:"100% - proportion végétarien",unité:"%"},"alimentation . repas . proposition . choix viande":{"applicable si":{"une de ces conditions":["proposition = 'mixte végé viande'","proposition = 'viande uniquement'"]},titre:"Choix de viande",question:"Proposerez-vous de la viande blanche ou viande rouge ?",formule:{"une possibilité":{"choix obligatoire":"oui",possibilités:["viande 1","viande 2","les deux"]}},"par défaut":"'les deux'"},"alimentation . repas . proposition . choix viande . viande 1":{titre:"Viande blanche"},"alimentation . repas . proposition . choix viande . viande 2":{titre:"Viande rouge"},"alimentation . repas . proposition . choix viande . les deux":{titre:"Les 2"},"alimentation . repas . proposition . choix viande . proportion viande 1":{formule:{variations:[{si:"choix viande = 'viande 1'",alors:"100%"},{si:"choix viande = 'les deux'",alors:"50%"},{sinon:"0%"}]}},"alimentation . repas . proposition . choix viande . proportion viande 2":{formule:{variations:[{si:"choix viande = 'viande 2'",alors:"100%"},{si:"choix viande = 'les deux'",alors:"50%"},{sinon:"0%"}]}},"commun . intensité électricité":{titre:"Intensité carbone du mix électrique français",description:`
> ℹ️ Cette règle provient du modèle [\`@incubateur-ademe/publicodes-commun\`](https://github.com/incubateur-ademe/publicodes-commun).


Intensité moyenne, tous types de consommations confondues, année 2022.`,formule:.052,unité:"kgCO2e/kWh",note:`Ici, on parle du mix électrique de consommation. 
Le chiffre est issu de la Base Empreinte (Electricité/2022 - mix moyen/consommation) dont la méthodologie est décrite dans la [documentation](https://prod-basecarbonesolo.ademe-dri.fr/documentation/UPLOAD_DOC_FR/).
La v2.6 de MicMac donnait une valeur de 12.4gCO2e/kWh pour les fournisseurs d'électricité "verte", mais cette valeur semble correspondre à un calcul théorique sur l'année, et non pas à un calcul réel, minute par minute.
`},"commun . mois par an":{titre:"Nombre de mois par an",formule:12,unité:"mois",description:"> ℹ️ Cette règle provient du modèle [`@incubateur-ademe/publicodes-commun`](https://github.com/incubateur-ademe/publicodes-commun)."},"commun . semaines par an":{titre:"Nombre de semaines par an",formule:52,unité:"semaine",description:"> ℹ️ Cette règle provient du modèle [`@incubateur-ademe/publicodes-commun`](https://github.com/incubateur-ademe/publicodes-commun)."},"commun . jours par semaine":{titre:"Nombre de jours par semaine",formule:7,unité:"jour/semaine",description:"> ℹ️ Cette règle provient du modèle [`@incubateur-ademe/publicodes-commun`](https://github.com/incubateur-ademe/publicodes-commun)."},"commun . jours par an":{titre:"Nombre de jours par an",formule:365,unité:"jour",description:"> ℹ️ Cette règle provient du modèle [`@incubateur-ademe/publicodes-commun`](https://github.com/incubateur-ademe/publicodes-commun)."},communication:Bw,"communication . impressions":{titre:"Impressions",formule:0,unité:"kgCO2e",note:"A venir"},"communication . merchandising":{titre:"Merchandising",formule:{somme:["textile","plastique"]},unité:"kgCO2e",note:`Pour cette modélisation, nous nous inspirons de l'étude [Décarbonons la Culture ! The Shift Project](https://theshiftproject.org/wp-content/uploads/2021/12/211130-TSP-PTEF-Rapport-final-Culture-v3.pdf)
en estimant le chiffre d'affaires réalisé grâce au merchandising réparti sur différents produits textiles (t-shirts et sweat shirts) 
mais également des produits dérivés "plastiques".

D'après [le baromètre 2023 de Weezevent](https://weezevent.com/fr/blog/barometre-festivals-2023/#:~:text=Notons%20que%20le%20prix%20moyen,%E2%82%AC)%20pour%20les%20festivals%20urbains.)
sur les consommations et les achats des festivaliers, le panier moyen pour du merch est de 4€ par jour et par personne.

Dans une V2, il s'agira d'affiner l'empreinte carbone associée aux produits vendu en passant par des FE "physiques"
et en incluant des variations selon l'approvisionnement des produits.
`},"communication . merchandising . surplus production":{formule:"110%",note:`On estime que 10% le surplus de production.
`},"communication . merchandising . chiffre d affaires":{formule:"informations . nombre de festivaliers * merchandising . panier moyen par jour et par personne",unité:"€",note:`D'après [le baromètre 2023 de Weezevent](https://weezevent.com/fr/blog/barometre-festivals-2023/#:~:text=Notons%20que%20le%20prix%20moyen,%E2%82%AC)%20pour%20les%20festivals%20urbains.)
sur les consommations et les achats des festivaliers, le panier moyen pour du merch est de 4€ par jour et par personne.
`},"communication . merchandising . chiffre d affaires . part textile":{formule:"70%"},"communication . merchandising . chiffre d affaires . part plastique":{formule:"30%"},"communication . merchandising . panier moyen par jour et par personne":{titre:"Montant du panier moyen d'un festivalier par jour pour le merch.",question:"Quel est le montant du panier moyen d'un festivalier par jour ?","par défaut":4,unité:"€",note:`D'après [le baromètre 2023 de Weezevent](https://weezevent.com/fr/blog/barometre-festivals-2023/#:~:text=Notons%20que%20le%20prix%20moyen,%E2%82%AC)%20pour%20les%20festivals%20urbains.)
`},"communication . merchandising . textile":{formule:"surplus production * chiffre d affaires . part textile * chiffre d affaires * ratio monétaire",unité:"kgCO2e"},"communication . merchandising . textile . ratio monétaire":{formule:"ratio monétaire HT / 1.2 €/€HT",unité:"kgCO2e/€"},"communication . merchandising . textile . ratio monétaire HT":{formule:.6,unité:"kgCO2e/€HT",note:`Facteur d'émission issu de la base empreinte "Service/Textile et habillement".
`},"communication . merchandising . plastique":{formule:"surplus production * chiffre d affaires . part plastique * chiffre d affaires * ratio monétaire",unité:"kgCO2e"},"communication . merchandising . plastique . ratio monétaire":{formule:"ratio monétaire HT / 1.2 €/€HT",unité:"kgCO2e/€"},"communication . merchandising . plastique . ratio monétaire HT":{formule:.8,unité:"kgCO2e/€HT",note:`Facteur d'émission issu de la base empreinte "Service/Textile et habillement".
`},"communication . numérique":{titre:"Numérique",formule:0,unité:"kgCO2e",note:"A venir"},"nosgestesclimat . divers . textile . t-shirt . empreinte":{formule:5.35,unité:"kgCO2e",note:"moyenne de l'empreinte des t-shirts en coton et en polyester de la Base Carbone",description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"nosgestesclimat . divers . textile . sweat . empreinte":{formule:27.4,unité:"kgCO2e",note:"empreinte d'un sweat de la Base Carbone",description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"communication . textile bénévoles":{titre:"Textile bénévoles",formule:{variations:[{si:'textile bénévoles . type = "t shirt"',alors:"informations . nombre de bénévoles * nosgestesclimat . divers . textile . t-shirt . empreinte / amortissement"},{si:'textile bénévoles . type = "sweat"',alors:"informations . nombre de bénévoles * nosgestesclimat . divers . textile . sweat . empreinte / amortissement"},{si:'textile bénévoles . type = "aucun"',alors:0}]},unité:"kgCO2e"},"communication . textile bénévoles . type":{titre:"Vêtements pour les équipes et bénévoles",question:"Prévoyez-vous des vêtements pour votre équipe ?",formule:{"une possibilité":{"choix obligatoire":"oui",possibilités:["t shirt","sweat","aucun"]}},"par défaut":"'t shirt'"},"communication . textile bénévoles . type . t shirt":{titre:"T-shirt"},"communication . textile bénévoles . type . sweat":{titre:"Sweat"},"communication . textile bénévoles . type . aucun":{titre:"Non, aucun vêtement"},"communication . textile bénévoles . amortissement":{formule:{variations:[{si:"textile bénévoles . réutilisation",alors:2},{sinon:1}]}},"communication . textile bénévoles . réutilisation":{titre:"Réutilisation des vêtements pour une autre édition",question:"Est-il prévu de réutiliser les vêtements pour une autre édition ?","par défaut":"non"},"nosgestesclimat . logement . chauffage . gaz . facteur d'émission base carbone":{titre:"Intensité carbone gaz naturel",valeur:.221,unité:"kgCO2e/kWh",note:`Il s'agit de kgCO2e/kWh *PCS*.

On raisonne en PCS (Pouvoir Calorifique Supérieur) et non en PCI (Pouvoir Calorifique Inférieur), car le PCS est utilisé en tant que coefficient de conversion dans les factures pour convertir le volume de gaz utilisé en kWh : 
on fait l'hypothèse que la chaudière gaz récupère bien la chaleur latente de condensation.

Base Carbone Gaz naturel - 2022/mix moyen/consommation
`,description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},énergie:{titre:"Énergie",icônes:"⚡️",description:`Cette section concerne la consommation d'**électricité**, de **fioul et gaz** et des **groupes électrogènes** pour l'événement. 
Les valeurs pré-entrées sont basées sur des **consommations moyennes par festivalier** pour ce type d'évènement.

*L'empreinte des groupes électrogènes est particulièrement importante devant celle de l'électricité.*
`,formule:{somme:["électricité","autre","groupes électrogènes"]},unité:"kgCO2e"},"énergie . consommation par défaut":{formule:"0.6 kWh * informations . nombre de festivaliers",unité:"kWh",note:`Selon l'étude [Décarbonons la Culture ! The Shift Project](https://theshiftproject.org/wp-content/uploads/2021/12/211130-TSP-PTEF-Rapport-final-Culture-v3.pdf):
il est tout à fait pertinent d'utiliser l’[étude d’ENERIS](https://www.ressource0.com/wp-content/uploads/2012/09/guideSpectacle-vivant1.pdf) produite en 2011 
qui propose une consommation électrique de 0,6 KWh par festivalier en moyenne.
`},"énergie . électricité":{formule:"consommation * commun . intensité électricité",unité:"kgCO2e"},"énergie . électricité . consommation":{titre:"Consommation d'électricité totale",question:"Quelle est votre consommation d'électricité pour l'événement ?",plancher:0,unité:"kWh","par défaut":{variations:[{si:{"toutes ces conditions":["autre présent","groupes électrogènes présent"]},alors:"consommation par défaut / 4"},{si:{"toutes ces conditions":["autre présent = non","groupes électrogènes présent"]},alors:"consommation par défaut / 2"},{sinon:"consommation par défaut"}]}},"énergie . autre":{"applicable si":"autre présent",formule:{somme:["gaz","fioul"]},unité:"kgCO2e"},"énergie . autre présent":{titre:"Utilisation d'une autre source d'énergie",question:"Utilisez-vous une autre source d'énergie pour l'événement (gaz, fioul) ?","par défaut":"non"},"énergie . autre . gaz":{formule:"consommation * nosgestesclimat . logement . chauffage . gaz . facteur d'émission base carbone",unité:"kgCO2e"},"énergie . autre . gaz . consommation":{titre:"Consommation de gaz totale",question:"Quelle est votre consommation de gaz pour l'événement ?",plancher:0,unité:"kWh","par défaut":{variations:[{si:"groupes électrogènes présent",alors:"consommation par défaut / 4"},{sinon:"consommation par défaut / 2"}]}},"énergie . autre . fioul":{formule:"consommation * empreinte",unité:"kgCO2e"},"énergie . autre . fioul . consommation":{titre:"Consommation de fioul totale",question:"Quelle est votre consommation de fioul pour l'événement ?",plancher:0,unité:"kWh","par défaut":"consommation par défaut / 4"},"énergie . autre . fioul . empreinte":{formule:.303,unité:"kgCO2e/kWh",note:`Facteur d'émission issu de la base empreinte "Fioul domestique" (kgCO2e/kWhPCS).
`},"énergie . groupes électrogènes":{"applicable si":"groupes électrogènes présent",formule:"nombre * empreinte par jour * informations . nombre de jours",unité:"kgCO2e",note:`On fait l'hypothèse que la puissance d'un groupe électrogène utilisé est de 10kW.
On estime qu'un groupe électrogène de cette puissance consomme 4l/h.

Dans un second temps, il s'agira de d'évaluer l'empreinte du groupe électrogène directement 
via le type de carburant consommé et la consommation réelle.
`},"énergie . groupes électrogènes présent":{titre:"Utilisation de groupes électrogènes",question:"Allez-vous utiliser des groupes électrogènes pour l'événement ?","par défaut":"oui"},"énergie . groupes électrogènes . nombre":{titre:"Nombre de groupes électrogènes",question:"Combien de groupes électrogènes prévoyez-vous d'utiliser ?",plancher:0,"par défaut":{variations:[{si:"autre présent",alors:"consommation par défaut / 4 / production"},{sinon:"consommation par défaut / 2 / production"}]}},"énergie . groupes électrogènes . production":{formule:"10kW * 24 h/jour * 0.75 * informations . nombre de jours",unité:"kWh"},"énergie . groupes électrogènes . empreinte par jour":{formule:"0.75 * consommation carburant * empreinte carburant * 24 h/jour",note:"On considère qu'un groupe électrogène est utilisé 75% de la journée à pleine puissance.",unité:"kgCO2e/jour"},"énergie . groupes électrogènes . consommation carburant":{formule:4,unité:"l/h"},"énergie . groupes électrogènes . empreinte carburant":{formule:2.7,unité:"kgCO2e/l",note:`Facteur d'émission issu de la base empreinte "Essence".
`},"hébergement . artistes":{titre:"Hébergement des artistes","applicable si":"artistes présent",formule:"informations . nombre de nuits artistes * nosgestesclimat . logement . vacances . empreinte hotel par nuit",unité:"kgCO2e"},"hébergement . artistes présent":{titre:"Hébergement des artistes",question:"Prenez-vous en charge l'hébergement en hôtel des artistes du festival ?","par défaut":"oui"},"nosgestesclimat . logement . vacances . empreinte hotel par nuit":{formule:6.93,unité:"kgCO2e/nuit",note:`## Notre hypothèse sur le facteur d'émission utilisé

  D'après [l'enquête mobilité des français de 2019](https://www.statistiques.developpement-durable.gouv.fr/resultats-detailles-de-lenquete-mobilite-des-personnes-de-2019?rubrique=60&dossier=1345), 
  les français voyagent à 86% en France. On assume donc ici que **les nuitées se passent en France**.

## Notre source de données

  Le rapport final de pré-déploiement de l'affichage environnemental des hôtels, [publication ADEME de mars 2020](https://librairie.ademe.fr/consommer-autrement/4096-projet-de-pre-deploiement-de-l-affichage-environnemental-des-hotels.html), donne une moyenne de 9,91 kg éqCO2 / nuitée. 
  En retranchant la partie petit-déjeuner (comptant pour 30% de l'empreinte), car sinon nous aurions une double comptabilité de ces derniers, on se retrouve avec une empreinte par nuitée de 9,91 * (1 - 30%) = 6,93 kg éqCO2.

  Le rapport permet également de scinder les empreintes selon la classe de l'hôtel. Pour démarrer, nous avons assumé de partir sur la moyenne des empreintes toutes classes confondues, mais cela pourra être implémenté par la suite. Cela donnerait :

  - Hôtels sans classement : 4,73 kg éqCO2 / nuitée
  - Hôtels 2* : 8,53 kg éqCO2 / nuitée
  - Hôtels 3* : 8,47 kg éqCO2 / nuitée
  - Hôtels 4* : 11,43 kg éqCO2 / nuitée
  - Hôtels 5* : 17,11 kg éqCO2 / nuitée

  Depuis plusieurs années, [Betterfly Tourism](https://www.betterfly-tourism.com/affichage-environnemental-hotels/) implémente en partenariat avec l'ADEME l'affichage environnemental auprès des hôtels. Il sera donc possible de réévaluer l'empreinte avec des données plus récentes issues de leur base de données consolidée.

  De son côté, le [Hotel Carbon Measurement Initiative (HCMI)](https://sustainablehospitalityalliance.org/resource/hotel-carbon-measurement-initiative/) qui alimente le [Cornell Hotel Sustainability Benchmarking Index](https://greenview.sg/services/chsb-index/) présente des [données](https://ecommons.cornell.edu/handle/1813/109990) pertinentes pour notre usage.
  Cela pourra être un bon point de départ pour le jour où nous souhaiterons différencier les nuitées d'hôtel selon le pays fréquenté.
  À noter que le HCMI donne une moyenne pour la France de 7,7 kg éqCO2 / nuitée, ce qui est très proche de la donnée que nous avons choisie, elle calculée à partir du référentiel ADEME.

  > Point publicodes : Cette règle étant utilisée dans d'autres espaces nom que \`logement . vacances . hotel\` c'est important ici de ne pas l'inclure dans cet espace non qui rendrait l'empreinte de la nuitée non applicable si la règle hotel est elle aussi non applicable.
`,description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"hébergement . bénévoles":{titre:"Hébergement des bénévoles",formule:{variations:[{si:'type = "camping"',alors:"nombre de nuits hôtel * nosgestesclimat . logement . vacances . empreinte hotel par nuit"},{si:'type = "hôtel"',alors:"nombre de nuits hôtel * nosgestesclimat . logement . vacances . empreinte hotel par nuit"},{sinon:0}]},unité:"kgCO2e"},"hébergement . bénévoles . type":{titre:"Hébergement des bénévoles",question:"Prenez-vous en charge l'hébergement en hôtel des organisateurs et bénévoles du festival ?",formule:{"une possibilité":{"choix obligatoire":"oui",possibilités:["camping","hôtel","aucun"]}},"par défaut":"'aucun'"},"hébergement . bénévoles . type . camping":{titre:"Oui, en camping"},"hébergement . bénévoles . type . hôtel":{titre:"Oui, en hôtel"},"hébergement . bénévoles . type . aucun":{titre:"Non"},"hébergement . bénévoles . nombre de nuits hôtel":{formule:"informations . nombre de bénévoles * informations . nombre de nuits",unité:"nuit"},hébergement:{titre:"Hébergement",icônes:"⛺️",description:`Ce poste d'émission inclut l'impact de l'hébergement des festivaliers, des bénévoles et des artistes.
*La part des festivaliers qui dorment sur place impacte directement le nombre de **déplacements** du public.*
`,formule:{somme:["bénévoles","public","artistes"]},unité:"kgCO2e",note:`Pour le moment, on ne prend en compte que les nuitées en hôtel en considérant que le nombre de nuits 
correspond au nombre de jours de l'évènement.
Dans un second temps, on pourrait ajouter le camping par exemple. 
On pourrait également ajouter la possibilité de renseigner le nombre de nuitées prises en charge durant l'évènement.
`},"nosgestesclimat . logement . vacances . camping . empreinte par nuit":{formule:1.4,unité:"kgCO2e/nuit",note:`Ces données sont issues de la proposition de référentiel ADEME pour l'hôtellerie de plein air, étude effectuée sur 13 campings de l'Hérault conjointement entre Betterfly Tourism et l'ADEME.
Les données sont fournies par Betterfly Tourism et datent de juin 2021. La moyenne de l'empreinte par nuitée sur les 13 campings étudiés est de 1,4 kg éqCO2.
Le référentiel ADEME est présent dans la base Impacts depuis mai 2023.
`,description:"> ℹ️ Cette règle provient du modèle `@incubateur-ademe/nosgestesclimat`."},"hébergement . public":{"applicable si":"public présent",formule:"nombre de nuits camping * nosgestesclimat . logement . vacances . camping . empreinte par nuit",unité:"kgCO2e",note:"On considère que l'hébergement se fait en camping."},"hébergement . public présent":{titre:"Hébergement des festivaliers en camping",question:"Prenez-vous en charge l'hébergement en camping des participants du festival ?","par défaut":"oui"},"hébergement . public . nombre de nuits camping":{formule:"nombre de festivaliers hébergés * informations . nombre de nuits",unité:"nuit"},"hébergement . public . nombre de festivaliers hébergés":{formule:"part * informations . nombre de festivaliers"},"hébergement . public . nombre de festivaliers journée":{formule:"(100% - part) * informations . nombre de festivaliers"},"hébergement . public . part":{titre:"Part des festivaliers qui dorment sur place",question:"Quelle part des festivaliers dorment sur place ?","par défaut":30,plancher:0,plafond:100,unité:"%"},informations:Lw,"informations . nombre de jours":{titre:"Durée de l'évènement",question:"Combien de jours dure votre évènment ?",description:"Compter 1 jour pour une soirée.","par défaut":2,plancher:0,unité:"jour"},"informations . nombre de nuits":{formule:"informations . nombre de jours * 1 nuit/jour",unité:"nuit"},"informations . nombre de festivaliers":{titre:"Nombre de festivaliers",description:"Compter 2 si une même personne vient 2 jours.",question:"Combien de participants attendez-vous sur l'ensemble de l'évènements (compter 2 entrées si une personne est présente 2 jours) ?",plancher:0,note:"On parle de la somme des entrées uniques par jour.","par défaut":25e3},"informations . nombre de festivaliers par jour":{formule:"nombre de festivaliers / nombre de jours"},"informations . nombre de bénévoles":{titre:"Nombre d'organisateurs et bénévoles",question:"Combien y aura-t-il d'organisateurs et bénévoles ?",plancher:0,"par défaut":100},"informations . nombre de personnes par jour":{formule:"nombre de festivaliers par jour + nombre de bénévoles"},"informations . nombre de repas par jour":{formule:"2 repas * nombre de personnes par jour"},"informations . nombre de repas total":{formule:"nombre de repas par jour * nombre de jours"},"informations . nombre artistes en voiture":{titre:"Nombre d'artistes (équipe incluse) en voiture",question:"Combien d'artistes (équipe incluse) seront présents sur le festival ?",plancher:0,"par défaut":10},"informations . nombre artistes en train":{titre:"Nombre d'artistes (équipe incluse) en train",question:"Combien d'artistes (équipe incluse) seront présents sur le festival ?",plancher:0,"par défaut":10},"informations . nombre artistes en tour bus":{titre:"Nombre d'artistes (équipe incluse) en tour bus",question:"Combien d'artistes (équipe incluse) seront présents sur le festival ?",plancher:0,"par défaut":30},"informations . nombre artistes en avion":{titre:"Nombre d'artistes (équipe incluse) en avion",question:"Combien d'artistes (équipe incluse) seront présents sur le festival ?",plancher:0,"par défaut":10},"informations . nombre artistes":{formule:{somme:["nombre artistes en voiture","nombre artistes en train","nombre artistes en tour bus","nombre artistes en avion"]}},"informations . nombre de nuits artistes":{formule:"nombre artistes * 1 nuit",unité:"nuit"},bâtiments:{titre:"Bâtiments",formule:{somme:["béton","métallique","temporaire"]},unité:"kgCO2e"},"bâtiments . facteur amortissement":{formule:"informations . nombre de jours / (commun . jours par an * 50)",note:`Bâtiments amortis sur 50 ans. On fait l'hypothèse que le bâtiment reste "non amorti" 
même s'il date de plus de 50 ans pour limiter les paramètres, au vu de l'impact négligeable.
`},"bâtiments . béton":{formule:"surface * empreinte par m2 * facteur amortissement",unité:"kgCO2e"},"bâtiments . béton . surface":{titre:"Surface des bâtiments béton",question:`Quelle est la surface des bâtiments "structure béton" utilisés pour l'événement ?`,plancher:0,"par défaut":0,unité:"m2"},"bâtiments . béton . empreinte par m2":{formule:825,unité:"kgCO2e/m2",note:`Facteur d'émission issu de la base empreinte "Bâtiment industriel/structure en béton".
`},"bâtiments . métallique":{formule:"surface * empreinte par m2 * facteur amortissement",unité:"kgCO2e"},"bâtiments . métallique . surface":{titre:"Surface des bâtiments structure métallique",question:`Quelle est la surface des bâtiments "structure métallique" utilisés pour l'événement ?`,plancher:0,"par défaut":500,unité:"m2"},"bâtiments . métallique . empreinte par m2":{formule:275,unité:"kgCO2e/m2",note:`Facteur d'émission issu de la base empreinte "Bâtiment industriel/structure métallique".
`},"bâtiments . temporaire":{titre:"Barnums",formule:0,unité:"kgCO2e",note:"A venir"},infrastructures:Fw,"infrastructures . scénographie":{titre:"Scénographie",formule:{somme:["fret","matériel","décor"]},unité:"kgCO2e"},"infrastructures . scénographie . nombre petites scènes":{titre:"Nombre de petites scènes",question:"Quel est le nombre de petites scènes prévus pour l'événement ?",plancher:0,"par défaut":2,unité:"scène"},"infrastructures . scénographie . nombre grandes scènes":{titre:"Nombre de grandes scènes",question:"Quel est le nombre de grandes scènes prévues pour l'événement ?",plancher:0,"par défaut":2,unité:"scène"},"infrastructures . scénographie . fret":{formule:"tonnes km total * empreinte par tonnes km",note:`On considère que l'empreinte des scènes réside dans le fret.

Selon l'étude [Décarbonons la Culture ! The Shift Project](https://theshiftproject.org/wp-content/uploads/2021/12/211130-TSP-PTEF-Rapport-final-Culture-v3.pdf),
Le seul montage des scènes d’un festival comme Les Vieilles Charrues implique une quarantaine de semi-remorques pour 4 scènes (voir [cet artcle de France Info](https://france3-regions.francetvinfo.fr/bretagne/2013/07/18/l-antiseche-pour-etre-incollable-sur-les-vieilles-charrues-289717.html)).

Néanmoins, il est fait l'hypothèse de partir sur une moyenne de 7 semi-remorques pour une grande scène, 3 pour une plus petite.

Comme expliqué dans l'étude "Décarbonons la Culture !", ces données sont celles des Vieilles Charrues, 
Par ailleurs, on ne sait pas si cette donnée inclut la logistique alimentaire.

Pour cette première estimation, il est considéré que le tonnage transporté est en moyenne à 8,5 tonnes sur 1500km (A/R)
`,unité:"kgCO2e"},"infrastructures . scénographie . fret . nombre de camion par petite scène":{formule:2,unité:"camion/scène",note:`Nombre de camions nécessaires pour le transport d'une petite scène.
`},"infrastructures . scénographie . fret . nombre de camion par grande scène":{formule:6,unité:"camion/scène",note:`Nombre de camions nécessaires pour le transport d'une grande scène.
`},"infrastructures . scénographie . fret . empreinte par tonnes km":{formule:.0823,unité:"kgCO2e/t.km",note:`Facteur d'émission issu de la base empreinte "Articulé/< 34 tonnes/Diesel routier, incorporation 7 % de biodiesel".
`},"infrastructures . scénographie . fret . tonnes km total":{formule:{somme:["nombre petites scènes * fret . nombre de camion par petite scène * tonnes km par camion","nombre grandes scènes * fret . nombre de camion par grande scène * tonnes km par camion"]},unité:"t.km"},"infrastructures . scénographie . fret . tonnes km par camion":{formule:"charge moyenne * distance moyenne",unité:"t.km/camion"},"infrastructures . scénographie . fret . distance moyenne":{formule:1e3,unité:"km",note:`Distance moyenne parcourue par les semi-remorques pour le transport du matériel de scène en incluant le retour à vide.
`},"infrastructures . scénographie . fret . charge moyenne":{formule:8.5,unité:"t/camion",note:`Charge moyenne des semi-remorques pour le transport du matériel de scène.
`},"infrastructures . scénographie . matériel":{formule:"dépenses * ratio monétaire * facteur amortissement",unité:"kgCO2e",note:`Selon la méthode du simulateur [SEEDS](https://nuage.arviva.org/index.php/s/Pzzm9KbAwwL4gPR), 
les émissions de CO2 liées à la location de matériel technique sont estimées à partir du montant 
dépensés pour leur location puis amorties sur via la durée de location et leur durée de vie.

A titre indicatif:
  - Projecteur : 600€ soit 240kgCO2e  
  - Enceinte : 500€ soit 200kgCO2e 
  - Console : 1500€ soit 600kgCO2e 
  - Machine à fumée : 400€ soit 160kgCO2e  
  - Micros : 200€ soit 80kgCO2e  
  - Vidéoprojecteur : 145kgCO2e (déjà présent dans la base ADEME)
`},"infrastructures . scénographie . matériel . facteur amortissement":{formule:"informations . nombre de jours / (commun . jours par an * 5)",note:"Matériel amorti sur 5 ans."},"infrastructures . scénographie . matériel . dépenses":{titre:"Dépenses pour la location de matériel de scénographie",question:"A combien estimez-vous vos dépenses de location de matériel technique (scène, son, lumière, vidéo etc...) ?",plancher:0,"par défaut":1e7,unité:"€HT"},"infrastructures . scénographie . matériel . ratio monétaire":{formule:.4,unité:"kgCO2e/€HT",note:`Ratio monétaire issu de la Base Empreinte "Service/Produits informatiques, électroniques et optiques".
`},"infrastructures . scénographie . décor":{"applicable si":"décor présent",formule:0,unité:"kgCO2e",note:`Pour le moment, nous faisons l'hypothèse que les décors et costumes sont de la responsabilité des artistes.
`},"infrastructures . scénographie . décor présent":{"par défaut":"non"},"infrastructures . toilettes":{formule:0,unité:"kgCO2e",note:"A venir"},resultats:Uw,"resultats . bilan total":{titre:"Bilan Carbone de mon évènement",formule:{somme:["alimentation","transport","infrastructures","hébergement","énergie","communication"]},unité:"kgCO2e"},"resultats . bilan par festivalier":{titre:"Bilan Carbone par festivalier et par jour",formule:"bilan total / informations . nombre de festivaliers",unité:"kgCO2e"},"transport . artistes":{titre:"Transport des artistes",formule:{somme:["voiture","avion","train","tour bus"]},unité:"kgCO2e"},"transport . artistes . voiture":{"applicable si":"informations . nombre artistes en voiture > 0",formule:"informations . nombre artistes en train * distance * voiture . empreinte par km / voiture . remplissage moyen",unité:"kgCO2e"},"transport . artistes . voiture . distance":{titre:"Distance moyenne parcourue par les artistes en voiture",question:"Quelle est la distance (A/R) parcourue en voiture en moyenne par les artistes pour venir au festival ?",plancher:0,"par défaut":100,unité:"km"},"transport . artistes . avion":{"applicable si":"informations . nombre artistes en avion > 0",formule:"informations . nombre artistes en avion * distance * avion . empreinte par km",unité:"kgCO2e"},"transport . artistes . avion . distance":{titre:"Distance moyenne parcourue par les artistes en avion",question:"Quelle est la distance (A/R) parcourue en avion en moyenne par les artistes pour venir au festival ?",plancher:0,"par défaut":1500,unité:"km"},"transport . artistes . train":{"applicable si":"informations . nombre artistes en train > 0",formule:"informations . nombre artistes en train * distance * train . empreinte par km",unité:"kgCO2e"},"transport . artistes . train . distance":{titre:"Distance moyenne parcourue par les artistes en train",question:"Quelle est la distance en moyenne (A/R) parcourue en train par les artistes pour venir au festival ?",plancher:0,"par défaut":500,unité:"km"},"transport . artistes . tour bus":{"applicable si":"informations . nombre artistes en tour bus > 0",formule:"informations . nombre artistes en tour bus * distance * tour bus . empreinte par km",unité:"kgCO2e"},"transport . artistes . tour bus . distance":{titre:"Distance moyenne parcourue par les artistes en tour bus",question:"Quelle est la distance en moyenne (A/R) parcourue en tour bus par les artistes pour venir au festival ?",plancher:0,"par défaut":1e3,unité:"km"},"transport . public":{titre:"Transport du public",formule:{somme:["voiture","avion","train","commun"]},unité:"kgCO2e"},"transport . public . accessible en transports en commun":{titre:"Accessibilité en transports en commun",question:"Votre festival est-il facilement accessible en transport en commun ?","par défaut":"non"},"transport . public . nombre de déplacements":{formule:{somme:["festivaliers","bénévoles"]},note:`On considère ici les festivaliers mais aussi les équipes d'organisation et les bénévoles.
`},"transport . public . nombre de déplacements . festivaliers":{formule:{variations:[{si:"hébergement . public présent",alors:"hébergement . public . nombre de festivaliers journée + hébergement . public . nombre de festivaliers hébergés / informations . nombre de jours * 1 jour"},{sinon:"informations . nombre de festivaliers"}]}},"transport . public . nombre de déplacements . bénévoles":{formule:{variations:[{si:'hébergement . bénévoles . type = "aucun"',alors:"informations . nombre de bénévoles * informations . nombre de jours / 1 jour"},{sinon:"informations . nombre de bénévoles"}]}},"transport . public . distance AR":{titre:"Distance moyenne aller/retour parcourue par un festivalier (hors avion)",question:"Quelle est la distane moyenne aller/retour parcourue par un festivalier ?",unité:"km",plancher:0,"par défaut":100,note:"On inclut ici les festivaliers mais également les bénévoles et les organisateurs."},"transport . public . parts totales":{titre:"Vérifiez que total est à 100% :",question:"Avez-vous bien vérifier que la somme des parts de transport est bien à 100% ?",valeur:{somme:["voiture . part","avion . part","train . part","commun . part","mobilité douce . part"]}},"transport . public . mobilité douce":null,"transport . public . mobilité douce . part":{titre:"Part des festivaliers venant à pied ou à vélo",question:"Quelle part des festivaliers viennent à pied ou à vélo ?",plancher:0,plafond:100,unité:"%","par défaut":{variations:[{si:"accessible en transports en commun",alors:7},{sinon:2}]},note:"On considère que l'impact de la marche ou du vélo est négligeable."},"transport . public . parts totales modes de transport":{formule:{somme:["voiture . part","avion . part","train . part","commun . part"]},plafond:100,unité:"%"},"transport . public . voiture . part":{titre:"Part des festivaliers venant en voiture",question:"Quelle part des festivaliers viennent en voiture ?",plancher:0,plafond:100,unité:"%","par défaut":{variations:[{si:"accessible en transports en commun",alors:20},{sinon:80}]}},"transport . public . avion . part":{titre:"Part des festivaliers venant en avion",question:"Quelle part des festivaliers viennent en avion ?",plancher:0,plafond:100,unité:"%","par défaut":{variations:[{si:"accessible en transports en commun",alors:3},{sinon:3}]}},"transport . public . train . part":{titre:"Part des festivaliers venant en train",question:"Quelle part des festivaliers viennent en train ?",plancher:0,plafond:100,unité:"%","par défaut":{variations:[{si:"accessible en transports en commun",alors:20},{sinon:10}]}},"transport . public . commun . part":{titre:"Part des festivaliers venant en transports en commun",question:"Quelle part des festivaliers viennent en transports en commun (bus, tramway, métro) ?",plancher:0,plafond:100,unité:"%","par défaut":{variations:[{si:"accessible en transports en commun",alors:50},{sinon:5}]}},"transport . public . voiture":{formule:"part * nombre de déplacements * distance AR * voiture . empreinte par km / voiture . remplissage moyen",unité:"kgCO2e",note:"On fait l'hypothèse d'un aller/retour par festivalier."},"transport . public . avion":{formule:"part * nombre de déplacements * distance avion AR * avion . empreinte par km",unité:"kgCO2e"},"transport . public . avion . distance avion AR":{formule:1500,unité:"km"},"transport . public . train":{formule:"part * nombre de déplacements * distance AR * train . empreinte par km",unité:"kgCO2e"},"transport . public . commun":{formule:"part * nombre de déplacements * distance AR * commun . empreinte par km",unité:"kgCO2e"},transport:Hw,"transport . voiture":null,"transport . voiture . empreinte par km":{formule:.231,unité:"kgCO2e/km",note:`Facteur d'émission issu de la base empreinte "Voiture/Motorisation moyenne/2018".
`},"transport . voiture . remplissage moyen":{formule:1.8,note:"On considère un taux de remplissage moyen de 1,8 personnes par voiture."},"transport . avion":null,"transport . avion . empreinte par km":{formule:.187,unité:"kgCO2e/km",note:`Facteur d'émission issu de la base empreinte "Avion passagers/Moyen courrier, 2018/AVEC trainées".
`},"transport . train":null,"transport . train . empreinte par km":{formule:{moyenne:["TGV","TER"]},unité:"kgCO2e/km",note:`Moyenne entre TGV et TER.
`},"transport . train . empreinte par km . TGV":{formule:.00293,unité:"kgCO2e/km",note:`Facteur d'émission issu de la base empreinte "TGV/2022".
`},"transport . train . empreinte par km . TER":{formule:.0277,unité:"kgCO2e/km",note:`Facteur d'émission issu de la base empreinte "TER/2022/Traction moyenne".
`},"transport . commun":null,"transport . commun . empreinte par km":{formule:{moyenne:["bus","métro ou tram"]},unité:"kgCO2e/km"},"transport . commun . empreinte par km . bus":{formule:.146,unité:"kgCO2e/km",note:`Facteur d'émission issu de la base empreinte "Autobus moyen/Agglomération de 100 000 à 250 000 habitants".
`},"transport . commun . empreinte par km . métro ou tram":{formule:.00503,unité:"kgCO2e/km",note:`Facteur d'émission issu de la base empreinte "Métro, tramway, trolleybus/2018/Agglomération de 100 000 à 250 000 habitants".
`},"transport . tour bus":null,"transport . tour bus . empreinte par km":{formule:.0295,unité:"kgCO2e/km",note:`Facteur d'émission issu de la base empreinte "Autocar/2018".
`},nosgestesclimat:zw,"nosgestesclimat . alimentation . boisson":null,"nosgestesclimat . alimentation":null,"nosgestesclimat . alimentation . boisson . sucrées":null,"nosgestesclimat . alimentation . boisson . alcool":null,"nosgestesclimat . alimentation . boisson . eau en bouteille":null,"nosgestesclimat . alimentation . petit déjeuner":null,"nosgestesclimat . alimentation . plats . végétalien":null,"nosgestesclimat . alimentation . plats":null,"nosgestesclimat . alimentation . plats . végétarien":null,"nosgestesclimat . alimentation . plats . viande 1":null,"nosgestesclimat . alimentation . plats . viande 2":null,commun:Jw,"nosgestesclimat . divers . textile . t-shirt":null,"nosgestesclimat . divers . textile":null,"nosgestesclimat . divers":null,"nosgestesclimat . divers . textile . sweat":null,"nosgestesclimat . logement . chauffage . gaz":null,"nosgestesclimat . logement . chauffage":null,"nosgestesclimat . logement":null,"nosgestesclimat . logement . vacances":null,"nosgestesclimat . logement . vacances . camping":null},Ww={categories:{informations:{index:0,sub:[]},alimentation:{index:1,sub:["alimentation . repas","alimentation . petits déjeuners","alimentation . boissons","alimentation . ecocups","alimentation . déchets","alimentation . artistes"]},transport:{index:2,sub:["transport . public","transport . artistes"]},infrastructures:{index:3,sub:["bâtiments","infrastructures . scénographie"]},hébergement:{index:4,sub:["hébergement . bénévoles","hébergement . public","hébergement . artistes"]},énergie:{index:5,sub:["énergie . électricité","énergie . autre","énergie . groupes électrogènes"]},communication:{index:6,sub:["communication . merchandising","communication . textile bénévoles"]}},questions:{informations:[["informations . nombre de jours","informations . nombre de festivaliers","informations . nombre de bénévoles"],["informations . nombre artistes en voiture","informations . nombre artistes en train","informations . nombre artistes en tour bus","informations . nombre artistes en avion"]],alimentation:[["alimentation . repas . proposition","alimentation . repas . proposition . choix viande","alimentation . repas . proposition . mixte végé viande . proportion végétarien","alimentation . petits déjeuners présent"],["alimentation . boissons . froide . eau en bouteille bénévoles présent","alimentation . boissons . froide . alcool . quantité par jour et par personne","alimentation . boissons . froide . soft . quantité par jour et par personne","alimentation . artistes . eau en bouteille présent","alimentation . boissons . chaude . café . quantité par jour et par personne","alimentation . boissons . chaude . thé . quantité par jour et par personne"],["alimentation . ecocups présent","alimentation . ecocups . réutilisation"],["alimentation . déchets . recyclage","alimentation . déchets . gobelets . type","alimentation . déchets . assiettes . type","alimentation . déchets . couverts . type"]],communication:[["communication . textile bénévoles . type","communication . textile bénévoles . réutilisation"],["communication . merchandising . panier moyen par jour et par personne"]],hébergement:[["hébergement . public présent","hébergement . public . part"],["hébergement . bénévoles . type","hébergement . artistes présent"]],infrastructures:[["infrastructures . scénographie . nombre petites scènes","infrastructures . scénographie . nombre grandes scènes"],["infrastructures . scénographie . matériel . dépenses"]],transport:[["transport . public . accessible en transports en commun","transport . public . distance AR"],["transport . public . voiture . part","transport . public . train . part","transport . public . commun . part","transport . public . avion . part","transport . public . mobilité douce . part","transport . public . parts totales"],["transport . artistes . voiture . distance","transport . artistes . train . distance","transport . artistes . tour bus . distance","transport . artistes . avion . distance"]],énergie:[["énergie . électricité . consommation"],["énergie . groupes électrogènes présent","énergie . groupes électrogènes . nombre"],["énergie . autre présent","énergie . autre . fioul . consommation","énergie . autre . gaz . consommation"]]}};let vc=JSON.parse(localStorage.getItem("situation")??"{}"),ca=$0.Main.init({flags:{rules:eo,ui:Ww,situation:vc},node:document.getElementById("elm-app")});const bc=Object.keys(eo).length;console.time(`[publicodes:parsing] ${bc} rules`);const Ht=new Tw(eo,ca).setSituation(vc);console.timeEnd(`[publicodes:parsing] ${bc} rules`);ca.ports.setSituation.subscribe(e=>{Ht.setSituation(e),localStorage.setItem("situation",JSON.stringify(e))});ca.ports.updateSituation.subscribe(([e,r])=>{const n={...Ht.getSituation(),[e]:r};Ht.setSituation(n),localStorage.setItem("situation",JSON.stringify(n))});ca.ports.evaluateAll.subscribe(e=>{Ht.evaluateAll(e)});
